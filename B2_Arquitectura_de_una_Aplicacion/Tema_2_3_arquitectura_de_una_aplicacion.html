<!DOCTYPE html><html><head>
      <title>PMDM 2º DAM  Tema 2.3 - Arquitectura de una aplicación</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em!important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em!important;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em!important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px/2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAAfIAAsAAAAADDAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADMAAABCsP6z7U9TLzIAAAE8AAAARAAAAFZW7kosY21hcAAAAYAAAADTAAACjtP6ytBnbHlmAAACVAAAAxgAAAQ4zRtvlGhlYWQAAAVsAAAALwAAADYRwZsnaGhlYQAABZwAAAAcAAAAJAeKAzxobXR4AAAFuAAAABIAAAA8OGQAAGxvY2EAAAXMAAAAIAAAACAG5AfwbWF4cAAABewAAAAfAAAAIAEfAERuYW1lAAAGDAAAAVcAAAKFkAhoC3Bvc3QAAAdkAAAAYgAAAK2vz7wkeJxjYGRgYOBikGPQYWB0cfMJYeBgYGGAAJAMY05meiJQDMoDyrGAaQ4gZoOIAgCKIwNPAHicY2BkPsQ4gYGVgYOpk+kMAwNDP4RmfM1gxMjBwMDEwMrMgBUEpLmmMDgwVLy4xKzzX4chhrmK4QpQmBEkBwAZygyweJzFkr0NwjAQhZ+TEP6CRUfHBEwRUWaQTICyQbpMwRCskA5RUIONxG0RnnNpKAIV4qzPku/8c353ACYAYrIjCWCuMAh2ptf0/hiL3p/gyPUWa3osqlt0L1zu9r71z8dGrJRykFoauXQd932Lj5vhG+MjxGeYI8MKETObMpslf5EyP8tg+vHun5r539PvlvXzaVhRFVQDTPEWKVQR90KhnnC5Ek67vUKN4VuFasM/ldARj43CCkCsEjpJSoVVgRyU0GVSK6wUpFFCx8lFgX0BiXpRPQB4nE2TTWjcRhTH3xttpDhxN7uxPlp3u/FK7moRPixafRijNosxSw/LUsIwNcaEHPZggo/FmEKMCKWU4kNOOftQSlhE8alnH0Ix9BqWnHooPRrTQ0+mnu2bXTu2pPdGM9LM/6c3fwECTM4gBBMYQNqxzLrZAjqYSlqu2TAHZQA0/DQJH6FtzqGDnvbt4Ggwvzw/nL8EfH8kW0fsuRqhgWXZnY7M1picaUL7Du5BHeDzMIl83dAt016wH1qmvtSMo5R6YRJHTR//FXsff/nj/tc/5K9P5d+nP22+fFK5u7v3K39SW3y+OtDKO3L85vD09PD9z5X17a2N1g4tqk01RlqX7gyoEmnsWQtVr4rtZMmukEaFBZxzefkCn11cyKMLZgshRwgTYNoLNXCBz2ja7HvZG7hDpPSNfoo5vs0knK/9hb+rNpu+8kHPgk/Ao4kK3tWtTpSEtvkA9c+wE6UaUdwieNkaHg55tBEtRiEPw1s0+FtrtTcc9two2lhMknV7PZF/cs6+uUFTmpTGbEx7sQCPSLOttHS3GRltqp7SNzVSKzl6aWnZT/CX5k6/v9N3Hh8fHBwffJVjhrC6OgH5dkIt/tPsq+d/PD5Qz7G7efzq1THFjdZVPe/N6ulQ3JnDWSE5junsFsVIiFwL/htf1S5gJ3BfOcUxfHKLnzqpFpyfZ9cX+/5WB6a+Y0pHpzkNrYNVDwMsikK+y7WuLCRg/oFHkA8VT3rDg5ZnU6ktzzINymV0m74Xd5pfIGXyFeVEQSShkzqG7TBBa2OxVRKitLXv7h3uuftXnXq7lz2tZ/WnWa9dx9dCjDhHzmuVQATlmljr9dZErUydSo2Hbi/b1vXtrOeGCk2/8s3ZlO8+ueJT8BVlw5pGw2oYccdSiHHqx0RlabHqdNR9jAETl6PreJcPBnnfpTLnOQ8C3OV8AmQGzouV1iZdeb5SSIoVc8W8/kcDtksUH5FrU6/aqBqNWcMEzxG4DAQ14qRQhi9mWU0rzepKezbjfgCwQKxVYq5ajRgpRqy45CqwkJydcEkbTkvRz8P5/2ZpDTN4nGNgZGBgAOKb6v+/xvPbfGXgZmEAgeuB2kkI+v8bFgbmKiCXg4EJJAoAPyAKhQB4nGNgZGBg1vmvwxDDwgACQJKRARXwAwAzZQHQeJxjYQCCFAYGFgbSMQAcWACdAAAAAAAAAAwALgBgAIQAmADSAQgBIgE8AVABoAHeAfwCHHicY2BkYGDgZ7BgYGMAASYg5gJCBob/YD4DAA/hAWQAeJxlkbtuwkAURMc88gApQomUJoq0TdIQzEOpUDokKCNR0BuzBiO/tF6QSJcPyHflE9Klyyekz2CuG8cr7547M3d9JQO4xjccnJ57vid2cMHqxDWc40G4Tv1JuEF+Fm6ijRfhM+oz4Ra6eBVu4wZvvMFpXLIa40PYQQefwjVc4Uu4Tv1HuEH+FW7i1mkKn6Hj3Am3sHC6wm08Ou8tpSZGe1av1PKggjSxPd8zJtSGTuinyVGa6/Uu8kxZludCmzxMEzV0B6U004k25W35fj2yNlCBSWM1paujKFWZSbfat+7G2mzc7weiu34aczzFNYGBhgfLfcV6iQP3ACkSaj349AxXSN9IT0j16JepOb01doiKbNWt1ovippz6sVYYwsXgX2rGVFIkq7Pl2PNrI6qW6eOshj0xaSq9mpNEZIWs8LZUfOouNkVXxp/d5woqebeYIf4D2J1ywQB4nG3LOw6AIBAE0B384B+PAkgEa+QwNnYmHt+EpXSal5lkSBBnoP8oCFSo0aCFRIceA0ZMmLFAYSW88rmvtMUjG3RiQ9HvpfusM6zWNmtc5H/iPewha50tOt5PS/QBx2IeSwAA") format("woff")}.admonition{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2);position:relative;margin:1.5625em 0;padding:0 1.2rem;border-left:.4rem solid rgba(68,138,255,.8);border-radius:.2rem;background-color:rgba(255,255,255,.05);overflow:auto}.admonition>p{margin-top:.8rem}.admonition>.admonition-title{margin:0 -1.2rem;padding:.8rem 1.2rem .8rem 3.6rem;border-bottom:1px solid rgba(68,138,255,.2);background-color:rgba(68,138,255,.1);font-weight:700}.admonition>.admonition-title:before{position:absolute;left:1.2rem;font-size:1.5rem;color:rgba(68,138,255,.8);content:"\E3C9"}.admonition>.admonition-title:before{font-family:Material Icons;font-style:normal;font-variant:normal;font-weight:400;line-height:2rem;text-transform:none;white-space:nowrap;speak:none;word-wrap:normal;direction:ltr}.admonition.abstract,.admonition.summary,.admonition.tldr{border-left-color:rgba(0,176,255,.8)}.admonition.abstract>.admonition-title,.admonition.summary>.admonition-title,.admonition.tldr>.admonition-title{background-color:rgba(0,176,255,.1);border-bottom-color:rgba(0,176,255,.2)}.admonition.abstract>.admonition-title:before,.admonition.summary>.admonition-title:before,.admonition.tldr>.admonition-title:before{color:#00b0ff;content:"\E8D2"}.admonition.hint,.admonition.tip{border-left-color:rgba(0,191,165,.8)}.admonition.hint>.admonition-title,.admonition.tip>.admonition-title{background-color:rgba(0,191,165,.1);border-bottom-color:rgba(0,191,165,.2)}.admonition.hint>.admonition-title:before,.admonition.tip>.admonition-title:before{color:#00bfa5;content:"\E80E"}.admonition.info,.admonition.todo{border-left-color:rgba(0,184,212,.8)}.admonition.info>.admonition-title,.admonition.todo>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.info>.admonition-title:before,.admonition.todo>.admonition-title:before{color:#00b8d4;content:"\E88E"}.admonition.check,.admonition.done,.admonition.success{border-left-color:rgba(0,200,83,.8)}.admonition.check>.admonition-title,.admonition.done>.admonition-title,.admonition.success>.admonition-title{background-color:rgba(0,200,83,.1);border-bottom-color:rgba(0,200,83,.2)}.admonition.check>.admonition-title:before,.admonition.done>.admonition-title:before,.admonition.success>.admonition-title:before{color:#00c853;content:"\E876"}.admonition.faq,.admonition.help,.admonition.question{border-left-color:rgba(100,221,23,.8)}.admonition.faq>.admonition-title,.admonition.help>.admonition-title,.admonition.question>.admonition-title{background-color:rgba(100,221,23,.1);border-bottom-color:rgba(100,221,23,.2)}.admonition.faq>.admonition-title:before,.admonition.help>.admonition-title:before,.admonition.question>.admonition-title:before{color:#64dd17;content:"\E887"}.admonition.attention,.admonition.caution,.admonition.warning{border-left-color:rgba(255,145,0,.8)}.admonition.attention>.admonition-title,.admonition.caution>.admonition-title,.admonition.warning>.admonition-title{background-color:rgba(255,145,0,.1);border-bottom-color:rgba(255,145,0,.2)}.admonition.attention>.admonition-title:before{color:#ff9100;content:"\E417"}.admonition.caution>.admonition-title:before,.admonition.warning>.admonition-title:before{color:#ff9100;content:"\E002"}.admonition.fail,.admonition.failure,.admonition.missing{border-left-color:rgba(255,82,82,.8)}.admonition.fail>.admonition-title,.admonition.failure>.admonition-title,.admonition.missing>.admonition-title{background-color:rgba(255,82,82,.1);border-bottom-color:rgba(255,82,82,.2)}.admonition.fail>.admonition-title:before,.admonition.failure>.admonition-title:before,.admonition.missing>.admonition-title:before{color:#ff5252;content:"\E14C"}.admonition.bug,.admonition.danger,.admonition.error{border-left-color:rgba(255,23,68,.8)}.admonition.bug>.admonition-title,.admonition.danger>.admonition-title,.admonition.error>.admonition-title{background-color:rgba(255,23,68,.1);border-bottom-color:rgba(255,23,68,.2)}.admonition.danger>.admonition-title:before{color:#ff1744;content:"\E3E7"}.admonition.error>.admonition-title:before{color:#ff1744;content:"\E14C"}.admonition.bug>.admonition-title:before{color:#ff1744;content:"\E868"}.admonition.example,.admonition.snippet{border-left-color:rgba(0,184,212,.8)}.admonition.example>.admonition-title,.admonition.snippet>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.example>.admonition-title:before,.admonition.snippet>.admonition-title:before{color:#00b8d4;content:"\E242"}.admonition.cite,.admonition.quote{border-left-color:rgba(158,158,158,.8)}.admonition.cite>.admonition-title,.admonition.quote>.admonition-title{background-color:rgba(158,158,158,.1);border-bottom-color:rgba(158,158,158,.2)}.admonition.cite>.admonition-title:before,.admonition.quote>.admonition-title:before{color:#9e9e9e;content:"\E244"}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v19/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.markdown-preview.markdown-preview .caso_estudio {
  background-color: #f5f5f5;
  border: 2px solid #969696;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .ejercicio {
  background-color: #f5faf5;
  border: 2px solid #969b96;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.markdown-preview.markdown-preview .fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.markdown-preview.markdown-preview .cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.markdown-preview.markdown-preview .abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.markdown-preview.markdown-preview .cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.markdown-preview.markdown-preview .autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
.markdown-preview.markdown-preview .flotante {
  display: flex;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: center;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: space-between;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview .flotante_izq {
  margin-right: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: auto;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: auto;
  }
}
.markdown-preview.markdown-preview .galeria_imagenes {
  display: flex;
  justify-content: space-evenly;
  align-items: center;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: row;
  }
}

      </style>
      
    </head>
    <body for="html-export">
      <div class="crossnote markdown-preview  ">
      <style>/* 
Añade 

@import "../EstilosPersonalizadosMarkdownEnhanced.less"

justo después del front matter 
*/
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v19/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
</style>
<h1 class="crossnote-header" id="tema-23---arquitectura-de-una-aplicaci%C3%B3n">Tema 2.3 - Arquitectura de una aplicación</h1>

<p>Descargar estos apuntes <a href="./Tema_2_3_arquitectura_de_una_aplicacion.pdf">pdf</a> o <a href="./Tema_2_3_arquitectura_de_una_aplicacion.html">html</a></p>
<h2 class="crossnote-header" id="%C3%ADndice">Índice</h2>


<div class="md-toc">
<div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#introducción" class="md-toc-link">
            <p>Introducción</p>

          </a></div><details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#esquema-básico-de-una-aplicación-android-propuesto-por-google" class="md-toc-link"><p>Esquema básico de una aplicación Android propuesto por Google</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#capa-ui" class="md-toc-link">
            <p>Capa UI</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#capa-de-datos" class="md-toc-link">
            <p>Capa de Datos</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#capa-de-dominio" class="md-toc-link">
            <p>Capa de Dominio</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#modelo-vista-vista-modelo-mvvm" class="md-toc-link">
            <p>Modelo vista vista modelo MVVM</p>

          </a></div><details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#visión-general-de-la-arquitectura-en-un-proyecto-de-android" class="md-toc-link"><p>Visión general de la arquitectura en un proyecto de Android</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#estructurando-el-modelo" class="md-toc-link">
            <p>Estructurando el Modelo</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#estructurando-la-capa-de-datos" class="md-toc-link">
            <p>Estructurando la capa de datos</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#estructurando-la-capa-de-ui" class="md-toc-link">
            <p>Estructurando la capa de UI</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#apéndice-i---codificando-imágenes-en-base64" class="md-toc-link"><p>Apéndice I - Codificando imágenes en Base64</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#funciones-de-utilidad-para-codificar-y-decodificar-imágenes" class="md-toc-link">
            <p>Funciones de utilidad para codificar y decodificar imágenes</p>

          </a></div>
        </div>
      </details>
    
</div>
<div style="page-break-after:always;"></div>
<h2 class="crossnote-header" id="introducci%C3%B3n">Introducción</h2>

<p>Básicamente una aquitectura software es la estructura de un sistema de software, los componentes del software, las propiedades externamente visibles de esos componentes y las relaciones entre ellos.</p>
<p>La idea tras las arquitecturas es tener capas que separen las responsabilidades de cada una de ellas. De esta forma se consigue que el código sea más mantenible, escalable y testeable. Además, podremos cambiar una capa sin que afecte a las demás.</p>
<p>Actualmente existen arquitecturas complejas de sistemas cómo por ejemplo <a href="https://en.wikipedia.org/wiki/Hexagonal_architecture_(software)">Arquitectura Hexagonal</a>, <a href="https://en.wikipedia.org/wiki/Microservices">Microservicios</a>, <a href="https://en.wikipedia.org/wiki/Event-driven_architecture">Event-driven Architecture</a>, etc. Sin embargo, en el mundo del diseño diseño de aplicaciones para dispositivos móviles tenemos patrones arquitectónicos más sencillas cómo MVC, MVP, MVVM, MVI, etc.</p>
<blockquote>
<p>📌 <strong>Nota</strong>: Puedes ver más información sobre la arquitectura propuesta por Google para Android en <a href="https://developer.android.com/jetpack/guide?hl=es-419">Guía de arquitectura de apps</a></p>
</blockquote>
<h2 class="crossnote-header" id="esquema-b%C3%A1sico-de-una-aplicaci%C3%B3n-android-propuesto-por-google">Esquema básico de una aplicación Android propuesto por Google</h2>

<p align="center" style="zoom:0.7" class="dot"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 8.1.0 (20230707.0739)
 -->
<!-- Title: G Pages: 1 -->
<svg width="611pt" height="116pt" viewBox="0.00 0.00 610.53 116.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-112 606.53,-112 606.53,4 -4,4"></polygon>
<!-- UI -->
<g id="node1" class="node">
<title>UI</title>
<path fill="#63b8ff" stroke="#63b8ff" d="M132,-108C132,-108 12,-108 12,-108 6,-108 0,-102 0,-96 0,-96 0,-12 0,-12 0,-6 6,0 12,0 12,0 132,0 132,0 138,0 144,-6 144,-12 144,-12 144,-96 144,-96 144,-102 138,-108 132,-108"></path>
<text text-anchor="middle" x="72" y="-48" font-family="Arial" font-size="20.00" fill="white">Capa UI</text>
</g>
<!-- Dominio -->
<g id="node2" class="node">
<title>Dominio</title>
<path fill="#36648b" stroke="#36648b" d="M374.53,-108C374.53,-108 228,-108 228,-108 222,-108 216,-102 216,-96 216,-96 216,-12 216,-12 216,-6 222,0 228,0 228,0 374.53,0 374.53,0 380.53,0 386.53,-6 386.53,-12 386.53,-12 386.53,-96 386.53,-96 386.53,-102 380.53,-108 374.53,-108"></path>
<text text-anchor="middle" x="301.27" y="-72" font-family="Arial" font-size="20.00" fill="white">Capa de Dominio</text>
<text text-anchor="middle" x="301.27" y="-48" font-family="Arial" font-size="20.00" fill="white">o</text>
<text text-anchor="middle" x="301.27" y="-24" font-family="Arial" font-size="20.00" fill="white">Modelo</text>
</g>
<!-- UI&#45;&gt;Dominio -->
<g id="edge1" class="edge">
<title>UI-&gt;Dominio</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M144.28,-54C162.87,-54 183.21,-54 202.89,-54"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="202.7,-57.5 212.7,-54 202.7,-50.5 202.7,-57.5"></polygon>
</g>
<!-- Datos -->
<g id="node3" class="node">
<title>Datos</title>
<path fill="#4f94cd" stroke="#4f94cd" d="M590.53,-108C590.53,-108 470.53,-108 470.53,-108 464.53,-108 458.53,-102 458.53,-96 458.53,-96 458.53,-12 458.53,-12 458.53,-6 464.53,0 470.53,0 470.53,0 590.53,0 590.53,0 596.53,0 602.53,-6 602.53,-12 602.53,-12 602.53,-96 602.53,-96 602.53,-102 596.53,-108 590.53,-108"></path>
<text text-anchor="middle" x="530.53" y="-48" font-family="Arial" font-size="20.00" fill="white">Capa Datos</text>
</g>
<!-- Dominio&#45;&gt;Datos -->
<g id="edge2" class="edge">
<title>Dominio-&gt;Datos</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M399.69,-54C419.35,-54 439.67,-54 458.24,-54"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="399.89,-50.5 389.89,-54 399.89,-57.5 399.89,-50.5"></polygon>
</g>
</g>
</svg>
</p><h3 class="crossnote-header" id="capa-ui">Capa UI</h3>

<p>La función de la capa de la IU (o capa de presentación) consiste en mostrar los datos de la aplicación en la pantalla. Cuando los datos cambian, ya sea debido a la interacción del usuario (como cuando presiona un botón) o una entrada externa (como una respuesta de red), la IU debe actualizarse para reflejar los cambios.</p>
<p>La capa de la IU consta de los siguientes dos elementos:</p>
<ul>
<li>
<p>Elementos de la IU que renderizan los datos en la pantalla (puedes compilar estos elementos mediante las vistas XML o las funciones de <strong>Jetpack Compose</strong>)</p>
</li>
<li>
<p>Contenedores de estados (como las clases <strong>ViewModel</strong>) que contienen datos, los exponen a la IU y controlan la lógica</p>
</li>
</ul>
<blockquote>
<p>✋ <strong>Importante</strong>: Documentación oficial de Android sobre la <strong><a href="https://developer.android.com/jetpack/guide/ui-layer?hl=es-419">Capa de UI</a></strong> en la que más adelante profundizaremos</p>
</blockquote>
<p align="center" style="zoom:0.7" class="dot"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 8.1.0 (20230707.0739)
 -->
<!-- Title: G Pages: 1 -->
<svg width="927pt" height="204pt" viewBox="0.00 0.00 926.53 204.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 200)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-200 922.53,-200 922.53,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>clusterUI</title>
<path fill="#63b8ff" stroke="#63b8ff" d="M20,-8C20,-8 468,-8 468,-8 474,-8 480,-14 480,-20 480,-20 480,-176 480,-176 480,-182 474,-188 468,-188 468,-188 20,-188 20,-188 14,-188 8,-182 8,-176 8,-176 8,-20 8,-20 8,-14 14,-8 20,-8"></path>
<text text-anchor="middle" x="244" y="-166" font-family="Arial" font-size="20.00" fill="white">Capa UI</text>
</g>
<!-- ComponentesUI -->
<g id="node1" class="node">
<title>ComponentesUI</title>
<path fill="#b9d3ee" stroke="#b9d3ee" d="M196,-136C196,-136 40,-136 40,-136 34,-136 28,-130 28,-124 28,-124 28,-40 28,-40 28,-34 34,-28 40,-28 40,-28 196,-28 196,-28 202,-28 208,-34 208,-40 208,-40 208,-124 208,-124 208,-130 202,-136 196,-136"></path>
<text text-anchor="middle" x="118" y="-76" font-family="Arial" font-size="20.00">Componentes UI</text>
</g>
<!-- Estado -->
<g id="node2" class="node">
<title>Estado</title>
<path fill="#6c7b8b" stroke="#6c7b8b" d="M448,-136C448,-136 292,-136 292,-136 286,-136 280,-130 280,-124 280,-124 280,-40 280,-40 280,-34 286,-28 292,-28 292,-28 448,-28 448,-28 454,-28 460,-34 460,-40 460,-40 460,-124 460,-124 460,-130 454,-136 448,-136"></path>
<text text-anchor="middle" x="370" y="-88" font-family="Arial" font-size="20.00" fill="white">Contenedor de</text>
<text text-anchor="middle" x="370" y="-64" font-family="Arial" font-size="20.00" fill="white">Estados</text>
</g>
<!-- ComponentesUI&#45;&gt;Estado -->
<g id="edge1" class="edge">
<title>ComponentesUI-&gt;Estado</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M208.2,-82C227.2,-82 247.41,-82 266.86,-82"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="266.84,-85.5 276.84,-82 266.84,-78.5 266.84,-85.5"></polygon>
</g>
<!-- Dominio -->
<g id="node3" class="node">
<title>Dominio</title>
<path fill="#36648b" stroke="#36648b" d="M690.53,-136C690.53,-136 544,-136 544,-136 538,-136 532,-130 532,-124 532,-124 532,-40 532,-40 532,-34 538,-28 544,-28 544,-28 690.53,-28 690.53,-28 696.53,-28 702.53,-34 702.53,-40 702.53,-40 702.53,-124 702.53,-124 702.53,-130 696.53,-136 690.53,-136"></path>
<text text-anchor="middle" x="617.27" y="-100" font-family="Arial" font-size="20.00" fill="white">Capa de Dominio</text>
<text text-anchor="middle" x="617.27" y="-76" font-family="Arial" font-size="20.00" fill="white">o</text>
<text text-anchor="middle" x="617.27" y="-52" font-family="Arial" font-size="20.00" fill="white">Modelo</text>
</g>
<!-- Estado&#45;&gt;Dominio -->
<g id="edge2" class="edge">
<title>Estado-&gt;Dominio</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M460.24,-82C479.25,-82 499.42,-82 518.72,-82"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="518.59,-85.5 528.59,-82 518.59,-78.5 518.59,-85.5"></polygon>
</g>
<!-- Datos -->
<g id="node4" class="node">
<title>Datos</title>
<path fill="#4f94cd" stroke="#4f94cd" d="M906.53,-136C906.53,-136 786.53,-136 786.53,-136 780.53,-136 774.53,-130 774.53,-124 774.53,-124 774.53,-40 774.53,-40 774.53,-34 780.53,-28 786.53,-28 786.53,-28 906.53,-28 906.53,-28 912.53,-28 918.53,-34 918.53,-40 918.53,-40 918.53,-124 918.53,-124 918.53,-130 912.53,-136 906.53,-136"></path>
<text text-anchor="middle" x="846.53" y="-76" font-family="Arial" font-size="20.00" fill="white">Capa Datos</text>
</g>
<!-- Dominio&#45;&gt;Datos -->
<g id="edge3" class="edge">
<title>Dominio-&gt;Datos</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M715.69,-82C735.35,-82 755.67,-82 774.24,-82"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="715.89,-78.5 705.89,-82 715.89,-85.5 715.89,-78.5"></polygon>
</g>
</g>
</svg>
</p><div style="page-break-after:always;"></div>
<h3 class="crossnote-header" id="capa-de-datos">Capa de Datos</h3>

<p>La capa de datos está formada por repositorios que pueden contener de <strong>cero a muchas fuentes de datos</strong>. A este tipo de diseño se le denomina <strong><a href="https://martinfowler.com/eaaCatalog/repository.html">Repository Pattern</a></strong> y es un patrón de diseño que se utiliza para separar la lógica empresarial de la lógica de acceso a los datos. El repositorio se encarga de obtener los datos de una fuente de datos y convertirlos en un formato con el que el resto de la aplicación pueda trabajar.</p>
<blockquote>
<p>📌 <strong>Nota</strong>: Este patrón fué introducido <strong>Martin Fowler</strong> en su libro <a href="https://www.amazon.es/Patterns-Enterprise-Application-Architecture-Martin/dp/0321127420">Patterns of Enterprise Application Architecture</a> en el año <strong>2002</strong> y posteriormente desarrollado por <strong>Eric Evans</strong> en su libro <a href="https://www.amazon.es/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215">Domain-Driven Design</a> en el año <strong>2003</strong>. Hoy en día es un patrón muy utilizado en el desarrollo de software y ámpliamente utilizado en el desarrollo de aplicaciones móviles.</p>
</blockquote>
<blockquote>
<p>✋ <strong>Importante</strong>: Documentación oficial de Android sobre la <strong><a href="https://developer.android.com/jetpack/guide/data-layer?hl=es-419">Capa de datos</a></strong> en la que más adelante profundizaremos</p>
</blockquote>
<p align="center" style="zoom:0.7" class="dot"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 8.1.0 (20230707.0739)
 -->
<!-- Title: G Pages: 1 -->
<svg width="927pt" height="204pt" viewBox="0.00 0.00 926.53 204.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 200)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-200 922.53,-200 922.53,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>clusterD</title>
<path fill="#4f94cd" stroke="#4f94cd" d="M450.53,-8C450.53,-8 898.53,-8 898.53,-8 904.53,-8 910.53,-14 910.53,-20 910.53,-20 910.53,-176 910.53,-176 910.53,-182 904.53,-188 898.53,-188 898.53,-188 450.53,-188 450.53,-188 444.53,-188 438.53,-182 438.53,-176 438.53,-176 438.53,-20 438.53,-20 438.53,-14 444.53,-8 450.53,-8"></path>
<text text-anchor="middle" x="674.53" y="-166" font-family="Arial" font-size="20.00" fill="white">Capa Datos</text>
</g>
<!-- Repositorio -->
<g id="node1" class="node">
<title>Repositorio</title>
<path fill="#b9d3ee" stroke="#b9d3ee" d="M626.53,-136C626.53,-136 470.53,-136 470.53,-136 464.53,-136 458.53,-130 458.53,-124 458.53,-124 458.53,-40 458.53,-40 458.53,-34 464.53,-28 470.53,-28 470.53,-28 626.53,-28 626.53,-28 632.53,-28 638.53,-34 638.53,-40 638.53,-40 638.53,-124 638.53,-124 638.53,-130 632.53,-136 626.53,-136"></path>
<text text-anchor="middle" x="548.53" y="-76" font-family="Arial" font-size="20.00">Repositorio/s</text>
</g>
<!-- FuenteDatos -->
<g id="node2" class="node">
<title>FuenteDatos</title>
<path fill="#6c7b8b" stroke="#6c7b8b" d="M878.53,-136C878.53,-136 722.53,-136 722.53,-136 716.53,-136 710.53,-130 710.53,-124 710.53,-124 710.53,-40 710.53,-40 710.53,-34 716.53,-28 722.53,-28 722.53,-28 878.53,-28 878.53,-28 884.53,-28 890.53,-34 890.53,-40 890.53,-40 890.53,-124 890.53,-124 890.53,-130 884.53,-136 878.53,-136"></path>
<text text-anchor="middle" x="800.53" y="-76" font-family="Arial" font-size="20.00" fill="white">Fuente/s Datos</text>
</g>
<!-- Repositorio&#45;&gt;FuenteDatos -->
<g id="edge1" class="edge">
<title>Repositorio-&gt;FuenteDatos</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M638.73,-82C657.73,-82 677.94,-82 697.39,-82"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="697.37,-85.5 707.37,-82 697.37,-78.5 697.37,-85.5"></polygon>
</g>
<!-- UI -->
<g id="node3" class="node">
<title>UI</title>
<path fill="#63b8ff" stroke="#63b8ff" d="M132,-136C132,-136 12,-136 12,-136 6,-136 0,-130 0,-124 0,-124 0,-40 0,-40 0,-34 6,-28 12,-28 12,-28 132,-28 132,-28 138,-28 144,-34 144,-40 144,-40 144,-124 144,-124 144,-130 138,-136 132,-136"></path>
<text text-anchor="middle" x="72" y="-76" font-family="Arial" font-size="20.00" fill="white">Capa UI</text>
</g>
<!-- Dominio -->
<g id="node4" class="node">
<title>Dominio</title>
<path fill="#36648b" stroke="#36648b" d="M374.53,-136C374.53,-136 228,-136 228,-136 222,-136 216,-130 216,-124 216,-124 216,-40 216,-40 216,-34 222,-28 228,-28 228,-28 374.53,-28 374.53,-28 380.53,-28 386.53,-34 386.53,-40 386.53,-40 386.53,-124 386.53,-124 386.53,-130 380.53,-136 374.53,-136"></path>
<text text-anchor="middle" x="301.27" y="-100" font-family="Arial" font-size="20.00" fill="white">Capa de Dominio</text>
<text text-anchor="middle" x="301.27" y="-76" font-family="Arial" font-size="20.00" fill="white">o</text>
<text text-anchor="middle" x="301.27" y="-52" font-family="Arial" font-size="20.00" fill="white">Modelo</text>
</g>
<!-- UI&#45;&gt;Dominio -->
<g id="edge2" class="edge">
<title>UI-&gt;Dominio</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M144.28,-82C162.87,-82 183.21,-82 202.89,-82"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="202.7,-85.5 212.7,-82 202.7,-78.5 202.7,-85.5"></polygon>
</g>
<!-- Dominio&#45;&gt;Repositorio -->
<g id="edge3" class="edge">
<title>Dominio-&gt;Repositorio</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M399.85,-82C419.1,-82 439.22,-82 458.18,-82"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="400.02,-78.5 390.02,-82 400.02,-85.5 400.02,-78.5"></polygon>
</g>
</g>
</svg>
</p><h3 class="crossnote-header" id="capa-de-dominio">Capa de Dominio</h3>

<p>La capa de dominio es una <strong>capa opcional</strong> que se ubica entre la capa de la IU y la de datos.</p>
<p>La capa de dominio es responsable de encapsular la lógica empresarial compleja o la lógica empresarial simple que varios ViewModels reutilizan. Esta capa es opcional porque no todas las apps tendrán estos requisitos. Solo debes usarla cuando sea necesario; por ejemplo, para administrar la complejidad o favorecer la reutilización.</p>
<p>Esta terminología viene del <strong>DDD (Domain Driven Design)</strong> que es una metodología de diseño de software que se centra en la lógica empresarial y en la comunicación entre los expertos en el dominio y los desarrolladores.</p>
<p>Sin embargo, nosotros vamos a obviar esta capa y vamos a implementar una arquitectura más sencilla basada en el patrón <strong>MVVM</strong> en el cual esta capa se denomina <strong>Modelo</strong> ya que representará el modelo de datos.</p>
<div style="page-break-after:always;"></div>
<h2 class="crossnote-header" id="modelo-vista-vista-modelo-mvvm">Modelo vista vista modelo MVVM</h2>

<ul>
<li>Vídeo Tutorial DevExperto (Castellano): <strong><a href="https://www.youtube.com/watch?v=S3h-u4M1q3w">Patrones de presentación MVC, MVP, MVVM</a></strong></li>
<li>Podcast con <a href="https://es.linkedin.com/in/angeles-vazquez-parra">Ángeles Vázquez</a> DevExperto (Castellano): <strong><a href="https://www.youtube.com/watch?v=sel5UFPKh_U">MVC, MVP, MVVM y MVI para UIs Dinámicas</a></strong></li>
</ul>
<p>MVVM es un patrón de diseño de software que facilita la separación de la lógica de presentación de la lógica de negocio.</p>
<p>MVVM es una variante del patrón MVC (Modelo-Vista-Controlador) que se utiliza para la construcción de interfaces de usuario. En MVVM, el ViewModel asume la funcionalidad del "intermediario". En MVVM, toda la lógica de presentación se coloca en el ViewModel.</p>
<p>El ViewModel es responsable de recuperar los datos de los modelos y exponerlos a la vista. El ViewModel también se utiliza para manejar todas las interacciones del usuario. El ViewModel recupera los datos de los modelos, los formatea y los expone a la vista. El ViewModel también acepta las entradas del usuario y las valida antes de actualizar los modelos.</p>
<p>Implementaciones o aproximaciones a esta arquitectura hay muy diversas, pero básicamente la que nosotros vamos a implementar un esquema similar al siguiente para aproximarnos a MVVM siguiendo las recomendaciones de Google.</p>
<p align="center" style="zoom:0.65" class="dot"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 8.1.0 (20230707.0739)
 -->
<!-- Title: G Pages: 1 -->
<svg width="965pt" height="352pt" viewBox="0.00 0.00 965.10 352.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 348)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-348 961.1,-348 961.1,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>clusterUI</title>
<path fill="none" stroke="cornflowerblue" stroke-width="5" d="M20,-8C20,-8 636.07,-8 636.07,-8 642.07,-8 648.07,-14 648.07,-20 648.07,-20 648.07,-324 648.07,-324 648.07,-330 642.07,-336 636.07,-336 636.07,-336 20,-336 20,-336 14,-336 8,-330 8,-324 8,-324 8,-20 8,-20 8,-14 14,-8 20,-8"></path>
<text text-anchor="middle" x="328.04" y="-314" font-family="Arial" font-size="20.00" fill="cornflowerblue">Capa UI</text>
</g>
<!-- View -->
<g id="node1" class="node">
<title>View</title>
<path fill="#63b8ff" stroke="#63b8ff" d="M220,-206C220,-206 100,-206 100,-206 94,-206 88,-200 88,-194 88,-194 88,-110 88,-110 88,-104 94,-98 100,-98 100,-98 220,-98 220,-98 226,-98 232,-104 232,-110 232,-110 232,-194 232,-194 232,-200 226,-206 220,-206"></path>
<text text-anchor="middle" x="160" y="-146" font-family="Arial" font-size="20.00" fill="white">View</text>
</g>
<!-- ViewModel -->
<g id="node2" class="node">
<title>ViewModel</title>
<path fill="#4f94cd" stroke="#4f94cd" d="M556.07,-206C556.07,-206 436.07,-206 436.07,-206 430.07,-206 424.07,-200 424.07,-194 424.07,-194 424.07,-110 424.07,-110 424.07,-104 430.07,-98 436.07,-98 436.07,-98 556.07,-98 556.07,-98 562.07,-98 568.07,-104 568.07,-110 568.07,-110 568.07,-194 568.07,-194 568.07,-200 562.07,-206 556.07,-206"></path>
<text text-anchor="middle" x="496.07" y="-146" font-family="Arial" font-size="20.00" fill="white">ViewModel</text>
</g>
<!-- View&#45;&gt;ViewModel -->
<g id="edge1" class="edge">
<title>View:ne-&gt;ViewModel:nw</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M231,-206C288.6,-263.6 356.14,-266.52 414.75,-214.77"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="417.19,-217.4 422.07,-208 412.39,-212.3 417.19,-217.4"></polygon>
<text text-anchor="middle" x="328.04" y="-255.5" font-family="Arial" font-size="15.00" fill="#104e8b">Evento UI</text>
</g>
<!-- View&#45;&gt;ViewModel -->
<g id="edge2" class="edge">
<title>View-&gt;ViewModel</title>
<path fill="none" stroke="#1e90ff" stroke-width="2" stroke-dasharray="5,2" d="M245.17,-152C300.22,-152 371.35,-152 423.64,-152"></path>
<polygon fill="#1e90ff" stroke="#1e90ff" stroke-width="2" points="245.26,-148.5 235.26,-152 245.26,-155.5 245.26,-148.5"></polygon>
<text text-anchor="middle" x="328.04" y="-174.5" font-family="Arial" font-size="15.00" fill="#1874cd">Evento de cambio</text>
<text text-anchor="middle" x="328.04" y="-156.5" font-family="Arial" font-size="15.00" fill="#1874cd">de estado</text>
</g>
<!-- View&#45;&gt;ViewModel -->
<g id="edge3" class="edge">
<title>View:se-&gt;ViewModel:sw</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M241.33,-89.23C299.93,-37.48 367.48,-40.4 425.07,-98"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="238.89,-86.6 234,-96 243.68,-91.7 238.89,-86.6"></polygon>
<text text-anchor="middle" x="328.04" y="-73.5" font-family="Arial" font-size="15.00" fill="#104e8b">Datos UI</text>
</g>
<!-- Model -->
<g id="node3" class="node">
<title>Model</title>
<path fill="#36648b" stroke="#36648b" d="M945.1,-206C945.1,-206 824.15,-206 824.15,-206 818.15,-206 812.15,-200 812.15,-194 812.15,-194 812.15,-110 812.15,-110 812.15,-104 818.15,-98 824.15,-98 824.15,-98 945.1,-98 945.1,-98 951.1,-98 957.1,-104 957.1,-110 957.1,-110 957.1,-194 957.1,-194 957.1,-200 951.1,-206 945.1,-206"></path>
<text text-anchor="middle" x="884.62" y="-158" font-family="Arial" font-size="20.00" fill="white">Data Layer</text>
<text text-anchor="middle" x="884.62" y="-134" font-family="Arial" font-size="20.00" fill="white">with the Model</text>
</g>
<!-- ViewModel&#45;&gt;Model -->
<g id="edge4" class="edge">
<title>ViewModel:ne-&gt;Model:nw</title>
<path fill="none" stroke="#1e90ff" stroke-width="2" stroke-dasharray="5,2" d="M577.35,-213.75C629.2,-244.31 776.42,-241.73 812.15,-206"></path>
<polygon fill="#1e90ff" stroke="#1e90ff" stroke-width="2" points="579.17,-210.22 569.07,-207 574.95,-215.81 579.17,-210.22"></polygon>
<text text-anchor="middle" x="716.11" y="-256.5" font-family="Arial" font-size="15.00" fill="#1874cd">Evento de cambio</text>
<text text-anchor="middle" x="716.11" y="-238.5" font-family="Arial" font-size="15.00" fill="#1874cd">en el modelo</text>
</g>
<!-- ViewModel&#45;&gt;Model -->
<g id="edge5" class="edge">
<title>ViewModel:se-&gt;Model:sw</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M569.07,-98C642.93,-24.15 729.69,-21.26 804.56,-89.35"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="801.97,-91.63 811.62,-96 806.81,-86.56 801.97,-91.63"></polygon>
<text text-anchor="middle" x="716.11" y="-71.5" font-family="Arial" font-size="15.00" fill="#104e8b">Operación CRUD</text>
</g>
</g>
</svg>
</p><p>Donde ...</p>
<ul>
<li><strong>View</strong> son los <strong>Componentes UI</strong> en nuestro caso los componentes de <strong>Jetpack Compose</strong> que renderizan los datos en la pantalla.</li>
<li><strong>ViewModel</strong> es el <strong>Contenedor de estados</strong> que contiene datos, los exponen a la IU y controlan la lógica.</li>
<li><strong>Model</strong> es una abstracción de los datos de la aplicación. En nuestro caso serán los <strong>Repositorios</strong> que se encargan de obtener los datos de una fuente de datos y convertirlos en un formato con el que el resto de la aplicación pueda trabajar.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Aunque nosotros durante el curso vamos a hablar de MVVM, al final nosotros vamos a aplicar el denominado MVI (Model-View-Intent) que es una variante de MVVM que se utiliza en aplicaciones Android y que se basa en la programación reactiva y que puedes ver un vídeo explicativo <strong><a href="https://www.youtube.com/watch?v=b2z1jvD4VMQ">aquí</a></strong>. Aunque posiblemente no lo entiendas hasta más adelante. Por lo que te recomiendo que veas este vídeo más adelante en el curso.</p>
</div>
<div style="page-break-after:always;"></div>
<h2 class="crossnote-header" id="visi%C3%B3n-general-de-la-arquitectura-en-un-proyecto-de-android">Visión general de la arquitectura en un proyecto de Android</h2>

<p>A la hora de concretar la arquitectura de una aplicación de Android, aunque hay una serie de recomendaciones por parte de Google, no hay una forma única de hacerlo. Por tanto, el equipo de desarrollo de una aplicación debe decidir algún tipo de <strong>convenio organizativo</strong> de paquetes, nombres de clases, etc. que se adapte a sus necesidades. De tal manera que cualquier miembro del equipo sepa encontrar fácilmente donde se encuentra la implementación de una determinada funcionalidad. Además de modificar fácilmente con el menor número de fallos y conflictos de trabajo en paralelo.</p>
<p>Esto último, se consigue creando diferentes módulos de la aplicación que se puedan desarrollar de forma independiente y que se puedan integrar fácilmente en el proyecto final. Sin embargo, la parte de modularización en diferentes paquetes no la vamos a abordar en este curso por falta de tiempo.</p>
<p>Descarga del siguiente enlace tienes un <strong><a href="cheatsheet_carpetas_arquitectura.pdf">'Cheat Sheet' de la Arquitectura</a></strong> propuesta en el curso que debes descargar y tener accesible durante el presente curso.</p>
<blockquote>
<p>📌 <strong>Nota</strong>: Vamos a empezar con una <strong>estructuración inicial del proyecto</strong> siguiendo el esquema propuesto en el cheatsheet anterior para ir aproximándonos a la arquitectura propuesta por Google y a medida que vayamos avanzando en el curso iremos concretando más sobre su implementación, las diferentes sub-capas de la arquitectura, los convenios de nombres que hemos usado en el curso, etc.</p>
</blockquote>
<div style="page-break-after:always;"></div>
<h3 class="crossnote-header" id="estructurando-el-modelo">Estructurando el Modelo</h3>

<div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px">
<div style="width: 80%">
<p>Aquí vamos a crear los modelos de datos que vamos a utilizar en nuestra aplicación. En nuestro caso, vamos a crear un modelo de datos para representar un <strong>Contacto</strong> de una Agenda.</p>
<p>Para ello, siguiendo es esquema de carpetas propuesto en el cheatsheet anterior, vamos a crear un paquete <strong><code>models</code></strong> dentro del paquete <strong>principal</strong> de nuestro proyecto.</p>
</div>
<div style="width: auto">
<p align="center" style="zoom:1" class="puml"><!--?xml version="1.0" encoding="us-ascii" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="78px" preserveAspectRatio="none" style="width:150px;height:78px;background:#FFFFFF;" version="1.1" viewBox="0 0 150 78" width="150px" zoomAndPan="magnify"><defs></defs><g><rect fill="#EEEEEE" height="18.0938" style="stroke:#000000;stroke-width:1.0;" width="71" x="6" y="6"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="42" x="8" y="20.457">Android</text><line style="stroke:#000000;stroke-width:1.0;" x1="66" x2="66" y1="6" y2="24.0938"></line><polygon fill="#000000" points="69,12,75,12,72,19.0938" style="stroke:#000000;stroke-width:1.0;"></polygon><path d="M17,31.1875 L17,33.1875 L25,33.1875 L25,32.1875 L20,32.1875 L20,31.1875 L17,31.1875 M17,34.1875 L17,38.6875 C17,38.9675 17.22,39.1875 17.5,39.1875 L24.5,39.1875 C24.78,39.1875 25,38.9675 25,38.6875 L25,34.1875 L17,34.1875 " fill="#000000" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="117" x="26" y="39.5508">[com.pmdm.agenda]</text><path d="M37,46.2813 L37,48.2813 L45,48.2813 L45,47.2813 L40,47.2813 L40,46.2813 L37,46.2813 M37,49.2813 L37,53.7813 C37,54.0613 37.22,54.2813 37.5,54.2813 L44.5,54.2813 C44.78,54.2813 45,54.0613 45,53.7813 L45,49.2813 L37,49.2813 " fill="#4169E1" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#4169E1" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="50" x="46" y="54.6445">[models]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="61" x="46" y="69.7383">Contacto.kt</text><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="9" y="33.6406"></rect><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="29" y="48.7344"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="10" x2="10" y1="36.6406" y2="49.7344"></line><line style="stroke:#888888;stroke-width:1.0;" x1="10" x2="28" y1="49.7344" y2="49.7344"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="51.7344" y2="64.8281"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="64.8281" y2="64.8281"></line><!--SRC=[JP1VIm915CNVvrFSfz1TN5RJY474MZKm9SdLbqWOTwxRqEnScJ-2ID-zYOhYljrxVkSSxjXvORqJsZDsORix8oqfkMENagMG9CEh0sc9TlHIKPCT6zbaeaOZnMkIi3HDOLYH9iijdONUwu2Z_qn34hNxaQPGaF6YyfIzU_OHPnoDlfDNMXY_MIxWXDOfCj3DUdcldrstohS0Czn3Tm2zdFTpdW-Wc9RmTMwpriDg0Ow2hH2aSjwgVV2HRxEvE0bu3iQh1Zay7T7C9u-_2vYQax9a6ZIUpRVBFy5DltElFApHnYQmNR897aJGFX8LIMLg3fjorhbb2s7g45_10HqhAFhQCuVf-XC0]--></g></svg></p></div>
</div>
<p>Este modelos serán clases '<em>generales</em>' o '<em>genéricas</em>' que representarán los datos de mi problema. Podremos definir roles entre ellas, así como relaciones de herencia, composición, etc. En algunos casos complejos incluso podremos definir casos de uso, etc.</p>
<p>Nosotros simplemente vamos a definir una clase <strong><code>Contacto</code></strong> que representará un contacto de una agenda. Para ello, vamos a crear un fichero <strong><code>Contacto.kt</code></strong> dentro del paquete <strong><code>models</code></strong> con el siguiente contenido.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin kotlin"><span class="token keyword keyword-data">data</span> <span class="token keyword keyword-class">class</span> <span class="token function">Contacto</span><span class="token punctuation">(</span>
    <span class="token keyword keyword-val">val</span> id<span class="token operator">:</span> Int<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> nombre<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> apellidos<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> foto<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> correo<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> telefono<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> categorias<span class="token operator">:</span> EnumSet<span class="token operator">&lt;</span>Categorias<span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-enum">enum</span> <span class="token keyword keyword-class">class</span> Categorias <span class="token punctuation">{</span>
        Amigos<span class="token punctuation">,</span> Trabajo<span class="token punctuation">,</span> Familia<span class="token punctuation">,</span> Emergencias
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><blockquote>
<p>✋ <strong>Importante</strong>: El modelo no debería tener ninguna referencia o <strong>dependencia</strong> de la <strong>capa de UI</strong> ni a la <strong>capa de datos</strong>.</p>
</blockquote>
<p>Para evitar que el modelo tenga <strong>dependencias</strong> por ejemplo de las bibliotecas del propio android. Fíjate que la propiedad <strong><code>foto</code></strong> es de tipo <strong><code>String?</code></strong> y no de tipo <strong><code>Bitmap?</code></strong> que nos obligaría a incluir el paquete <strong><code>android.graphics</code></strong> en el modelo. De esta manera la imagen puede ser una <strong>url</strong>, un <strong>path</strong>, un <strong>base64</strong>, etc. y la conversión a <strong><code>Bitmap</code></strong> la haremos en la capa de UI.</p>
<p>En nuestro caso hemos decidido que sea una cadena en <strong>base64</strong>. Si quieres saber más sobre que es <strong><code>base64</code></strong> puedes consultar el <strong>Apéndice I</strong> al final de este documento o bien a <a href="https://es.wikipedia.org/wiki/Base64">este enlace a la Wikipedia</a>.</p>
<div style="page-break-after:always;"></div>
<h3 class="crossnote-header" id="estructurando-la-capa-de-datos">Estructurando la capa de datos</h3>

<p>Ahondado <strong>un poco más</strong> el diagrama general de la capa de datos podríamos tener un esquema similar al siguiente:</p>
<p align="center" style="zoom:0.6" class="dot"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 8.1.0 (20230707.0739)
 -->
<!-- Title: G Pages: 1 -->
<svg width="957pt" height="304pt" viewBox="0.00 0.00 957.50 304.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 300)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-300 953.5,-300 953.5,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>clusterD</title>
<path fill="#4f94cd" stroke="#4f94cd" d="M362,-8C362,-8 929.5,-8 929.5,-8 935.5,-8 941.5,-14 941.5,-20 941.5,-20 941.5,-276 941.5,-276 941.5,-282 935.5,-288 929.5,-288 929.5,-288 362,-288 362,-288 356,-288 350,-282 350,-276 350,-276 350,-20 350,-20 350,-14 356,-8 362,-8"></path>
<text text-anchor="middle" x="645.75" y="-266" font-family="Arial" font-size="20.00" fill="white">Capa Datos</text>
</g>
<!-- Repositorio -->
<g id="node1" class="node">
<title>Repositorio</title>
<path fill="#b9d3ee" stroke="#b9d3ee" d="M539.64,-174C539.64,-174 372,-174 372,-174 366,-174 360,-168 360,-162 360,-162 360,-78 360,-78 360,-72 366,-66 372,-66 372,-66 539.64,-66 539.64,-66 545.64,-66 551.64,-72 551.64,-78 551.64,-78 551.64,-162 551.64,-162 551.64,-168 545.64,-174 539.64,-174"></path>
<text text-anchor="middle" x="455.82" y="-126" font-family="Arial" font-size="20.00">Data</text>
<text text-anchor="middle" x="455.82" y="-102" font-family="Arial" font-size="20.00">ContactoRepository</text>
</g>
<!-- Services -->
<g id="node2" class="node">
<title>Services</title>
<path fill="#6c7b8b" stroke="#6c7b8b" d="M891.57,-74C891.57,-74 807.57,-74 807.57,-74 801.57,-74 795.57,-68 795.57,-62 795.57,-62 795.57,-30 795.57,-30 795.57,-24 801.57,-18 807.57,-18 807.57,-18 891.57,-18 891.57,-18 897.57,-18 903.57,-24 903.57,-30 903.57,-30 903.57,-62 903.57,-62 903.57,-68 897.57,-74 891.57,-74"></path>
<text text-anchor="middle" x="849.57" y="-52" font-family="Arial" font-size="20.00" fill="white">Services</text>
<text text-anchor="middle" x="849.57" y="-28" font-family="Arial" font-size="20.00" fill="white">Api REST</text>
</g>
<!-- Repositorio&#45;&gt;Services -->
<g id="edge2" class="edge">
<title>Repositorio-&gt;Services</title>
<path fill="none" stroke="#104e8b" stroke-width="2" stroke-dasharray="5,2" d="M551.9,-102.04C623.41,-88.53 719.55,-70.37 782.74,-58.44"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="784.14,-61.36 793.31,-56.06 782.84,-54.48 784.14,-61.36"></polygon>
</g>
<!-- Room -->
<g id="node3" class="node">
<title>Room</title>
<path fill="#6c7b8b" stroke="#6c7b8b" d="M891.57,-148C891.57,-148 807.57,-148 807.57,-148 801.57,-148 795.57,-142 795.57,-136 795.57,-136 795.57,-104 795.57,-104 795.57,-98 801.57,-92 807.57,-92 807.57,-92 891.57,-92 891.57,-92 897.57,-92 903.57,-98 903.57,-104 903.57,-104 903.57,-136 903.57,-136 903.57,-142 897.57,-148 891.57,-148"></path>
<text text-anchor="middle" x="849.57" y="-126" font-family="Arial" font-size="20.00" fill="white">Room</text>
<text text-anchor="middle" x="849.57" y="-102" font-family="Arial" font-size="20.00" fill="white">Local DB</text>
</g>
<!-- Repositorio&#45;&gt;Room -->
<g id="edge1" class="edge">
<title>Repositorio-&gt;Room</title>
<path fill="none" stroke="#104e8b" stroke-width="2" stroke-dasharray="5,2" d="M551.9,-120C623.26,-120 719.14,-120 782.34,-120"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="782.31,-123.5 792.31,-120 782.31,-116.5 782.31,-123.5"></polygon>
</g>
<!-- Mocks -->
<g id="node4" class="node">
<title>Mocks</title>
<path fill="aliceblue" stroke="aliceblue" d="M919.5,-246C919.5,-246 779.64,-246 779.64,-246 773.64,-246 767.64,-240 767.64,-234 767.64,-234 767.64,-178 767.64,-178 767.64,-172 773.64,-166 779.64,-166 779.64,-166 919.5,-166 919.5,-166 925.5,-166 931.5,-172 931.5,-178 931.5,-178 931.5,-234 931.5,-234 931.5,-240 925.5,-246 919.5,-246"></path>
<text text-anchor="middle" x="849.57" y="-224" font-family="Arial" font-size="20.00">Mocks</text>
<text text-anchor="middle" x="849.57" y="-200" font-family="Arial" font-size="20.00">Datos Contactos</text>
<text text-anchor="middle" x="849.57" y="-176" font-family="Arial" font-size="20.00">de prueba</text>
</g>
<!-- Repositorio&#45;&gt;Mocks -->
<g id="edge3" class="edge">
<title>Repositorio-&gt;Mocks</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M551.9,-140.87C613.56,-154.41 693.52,-171.96 754.89,-185.44"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="754.78,-189.43 765.3,-188.16 756.28,-182.6 754.78,-189.43"></polygon>
</g>
<!-- Dominio -->
<g id="node5" class="node">
<title>Dominio</title>
<path fill="#36648b" stroke="#36648b" d="M132,-174C132,-174 12,-174 12,-174 6,-174 0,-168 0,-162 0,-162 0,-78 0,-78 0,-72 6,-66 12,-66 12,-66 132,-66 132,-66 138,-66 144,-72 144,-78 144,-78 144,-162 144,-162 144,-168 138,-174 132,-174"></path>
<text text-anchor="middle" x="72" y="-126" font-family="Arial" font-size="20.00" fill="white">Modelo</text>
<text text-anchor="middle" x="72" y="-102" font-family="Arial" font-size="20.00" fill="white">Contacto</text>
</g>
<!-- Dominio&#45;&gt;Repositorio -->
<g id="edge4" class="edge">
<title>Dominio-&gt;Repositorio</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M157.19,-120C217.04,-120 297.49,-120 359.66,-120"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="157.37,-116.5 147.37,-120 157.37,-123.5 157.37,-116.5"></polygon>
</g>
</g>
</svg>
</p><p>Vamos a concretar una propuesta de organización en paquetes y nomenclatura para el mismo que vamos a seguir durante el curso...</p>
<div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px">
<div style="width: 70%">
<ol>
<li>Crearemos <strong>paquete</strong> <strong><code>data</code></strong> dentro del paquete <strong>principal</strong> de nuestro proyecto. En él, vamos a crear los <strong>repositorios</strong> que se encargarán de obtener los datos de una fuente de datos y convertirlos en un formato con el que el resto de la aplicación pueda trabajar. Además, contendrá los paquetes que van a gestionar las diferentes fuentes de datos de nuestra aplicación y esto será lo primero que vamos hacer porque sin fuente no puede haber repositorio que la encapsule.</li>
</ol>
</div>
<div style="width: auto">
<p align="center" style="zoom:1" class="puml"><!--?xml version="1.0" encoding="us-ascii" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="153px" preserveAspectRatio="none" style="width:185px;height:153px;background:#FFFFFF;" version="1.1" viewBox="0 0 185 153" width="185px" zoomAndPan="magnify"><defs></defs><g><rect fill="#EEEEEE" height="18.0938" style="stroke:#000000;stroke-width:1.0;" width="71" x="6" y="6"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="42" x="8" y="20.457">Android</text><line style="stroke:#000000;stroke-width:1.0;" x1="66" x2="66" y1="6" y2="24.0938"></line><polygon fill="#000000" points="69,12,75,12,72,19.0938" style="stroke:#000000;stroke-width:1.0;"></polygon><path d="M17,31.1875 L17,33.1875 L25,33.1875 L25,32.1875 L20,32.1875 L20,31.1875 L17,31.1875 M17,34.1875 L17,38.6875 C17,38.9675 17.22,39.1875 17.5,39.1875 L24.5,39.1875 C24.78,39.1875 25,38.9675 25,38.6875 L25,34.1875 L17,34.1875 " fill="#000000" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="117" x="26" y="39.5508">[com.pmdm.agenda]</text><path d="M37,46.2813 L37,48.2813 L45,48.2813 L45,47.2813 L40,47.2813 L40,46.2813 L37,46.2813 M37,49.2813 L37,53.7813 C37,54.0613 37.22,54.2813 37.5,54.2813 L44.5,54.2813 C44.78,54.2813 45,54.0613 45,53.7813 L45,49.2813 L37,49.2813 " fill="#0000FF" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#0000FF" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="33" x="46" y="54.6445">[data]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="120" x="46" y="69.7383">ContactoRepository.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="131" x="46" y="84.832">RepositoryConverters.kt</text><path d="M47,91.5625 L47,93.5625 L55,93.5625 L55,92.5625 L50,92.5625 L50,91.5625 L47,91.5625 M47,94.5625 L47,99.0625 C47,99.3425 47.22,99.5625 47.5,99.5625 L54.5,99.5625 C54.78,99.5625 55,99.3425 55,99.0625 L55,94.5625 L47,94.5625 " fill="#4169E1" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#4169E1" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="47" x="56" y="99.9258">[mocks]</text><path d="M57,106.6563 L57,108.6563 L65,108.6563 L65,107.6563 L60,107.6563 L60,106.6563 L57,106.6563 M57,109.6563 L57,114.1563 C57,114.4363 57.22,114.6563 57.5,114.6563 L64.5,114.6563 C64.78,114.6563 65,114.4363 65,114.1563 L65,109.6563 L57,109.6563 " fill="#000000" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="58" x="66" y="115.0195">[contacto]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="112" x="66" y="130.1133">ContactoDaoMock.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="89" x="66" y="145.207">ContactoMock.kt</text><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="9" y="33.6406"></rect><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="29" y="48.7344"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="10" x2="10" y1="36.6406" y2="49.7344"></line><line style="stroke:#888888;stroke-width:1.0;" x1="10" x2="28" y1="49.7344" y2="49.7344"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="51.7344" y2="64.8281"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="64.8281" y2="64.8281"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="51.7344" y2="79.9219"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="79.9219" y2="79.9219"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="39" y="94.0156"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="51.7344" y2="95.0156"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="95.0156" y2="95.0156"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="49" y="109.1094"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="40" y1="97.0156" y2="110.1094"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="48" y1="110.1094" y2="110.1094"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="50" y1="112.1094" y2="125.2031"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="58" y1="125.2031" y2="125.2031"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="50" y1="112.1094" y2="140.2969"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="58" y1="140.2969" y2="140.2969"></line><!--SRC=[PL7RQi9047tVhvYdeWc6QBMK86BhfM0D5Os-b0fhThMBoOxiJWGH_xrRD2hjwxdCEJFJjSGDMPuHOqUsVD72e19BTaoO3vxNVbXZ9gJfVAQO1xjSv07VI2tub-Snt_UXdMA69bfbXUpSomMdKkD33pNnb70gTsWLeJa4MpfJDyY9zjAGDFPANeORFF3iNqAEwTQM4N-xdlEkxAr2dsFiZ6N47NE1J-p4kcx3yqac6TSqZyVWgbc56kf18smqWyTAybt0KAwWte9663N3A6n1Rv30BrrbbRV962mM9fKWb2MZLWKvVvMD-9x3jD2aSXd1nqxgKV-z162WzygWpgKcDbh4Dy5Ji_Qg26RIk2QmY5bVhdcHaNEaA9JUH31FXhLdDkPwKxWVHI0jww6RQmuH36O_]--></g></svg></p></div>
</div>
<ol start="2">
<li>
<p>Crearemos <strong>paquete</strong> <strong><code>mocks</code></strong> que definirá <strong>colecciones de objetos de prueba</strong> que simulan una fuente de datos. Como puede haber diferentes clases, vamos a crear un paquete <strong><code>mocks.contacto</code></strong> el cual definirá las clases que contienen los contactos de prueba.</p>
<ul>
<li>
<p><strong><a href="assets/codigo/ContactoMock.kt">ContactoMock.kt</a></strong> es una clase que define un objeto de prueba de tipo <strong><code>Contacto</code></strong>. En este caso es idéntica a la clase <strong><code>Contacto</code></strong> que hemos definido en el modelo. Sin embargo, en un caso real, podría ser diferente ya que el modelo es independiente de la fuente de datos.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin kotlin"><span class="token keyword keyword-data">data</span> <span class="token keyword keyword-class">class</span> <span class="token function">ContactoMock</span><span class="token punctuation">(</span>
    <span class="token keyword keyword-val">val</span> id<span class="token operator">:</span> Int<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> nombre<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> apellidos<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> foto<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> correo<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> telefono<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-val">val</span> categorias<span class="token operator">:</span> EnumSet<span class="token operator">&lt;</span>Categorias<span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-enum">enum</span> <span class="token keyword keyword-class">class</span> Categorias <span class="token punctuation">{</span>
        Amigos<span class="token punctuation">,</span> Trabajo<span class="token punctuation">,</span> Familia<span class="token punctuation">,</span> Emergencias
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre></li>
</ul>
 <div style="page-break-after:always;"></div>
<ul>
<li>
<p><strong><a href="assets/codigo/ContactoDaoMock.kt">ContactoDaoMock.kt</a></strong> es una clase que define una colección de objetos de prueba de tipo <strong><code>ContactoMock</code></strong>. En este caso, es una clase que implementa las operaciones CRUD (Create, Read, Update, Delete) sobre la colección de objetos de prueba como los siguientes...</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin kotlin"><span class="token keyword keyword-class">class</span> ContactoDaoMock <span class="token punctuation">{</span>
    <span class="token comment">// Colección de datos de prueba</span>
    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-var">var</span> contactos <span class="token operator">=</span> <span class="token function">mutableListOf</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

    <span class="token comment">// Obtiene una lista de contactos</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> MutableList<span class="token operator">&lt;</span>ContactoMock<span class="token operator">&gt;</span> <span class="token operator">=</span> contactos
    <span class="token comment">// Obtiene un contacto por Id</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">(</span>id<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> ContactoMock<span class="token operator">?</span> <span class="token operator">=</span> contactos<span class="token punctuation">.</span><span class="token function">find</span> <span class="token punctuation">{</span> u <span class="token operator">-&gt;</span> u<span class="token punctuation">.</span>id <span class="token operator">==</span> id <span class="token punctuation">}</span>
    <span class="token comment">// Inserta un contacto en la colección de contactos</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token function">insert</span><span class="token punctuation">(</span>contacto<span class="token operator">:</span> ContactoMock<span class="token punctuation">)</span> <span class="token operator">=</span> contactos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>contacto<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre></li>
</ul>
</li>
<li>
<p>Dentro del paquete <strong><code>data</code></strong>, crearemos el fichero <strong><a href="assets/codigo/RepositoryConverters.kt">RepositoryConverters.kt</a></strong> que contendrá las <strong>funciones de extensión</strong> para transformar el <strong>modelo</strong> y la <strong>fuente de datos</strong> y viceversa. Al usar funciones de extensión, podemos agregar métodos a una clase sin tener que modificar la definición de la clase manteniendo el principio OCP (Open-Closed Principle) de SOLID. Además, evitamos que el modelo tenga <strong>dependencias</strong> de la fuente de datos.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin kotlin"><span class="token comment">// Convierte un un objeto Contacto del modelo en un ContactoMock</span>
<span class="token keyword keyword-fun">fun</span> Contacto<span class="token punctuation">.</span><span class="token function">toContactoMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">ContactoMock</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

<span class="token comment">// Convierte un un objeto ContactoMock de la fuente de datos en un Contacto</span>
<span class="token keyword keyword-fun">fun</span> ContactoMock<span class="token punctuation">.</span><span class="token function">toContacto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Contacto</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</pre></li>
<li>
<p>entro del paquete <strong><code>data</code></strong>, crearemos el fichero <strong><a href="assets/codigo/ContactoRepository.kt">ContactoRepository.kt</a></strong> que contendrá la clase <strong><code>ContactoRepository</code></strong> que implementa las operaciones CRUD (Create, Read, Update, Delete) sobre <strong>objetos del modelo</strong> <strong><code>Contacto</code></strong> y se encargará de replicarlos en la fuente de datos en nuestro caso el '<em><strong>mock</strong></em>' de forma transparente.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin kotlin"><span class="token keyword keyword-class">class</span> ContactoRepository <span class="token punctuation">{</span>
    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-var">var</span> dao <span class="token operator">=</span> <span class="token function">ContactoDaoMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword keyword-fun">fun</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> MutableList<span class="token operator">&lt;</span>Contacto<span class="token operator">&gt;</span> <span class="token operator">=</span> dao<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span><span class="token function">toContacto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toMutableList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">(</span>id<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Contacto<span class="token operator">?</span> <span class="token operator">=</span> dao<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">toContacto</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token function">insert</span><span class="token punctuation">(</span>contacto<span class="token operator">:</span> Contacto<span class="token punctuation">)</span> <span class="token operator">=</span> dao<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>contacto<span class="token punctuation">.</span><span class="token function">toContactoMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre><blockquote>
<p>📣 <strong>Resumen</strong>: Podemos decir que es una envoltorio o '<em>Wapper</em>' que <strong>encapsula la fuente de datos</strong> y sus datos de forma que el resto de la aplicación pueda trabajar con ellos como un modelo genérico sin saber cual es la fuente de los mismos.</p>
<p>Aquí tienes un <strong><a href="https://www.youtube.com/watch?v=QqsH0OgqafA">vídeo</a></strong> que <strong>te pueden ayudar a tener una idea de su funcionamiento del patrón repository</strong> en en otros lenguajes de programación. No hace falta entender 100% el código, pero si la idea general del patrón.</p>
</blockquote>
</li>
</ol>
<div style="page-break-after:always;"></div>
<h3 class="crossnote-header" id="estructurando-la-capa-de-ui">Estructurando la capa de UI</h3>

<div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px">
<div style="width: 75%">
<p>Esta va a ser la capa más compleja organizativamente. Pues vamos atener diferentes paquetes para diferenciar claramente las diferentes partes de la capa de UI.</p>
<p>En el <strong>diagrama de la derecha</strong>, tienes nuestra propuesta de plantilla organizativa para esta capa que hay en el '<em>cheatsheet</em>'. Aunque en los futuros temas vamos a abordar con detalle los ficheros que vamos a crear en cada uno de los paquetes, vamos a hacer una <strong>primera aproximación</strong> a la estructura de la capa de UI para tener <strong>una visión global de la misma</strong>.</p>
<p>Esta estructura respondería a la <strong><a href="https://developer.android.com/jetpack/guide/ui-layer?hl=es-419#state-holders">propuesta de Google</a></strong> donde existe un <strong>contenedor de estados</strong> que contiene los datos, los expone a la IU y controla la lógica. En nuestro caso, este contenedor de estados será el <strong>ViewModel</strong>.</p>
<p align="center" style="zoom:0.5" class="dot"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 8.1.0 (20230707.0739)
 -->
<!-- Title: G Pages: 1 -->
<svg width="786pt" height="316pt" viewBox="0.00 0.00 786.30 316.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 312)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-312 782.3,-312 782.3,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>clusterUI</title>
<path fill="none" stroke="cornflowerblue" stroke-width="5" d="M268.3,-8C268.3,-8 758.3,-8 758.3,-8 764.3,-8 770.3,-14 770.3,-20 770.3,-20 770.3,-288 770.3,-288 770.3,-294 764.3,-300 758.3,-300 758.3,-300 268.3,-300 268.3,-300 262.3,-300 256.3,-294 256.3,-288 256.3,-288 256.3,-20 256.3,-20 256.3,-14 262.3,-8 268.3,-8"></path>
<text text-anchor="middle" x="725.62" y="-278" font-family="Arial" font-size="20.00" fill="cornflowerblue">Capa UI</text>
</g>
<!-- DataLayer -->
<g id="node1" class="node">
<title>DataLayer</title>
<path fill="#36648b" stroke="#36648b" d="M134.1,-227C134.1,-227 12,-227 12,-227 6,-227 0,-221 0,-215 0,-215 0,-59 0,-59 0,-53 6,-47 12,-47 12,-47 134.1,-47 134.1,-47 140.1,-47 146.1,-53 146.1,-59 146.1,-59 146.1,-215 146.1,-215 146.1,-221 140.1,-227 134.1,-227"></path>
<text text-anchor="middle" x="73.05" y="-131" font-family="Arial" font-size="20.00" fill="white">Capa de datos</text>
</g>
<!-- ViewModel -->
<g id="node2" class="node">
<title>ViewModel</title>
<path fill="#4f94cd" stroke="#4f94cd" d="M428.3,-228C428.3,-228 308.3,-228 308.3,-228 302.3,-228 296.3,-222 296.3,-216 296.3,-216 296.3,-60 296.3,-60 296.3,-54 302.3,-48 308.3,-48 308.3,-48 428.3,-48 428.3,-48 434.3,-48 440.3,-54 440.3,-60 440.3,-60 440.3,-216 440.3,-216 440.3,-222 434.3,-228 428.3,-228"></path>
<text text-anchor="middle" x="368.3" y="-132" font-family="Arial" font-size="20.00" fill="white">ViewModel</text>
</g>
<!-- DataLayer&#45;&gt;ViewModel -->
<!-- DataLayer&#45;&gt;ViewModel -->
<g id="edge5" class="edge">
<title>DataLayer-&gt;ViewModel</title>
<path fill="none" stroke="#104e8b" stroke-width="2" stroke-dasharray="1,5" d="M146.41,-107.67C146.41,-107.67 282.83,-107.67 282.83,-107.67"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="282.83,-111.17 292.83,-107.67 282.83,-104.17 282.83,-111.17"></polygon>
<text text-anchor="middle" x="206.2" y="-130.5" font-family="Arial" font-size="15.00" fill="#104e8b">Datos de</text>
<text text-anchor="middle" x="206.2" y="-112.5" font-family="Arial" font-size="15.00" fill="#104e8b">la Aplicación</text>
</g>
<!-- UIState -->
<g id="node3" class="node">
<title>UIState</title>
<path fill="darkslategray" stroke="darkslategray" d="M537.3,-138C537.3,-138 489.3,-138 489.3,-138 483.3,-138 477.3,-132 477.3,-126 477.3,-126 477.3,-78 477.3,-78 477.3,-72 483.3,-66 489.3,-66 489.3,-66 537.3,-66 537.3,-66 543.3,-66 549.3,-72 549.3,-78 549.3,-78 549.3,-126 549.3,-126 549.3,-132 543.3,-138 537.3,-138"></path>
<text text-anchor="middle" x="513.3" y="-108" font-family="Arial" font-size="20.00" fill="white">UI</text>
<text text-anchor="middle" x="513.3" y="-84" font-family="Arial" font-size="20.00" fill="white">State</text>
</g>
<!-- ViewModel&#45;&gt;UIState -->
<g id="edge1" class="edge">
<title>ViewModel-&gt;UIState</title>
<path fill="none" stroke="#104e8b" stroke-width="2" stroke-dasharray="1,5" d="M440.8,-102C453.41,-102 466.01,-102 477.09,-102"></path>
</g>
<!-- UI -->
<g id="node4" class="node">
<title>UI</title>
<path fill="#63b8ff" stroke="#63b8ff" d="M718.3,-228C718.3,-228 598.3,-228 598.3,-228 592.3,-228 586.3,-222 586.3,-216 586.3,-216 586.3,-60 586.3,-60 586.3,-54 592.3,-48 598.3,-48 598.3,-48 718.3,-48 718.3,-48 724.3,-48 730.3,-54 730.3,-60 730.3,-60 730.3,-216 730.3,-216 730.3,-222 724.3,-228 718.3,-228"></path>
<text text-anchor="middle" x="658.3" y="-144" font-family="Arial" font-size="20.00" fill="white">Componenres</text>
<text text-anchor="middle" x="658.3" y="-120" font-family="Arial" font-size="20.00" fill="white">en la UI</text>
</g>
<!-- ViewModel&#45;&gt;UI -->
<g id="edge3" class="edge">
<title>ViewModel-&gt;UI</title>
<path fill="none" stroke="#104e8b" stroke-width="2" d="M453.74,-183C453.74,-183 586.04,-183 586.04,-183"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="453.74,-179.5 443.74,-183 453.74,-186.5 453.74,-179.5"></polygon>
<text text-anchor="middle" x="513.3" y="-196.5" font-family="Arial" font-size="15.00" fill="#104e8b">Eventos</text>
<text text-anchor="middle" x="513.3" y="-178.5" font-family="Arial" font-size="15.00" fill="#104e8b"> </text>
</g>
<!-- UIState&#45;&gt;UI -->
<g id="edge2" class="edge">
<title>UIState-&gt;UI</title>
<path fill="none" stroke="#104e8b" stroke-width="2" stroke-dasharray="1,5" d="M549.52,-102C549.52,-102 573.07,-102 573.07,-102"></path>
<polygon fill="#104e8b" stroke="#104e8b" stroke-width="2" points="573.07,-105.5 583.07,-102 573.07,-98.5 573.07,-105.5"></polygon>
</g>
</g>
</svg>
</p></div>
<div style="width: auto">
<p align="center" style="zoom:1" class="puml"><!--?xml version="1.0" encoding="us-ascii" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="485px" preserveAspectRatio="none" style="width:241px;height:485px;background:#FFFFFF;" version="1.1" viewBox="0 0 241 485" width="241px" zoomAndPan="magnify"><defs></defs><g><rect fill="#EEEEEE" height="18.0938" style="stroke:#000000;stroke-width:1.0;" width="71" x="6" y="6"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="42" x="8" y="20.457">Android</text><line style="stroke:#000000;stroke-width:1.0;" x1="66" x2="66" y1="6" y2="24.0938"></line><polygon fill="#000000" points="69,12,75,12,72,19.0938" style="stroke:#000000;stroke-width:1.0;"></polygon><path d="M17,31.1875 L17,33.1875 L25,33.1875 L25,32.1875 L20,32.1875 L20,31.1875 L17,31.1875 M17,34.1875 L17,38.6875 C17,38.9675 17.22,39.1875 17.5,39.1875 L24.5,39.1875 C24.78,39.1875 25,38.9675 25,38.6875 L25,34.1875 L17,34.1875 " fill="#000000" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="113" x="26" y="39.5508">[com.pmdm.myapp]</text><path d="M27,46.2813 L27,48.2813 L35,48.2813 L35,47.2813 L30,47.2813 L30,46.2813 L27,46.2813 M27,49.2813 L27,53.7813 C27,54.0613 27.22,54.2813 27.5,54.2813 L34.5,54.2813 C34.78,54.2813 35,54.0613 35,53.7813 L35,49.2813 L27,49.2813 " fill="#0000FF" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#0000FF" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="18" x="36" y="54.6445">[ui]</text><path d="M37,61.375 L37,63.375 L45,63.375 L45,62.375 L40,62.375 L40,61.375 L37,61.375 M37,64.375 L37,68.875 C37,69.155 37.22,69.375 37.5,69.375 L44.5,69.375 C44.78,69.375 45,69.155 45,68.875 L45,64.375 L37,64.375 " fill="#4169E1" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#4169E1" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="51" x="46" y="69.7383">[themes]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="77" x="46" y="84.832">DarkTheme.kt</text><path d="M37,91.5625 L37,93.5625 L45,93.5625 L45,92.5625 L40,92.5625 L40,91.5625 L37,91.5625 M37,94.5625 L37,99.0625 C37,99.3425 37.22,99.5625 37.5,99.5625 L44.5,99.5625 C44.78,99.5625 45,99.3425 45,99.0625 L45,94.5625 L37,94.5625 " fill="#4169E1" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#4169E1" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="41" x="46" y="99.9258">[views]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="73" x="46" y="115.0195">MainActivity.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="72" x="46" y="130.1133">Fragments.kt</text><path d="M37,136.8438 L37,138.8438 L45,138.8438 L45,137.8438 L40,137.8438 L40,136.8438 L37,136.8438 M37,139.8438 L37,144.3438 C37,144.6238 37.22,144.8438 37.5,144.8438 L44.5,144.8438 C44.78,144.8438 45,144.6238 45,144.3438 L45,139.8438 L37,139.8438 " fill="#4169E1" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#4169E1" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="66" x="46" y="145.207">[navigation]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="93" x="46" y="160.3008">MainNavGraph.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="133" x="46" y="175.3945">Feature1ScreenRoute.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="133" x="46" y="190.4883">Feature2ScreenRoute.kt</text><path d="M37,197.2188 L37,199.2188 L45,199.2188 L45,198.2188 L40,198.2188 L40,197.2188 L37,197.2188 M37,200.2188 L37,204.7188 C37,204.9988 37.22,205.2188 37.5,205.2188 L44.5,205.2188 C44.78,205.2188 45,204.9988 45,204.7188 L45,200.2188 L37,200.2188 " fill="#4169E1" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#4169E1" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="85" x="46" y="205.582">[composables]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="91" x="46" y="220.6758">Composable1.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="188" x="46" y="235.7695">ComposableUiState1.kt (Optional)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="91" x="46" y="250.8633">Composable2.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="188" x="46" y="265.957">ComposableUiState2.kt (Optional)</text><path d="M37,272.6875 L37,274.6875 L45,274.6875 L45,273.6875 L40,273.6875 L40,272.6875 L37,272.6875 M37,275.6875 L37,280.1875 C37,280.4675 37.22,280.6875 37.5,280.6875 L44.5,280.6875 C44.78,280.6875 45,280.4675 45,280.1875 L45,275.6875 L37,275.6875 " fill="#4169E1" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#4169E1" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="56" x="46" y="281.0508">[features]</text><path d="M47,287.7813 L47,289.7813 L55,289.7813 L55,288.7813 L50,288.7813 L50,287.7813 L47,287.7813 M47,290.7813 L47,295.2813 C47,295.5613 47.22,295.7813 47.5,295.7813 L54.5,295.7813 C54.78,295.7813 55,295.5613 55,295.2813 L55,290.7813 L47,290.7813 " fill="#4169E1" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#4169E1" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="56" x="56" y="296.1445">[feature1]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="100" x="56" y="311.2383">Feature1Screen.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="120" x="56" y="326.332">Feature1ViewModel.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="56" y="341.4258">Feature1UiState.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="98" x="56" y="356.5195">Feature1Events.kt</text><path d="M57,363.25 L57,365.25 L65,365.25 L65,364.25 L60,364.25 L60,363.25 L57,363.25 M57,366.25 L57,370.75 C57,371.03 57.22,371.25 57.5,371.25 L64.5,371.25 C64.78,371.25 65,371.03 65,370.75 L65,366.25 L57,366.25 " fill="#4169E1" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#4169E1" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="79" x="66" y="371.6133">[component1]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="81" x="66" y="386.707">component1.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="121" x="66" y="401.8008">component1UiState.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="118" x="66" y="416.8945">component1Events.kt</text><path d="M57,423.625 L57,425.625 L65,425.625 L65,424.625 L60,424.625 L60,423.625 L57,423.625 M57,426.625 L57,431.125 C57,431.405 57.22,431.625 57.5,431.625 L64.5,431.625 C64.78,431.625 65,431.405 65,431.125 L65,426.625 L57,426.625 " fill="#000000" style="stroke:;stroke-width:0.0;stroke-dasharray:;"></path><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="79" x="66" y="431.9883">[component2]</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="81" x="66" y="447.082">component2.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="121" x="66" y="462.1758">component2UiState.kt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="118" x="66" y="477.2695">component2Events.kt</text><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="9" y="33.6406"></rect><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="19" y="48.7344"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="10" x2="10" y1="36.6406" y2="49.7344"></line><line style="stroke:#888888;stroke-width:1.0;" x1="10" x2="18" y1="49.7344" y2="49.7344"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="29" y="63.8281"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="20" y1="51.7344" y2="64.8281"></line><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="28" y1="64.8281" y2="64.8281"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="66.8281" y2="79.9219"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="79.9219" y2="79.9219"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="29" y="94.0156"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="20" y1="51.7344" y2="95.0156"></line><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="28" y1="95.0156" y2="95.0156"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="97.0156" y2="110.1094"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="110.1094" y2="110.1094"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="97.0156" y2="125.2031"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="125.2031" y2="125.2031"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="29" y="139.2969"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="20" y1="51.7344" y2="140.2969"></line><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="28" y1="140.2969" y2="140.2969"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="142.2969" y2="155.3906"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="155.3906" y2="155.3906"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="142.2969" y2="170.4844"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="170.4844" y2="170.4844"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="142.2969" y2="185.5781"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="185.5781" y2="185.5781"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="29" y="199.6719"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="20" y1="51.7344" y2="200.6719"></line><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="28" y1="200.6719" y2="200.6719"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="202.6719" y2="215.7656"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="215.7656" y2="215.7656"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="202.6719" y2="230.8594"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="230.8594" y2="230.8594"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="202.6719" y2="245.9531"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="245.9531" y2="245.9531"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="202.6719" y2="261.0469"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="261.0469" y2="261.0469"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="29" y="275.1406"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="20" y1="51.7344" y2="276.1406"></line><line style="stroke:#888888;stroke-width:1.0;" x1="20" x2="28" y1="276.1406" y2="276.1406"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="39" y="290.2344"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="30" y1="278.1406" y2="291.2344"></line><line style="stroke:#888888;stroke-width:1.0;" x1="30" x2="38" y1="291.2344" y2="291.2344"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="40" y1="293.2344" y2="306.3281"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="48" y1="306.3281" y2="306.3281"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="40" y1="293.2344" y2="321.4219"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="48" y1="321.4219" y2="321.4219"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="40" y1="293.2344" y2="336.5156"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="48" y1="336.5156" y2="336.5156"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="40" y1="293.2344" y2="351.6094"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="48" y1="351.6094" y2="351.6094"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="49" y="365.7031"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="40" y1="293.2344" y2="366.7031"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="48" y1="366.7031" y2="366.7031"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="50" y1="368.7031" y2="381.7969"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="58" y1="381.7969" y2="381.7969"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="50" y1="368.7031" y2="396.8906"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="58" y1="396.8906" y2="396.8906"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="50" y1="368.7031" y2="411.9844"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="58" y1="411.9844" y2="411.9844"></line><rect fill="none" height="2" style="stroke:#888888;stroke-width:1.0;" width="2" x="49" y="426.0781"></rect><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="40" y1="293.2344" y2="427.0781"></line><line style="stroke:#888888;stroke-width:1.0;" x1="40" x2="48" y1="427.0781" y2="427.0781"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="50" y1="429.0781" y2="442.1719"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="58" y1="442.1719" y2="442.1719"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="50" y1="429.0781" y2="457.2656"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="58" y1="457.2656" y2="457.2656"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="50" y1="429.0781" y2="472.3594"></line><line style="stroke:#888888;stroke-width:1.0;" x1="50" x2="58" y1="472.3594" y2="472.3594"></line><!--SRC=[ZLDRRzem57xthpXF4n0r8XcTfgYgsW6jnCXQbS3Bj4g7n0IhZXqvTYPKxR_FZ4koX36Kj-zsFX_7TuL6fGlacf1tydel4YLPyahU8-90htVpOILvGjNjzrXcRfubcPjjCCz_z7h4SU0cbbogOCaDlQsB3Ti9ZWebDyXRChsc6ItsKWT6gDwYBUI-wV-RIqP_LjuGcRYFDIkPtkpj3ZmeJ3CgT75HeC2IfQYP57-bViFoKM6-hb8fQgEeDuiLfU956asRdD_cpi-ssyrbWKjUMyVmY7d7_0gRivb6_OU2pbE-hOsysrJv_tRwRUVvZglTsQg2bwYzWxgvjqEn2b_O2mrbGdcRsbTk4-EoThqNBLbOGrNAWGeyfjJ1vkGwrnn-SfP_QfP_Aiy_CyklPlsotnqLoUxDFdCKUXvEeQIgi3S9dklt_O7xiHEjZLtJ4hnhyFl1e1_qhs4uZc1BTqddyNaAXJGgff2mGYksDDi_eKicM2Ay6A5PHWDuogcOZBuU01YBaYafjg-AJ1PX9VWqkFh2DCoeiarW4P8HNQ7XsZfYcJ2H1Z2F7gu-aocAr61gisb1XjBcgaq0uzbl]--></g></svg></p></div>
</div>
<p>Vamos a explicar brevemente los tres elementos de la Capa de UI y cada uno de los sub-paquetes que hemos creado en dentro del paquete <strong><code>UI</code></strong> que la representa.</p>
<blockquote>
<p>📌 <strong>Nota</strong>: Iremos profundizando en su implementación en los siguientes temas.</p>
</blockquote>
<p>Elementos que la forman:</p>
<ol>
<li>
<p><strong><code>ViewModel</code></strong> Como hemos comentado es el <strong>Contenedor de estados</strong> que contiene datos, los expone a la IU y controla la lógica. Podemos tener un <strong>ViewModel</strong> por cada <strong>pantalla</strong> de nuestra aplicación o compartirlo entre varias. Además, en nuestra propuesta de arquitectura se encargará gestionar:</p>
<ul>
<li>La <strong>gestión de los datos</strong> de los elementos visuales a través de objetos <strong><code>UiState</code></strong> que representan el estado de visualización de los componentes en la UI.</li>
<li>La <strong>lógica</strong> de la pantalla entre los que vamos a incluir la gestión de <strong>casos de uso</strong> de los objetos del modelo.</li>
<li>Derivada de gestión de la lógica tendremos la <strong>gestión de los eventos</strong> de los componentes en la UI.</li>
<li>Gestión de la visualización de estados de <strong>error</strong>.</li>
<li>Transformación de los objetos del <strong>UiState</strong> a los objetos de <strong>Modelo</strong> y viceversa.</li>
<li>Comunicación con la <strong>capa de datos</strong> a través de las '<em>clases repositorio</em>'.</li>
</ul>
</li>
<li>
<p><strong><code>UiState</code></strong> estará representado por una o varias clases que representarán el <strong>estado de visualización</strong> de los elementos visuales de la pantalla. Podríamos tener:</p>
<ul>
<li>Un <strong><code>UiState</code></strong> por cada <strong>elemento visual</strong> de la pantalla. Por ejemplo, un <strong><code>UiState</code></strong> de tipo booleano para representar el estado de un <strong>icono</strong> o si se visualiza o no un <strong>circulo de progreso</strong>, etc.</li>
<li>Un <strong><code>UiState</code></strong> por cada <strong>grupo de elementos visuales relacionados entre si</strong> en la pantalla. Por ejemplo, una <strong><code>data class NombreCompletoUiState</code></strong> con <strong><code>nombre</code></strong>, <strong><code>apellido1</code></strong> y <strong><code>apellido2</code></strong> a modo de <strong><code>UiState</code></strong> para representar el estado de <strong>tres campos de texto</strong> que representen el nombre completo de una persona.</li>
<li>Un <strong><code>UiState</code></strong> por cada <strong>pantalla</strong> de nuestra aplicación que a su vez este formado por UiStates de grupo de elementos visuales que se repitan entre pantallas.</li>
</ul>
</li>
<li>
<p><strong><code>Componentes en la UI</code></strong> son los elementos visuales que renderizan los datos en la pantalla. En nuestro caso, serán los componentes de <strong>Jetpack Compose</strong> que renderizan los datos en la pantalla. Sin embargo, podría sustituir de forma sencilla por componentes tradicionales de <strong>XML</strong> o <em>'Vistas'</em>.</p>
</li>
</ol>
<p>Sub-paquetes de la capa de UI:</p>
<ol>
<li><strong><code>ui.themes</code></strong> es un paquete que contendrá los diferentes temas de la aplicación. Que contendrán los colores, tipografías, etc. que vamos a usar en nuestra aplicación.</li>
<li><strong><code>ui.views</code></strong> es un paquete que contendrá las diferentes vistas de la aplicación. En nuestro caso, tendremos una única vista que será la <strong><code>MainActivity</code></strong> que será la actividad principal de nuestra aplicación. Solo si tuviéramos, puntos de entrada secundarios en nuestra aplicación definiríamos más '<em>activities</em>'.</li>
<li><strong><code>ui.navigation</code></strong> es un paquete que contendrá el grafo de navegación de nuestra aplicación. Con las diferentes rutas de navegación entre las pantallas.</li>
<li><strong><code>ui.composables</code></strong> aquí definiremos aquellos componentes personalizados de la aplicación que sean <strong>reutilizables</strong> entre diferentes pantallas y las clases que representen su <strong>UiState</strong> si fuera necesario.</li>
<li><strong><code>ui.features</code></strong> es un paquete que contendrá las diferentes pantallas de nuestra aplicación. En nuestro ejemplo de plantilla, tendremos la pantalla <strong><code>Feature1Screen</code></strong> con un <strong>ViewModel</strong> para gestionarla definido en la clase <strong><code>Feature1ViewModel</code></strong> y su correspondiente <strong>UiState</strong> definido en la clase <strong><code>Feature1UiState</code></strong>. Además, si esta pantalla esta compuesta por diferentes grupos lógicos de elementos visuales, podríamos crear un paquete <strong><code>component1</code></strong> y <strong><code>component2</code></strong> con sus correspondientes <strong>ViewModel</strong> y <strong>UiState</strong> para gestionarlos. De esta manera si tuviéramos que reutilizarlos en otra pantalla, podríamos hacerlo fácilmente conservando toda la lógica.</li>
</ol>
<div style="page-break-after:always;"></div>
<h2 class="crossnote-header" id="ap%C3%A9ndice-i---codificando-im%C3%A1genes-en-base64">Apéndice I - Codificando imágenes en Base64</h2>

<p>En ocasiones, necesitamos codificar una imagen en Base64 para poder enviarla a un servidor o almacenarla en una base de datos. Para ello, podemos usar la siguiente función que nos permite codificar una imagen en Base64.</p>
<p>La <strong>codificación base64</strong> consiste en realizar <strong>agrupaciones de 6 bits</strong> y asignarle un  carácter:</p>
<ul>
<li>Letras mayúsculas (<strong>0-25</strong>): ABCDEFGHIJKLMNOPQRSTUVWXYZ</li>
<li>Letras minúsculas (<strong>26-51</strong>): abcdefghijklmnopqrstuvwxyz</li>
<li>Dígitos decimales (<strong>52-61</strong>): 0123456789</li>
<li>Símbolos especiales (<strong>62-63</strong>): +/</li>
</ul>
<p>Si la cadena de bytes no contiene exactamente un múltiplo de 6 bits, se <strong>completará con ceros</strong>.</p>
<div class="caso_estudio">
<p><strong>Ejemplo</strong>: Supongamos la cadena ...</p>
<table>
<thead>
<tr>
<th><strong>Cadena</strong></th>
<th><strong>Binario</strong></th>
<th><strong>Hexadecimal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>aØ</td>
<td>0110 0001 1100 0011 1001 1000</td>
<td>61 C3 98</td>
</tr>
<tr>
<td>Si queremos codificar esta cadena de bits en Base64 tendremos que realizar <strong>grupos de 6 bits</strong>:</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><strong>Binario</strong></th>
<th><strong>Grupos de 6 bits</strong></th>
<th><strong>Base 64</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0110 0001 1100 0011 1001 1000</td>
<td>011000 011100 001110 01100</td>
<td>YcOY</td>
</tr>
</tbody>
</table>
</div> <!-- fin caso de estudio -->
<p>Aquí tienes diferentes URL's de utilidad que te permiten codificar y decodificar textos e imágenes en Base64:</p>
<ul>
<li><a href="https://codebeautify.org/text-to-base64-converter">https://codebeautify.org/text-to-base64-converter</a></li>
<li><a href="https://codebeautify.org/base64-to-text-converter">https://codebeautify.org/base64-to-text-converter</a></li>
<li><a href="https://codebeautify.org/image-to-base64-converter">https://codebeautify.org/image-to-base64-converter</a></li>
<li><a href="https://codebeautify.org/base64-to-image-converter">https://codebeautify.org/base64-to-image-converter</a></li>
</ul>
<div style="page-break-after:always;"></div>
<h3 class="crossnote-header" id="funciones-de-utilidad-para-codificar-y-decodificar-im%C3%A1genes">Funciones de utilidad para codificar y decodificar imágenes</h3>

<p>En el <strong><code>proyectoBase</code></strong> se ha incluido una <strong>librería de utilidades</strong> hecha por los profesores del módulo para gestión de imágenes de forma '<em>sencilla</em>'. Purdes encontrar su implementación en el siguiente repositorio de <strong>GitHub</strong> público <a href="https://github.com/pmdmiesbalmis/utilities">https://github.com/pmdmiesbalmis/utilities</a>.</p>
<p>Para usarla en los proyectos de Android, debes incluir entrada en la sección <strong><code>[libraries]</code></strong> del <strong><code>libs.versions.toml</code></strong> del proyecto de la siguiente forma:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin kotlin">pmdm<span class="token operator">-</span>ies<span class="token operator">-</span>balmis<span class="token operator">-</span>utilities <span class="token operator">=</span> <span class="token punctuation">{</span> 
            group <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"com.github.pmdmiesbalmis"</span></span><span class="token punctuation">,</span> 
            name <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"utilities"</span></span><span class="token punctuation">,</span> 
            version<span class="token punctuation">.</span>ref <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"pmdmIesBalmisVersion"</span></span> 
<span class="token punctuation">}</span>
</pre><p>Posteriormente debes incluir la dependencia en el <strong><code>build.gradle.kts</code></strong> del módulo de la siguiente forma:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin kotlin">dependencies <span class="token punctuation">{</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span>libs<span class="token punctuation">.</span>pmdm<span class="token punctuation">.</span>ies<span class="token punctuation">.</span>balmis<span class="token punctuation">.</span>utilities<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre><p>Para usar librería en un funte de código, debes importar todas la funciones de extensión de la siguiente forma:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin kotlin"><span class="token keyword keyword-import">import</span> com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>pmdmiesbalmis<span class="token punctuation">.</span>utilities<span class="token punctuation">.</span>imagetools<span class="token punctuation">.</span><span class="token operator">*</span>
</pre><p>A partir de ese momento dispondrás de las siguientes funciones de extensión...</p>
<ol>
<li><strong><code>ImageBitmap.resize(ladoLargo: Int): ImageBitmap</code></strong>: Redimensiona una <code>ImageBitmap</code> manteniendo la relación de aspecto.</li>
<li><strong><code>ImageBitmap.toBase64(formato: FormatosCompresion = FormatosCompresion.PNG_90): String</code></strong>: Convierte una <code>ImageBitmap</code> a un <code>String</code> codificado en Base64.</li>
<li><strong><code>ImageBitmap.toBlob(formato: FormatosCompresion = FormatosCompresion.PNG_90): ByteArray</code></strong>: Convierte una <code>ImageBitmap</code> a un <code>ByteArray</code>.</li>
<li><strong><code>String.base64ToImageBitmap(): ImageBitmap</code></strong>: Convierte un <code>String</code> codificado en Base64 a una <code>ImageBitmap</code>.</li>
<li><strong><code>ByteArray.toImageBitmap(): ImageBitmap</code></strong>: Convierte un <code>ByteArray</code> a una <code>ImageBitmap</code>.</li>
<li><strong><code>Context.imageBitmapFromRerouceId(recurso: Int): ImageBitmap</code></strong>: Carga una <code>ImageBitmap</code> desde un recurso de la aplicación Android sin compresión.</li>
<li><strong><code>Context.imageBitmapFromUri(uri: Uri, formato: FormatosCompresion = FormatosCompresion.JPG_75, tamanoMaxKB: Int = 512): ImageBitmap?</code></strong>: Carga una <code>ImageBitmap</code> desde una Uri, con control de tamaño y formato.</li>
</ol>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>