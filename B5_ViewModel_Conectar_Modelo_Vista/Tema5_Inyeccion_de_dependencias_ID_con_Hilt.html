<!DOCTYPE html><html><head>
      <title>Inyecci&#xF3;n de dependencias ID con Hilt</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p,html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div{display:inline}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  300px/2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <style>/* 
Añade 

@import "../EstilosPersonalizadosMarkdownEnhanced.less"

justo después del front matter 
*/
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v18/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
</style>
<h1 class="mume-header undefined" id="tema-x---inyecci%C3%B3n-de-dependencias-id-con-hilt">Tema X - Inyecci&#xF3;n de dependencias ID con Hilt</h1>

<p>Descargar estos apuntes <a href="./x.pdf">pdf</a> o <a href="./x.html">html</a></p>
<p>&#xCD;ndice</p>

<div class="md-toc">
<div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#introducci&#xF3;n" class="md-toc-link">
            <p>Introducci&#xF3;n</p>

          </a></div><details style="padding:0;;padding-left:0px;" open>
        <summary class="md-toc-link-wrapper">
          <a href="#hilt" class="md-toc-link"><p>Hilt</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#configuraci&#xF3;n" class="md-toc-link">
            <p>Configuraci&#xF3;n</p>

          </a></div><details style="padding:0;;padding-left:24px;" open>
        <summary class="md-toc-link-wrapper">
          <a href="#preparando-los-componentes-de-android-para-la-inyecci&#xF3;n-de-dependencias" class="md-toc-link"><p>Preparando los componentes de Android para la inyecci&#xF3;n de dependencias</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#c&#xF3;mo-insertar-objetos-viewmodel-con-hilt-en-compose" class="md-toc-link">
            <p>C&#xF3;mo insertar objetos ViewModel con Hilt en Compose</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#exponer-dependencias-y-preparar-m&#xF3;dulos-con-hilt" class="md-toc-link">
            <p>Exponer dependencias y preparar m&#xF3;dulos con Hilt</p>

          </a></div>
        </div>
      </details>
    
</div>
<div style="page-break-after:always;"></div>
<h2 class="mume-header" id="introducci%C3%B3n">Introducci&#xF3;n</h2>

<p>La inyecci&#xF3;n de dependencias (DI) es una t&#xE9;cnica muy utilizada en programaci&#xF3;n y adecuada para el desarrollo de Android. Si sigues los principios de la DI, sentar&#xE1;s las bases para una buena arquitectura de apps.</p>
<p>Implementar la inyecci&#xF3;n de dependencias te proporciona las siguientes ventajas:</p>
<ul>
<li>Reutilizaci&#xF3;n de c&#xF3;digo</li>
<li>Facilidad de refactorizaci&#xF3;n.</li>
<li>Facilidad de prueba o test</li>
</ul>
<blockquote>
<p>&#x1F517; <strong>Fuente:</strong> <a href="https://developer.android.com/training/dependency-injection?hl=es-419#conclusion">documentaci&#xF3;n oficial de Android</a></p>
</blockquote>
<p>Una de las razones de por qu&#xE9; necesitamos inyecci&#xF3;n de dependencias. Es porque durante el desarrollo de un proyecto, es importante aplicar el Principio de Responsabilidad &#xDA;nica (SRP), uno de los 5 principios <strong>SOLID</strong>. Este principio establece, por explicarlo de forma simple, que nuestras entidades o clases deben hacer una sola cosa. Esto hace que las clases sean m&#xE1;s legibles, f&#xE1;ciles de modificar y de probar.</p>
<p>Sin embargo, este principio puede llevar a la <strong>creaci&#xF3;n de muchos m&#xF3;dulos con muchas dependencias entre ellos</strong>. Gestionar estas dependencias puede ser un problema ya que no se pueden ver los colaboradores de las entidades desde fuera y los m&#xF3;dulos no pueden ser probados de forma aislada. Para evitar esto, es importante que cada m&#xF3;dulo <strong>exponga sus dependencias</strong>. Tambi&#xE9;n, est&#xE1; &#xED;ntimamente relacionado con el principio de inversi&#xF3;n de dependencias (DIP) que vimos en primero tambi&#xE9;n y que deforma resumida establece los m&#xF3;dulos (clases) no deben crear sus dependencias, sino que deben ser provistas desde fuera.</p>
<p>Puesto que los m&#xF3;dulos exponen sus dependencias a trav&#xE9;s de sus constructores y se necesita un componente adicional para proporcionarles instancias de memoria de estas dependencias. Crear una pieza que proporcione todas las dependencias puede ser un trabajo dif&#xED;cil, por lo que existen los inyectores de dependencias para facilitar este proceso.</p>
<p>En el caso de <strong>aplicaciones grandes</strong>, tomar todas las dependencias y conectarlas correctamente puede requerir una gran cantidad de c&#xF3;digo est&#xE1;ndar. En una arquitectura de varias capas, para crear un objeto en una capa superior, debes proporcionar todas las dependencias de las capas que se encuentran debajo de ella. Por ejemplo, para construir un autom&#xF3;vil real, es posible que necesites un motor, una transmisi&#xF3;n, un chasis y otras piezas; a su vez, el motor necesita cilindros y buj&#xED;as.</p>
<p>Cuando no puedes construir dependencias antes de pasarlas (por ejemplo, si usas inicializaciones diferidas o solicitas permisos para objetos en los flujos de tu app), necesitas escribir y conservar un contenedor personalizado (<strong>o un grafo de dependencias</strong>) que administre las dependencias en la memoria desde el principio.</p>
<p>Hay bibliotecas que resuelven este problema automatizando el proceso de creaci&#xF3;n y provisi&#xF3;n de dependencias. Se dividen en dos categor&#xED;as:</p>
<ol>
<li>
<p>Soluciones basadas en reflexiones que conectan las dependencias durante el <strong>tiempo de ejecuci&#xF3;n</strong>.</p>
</li>
<li>
<p>Soluciones est&#xE1;ticas que generan el c&#xF3;digo para conectar las dependencias durante el <strong>tiempo de compilaci&#xF3;n</strong> (Las m&#xE1;s usadas).</p>
</li>
</ol>
<p>Dagger es una biblioteca de inserci&#xF3;n de dependencias popular para Java, Kotlin y Android que mantiene Google. Dagger facilita el uso de la DI en tu app mediante la creaci&#xF3;n y administraci&#xF3;n del <strong>grafo de dependencias</strong>. Proporciona dependencias totalmente est&#xE1;ticas y en tiempo de compilaci&#xF3;n que abordan muchos de los problemas de desarrollo y rendimiento de las soluciones basadas en reflexiones.</p>
<p>Por tanto, casi todos los frameworks modernos proveen alg&#xFA;n tipo de librer&#xED;a de inyecci&#xF3;n de dependencias. En el ecosistema de Java existen diferentes opciones como <a href="(https://dagger.dev/)">Dagger2</a>, <a href="https://insert-koin.io/">Koin</a> para Kotlin e incluso <a href="https://jakarta.ee/specifications/cdi/3.0/jakarta-cdi-spec-3.0.html">JCDI</a> en Jakarta EE.</p>
<p>En Android, la librer&#xED;a m&#xE1;s popular es Dagger2. Sin embargo, Dagger2 es una librer&#xED;a muy compleja y requiere de mucho c&#xF3;digo boilerplate para configurarla. Por eso, Google ha desarrollado <a href="https://dagger.dev/hilt/">Hilt</a>, una librer&#xED;a de inyecci&#xF3;n de dependencias que se integra con el framework nativo de Android y que <strong>elimina mucho c&#xF3;digo boilerplate</strong> necesario en Dagger2.</p>
<blockquote>
<p>&#x1F4E3; <strong>Resumen</strong>: En resumen, la inyecci&#xF3;n de dependencias no es m&#xE1;s que una forma autom&#xE1;tica de proveer dependencias a los m&#xF3;dulos que las requieran. Para requerirlas tienen que exponerlas por constructor.</p>
<p>Podemos pensar en el inyector de dependencias como un chef en una cocina. Los m&#xF3;dulos o clases ser&#xED;an los platos y las dependencias los ingredientes. Cada vez que un plato requiera un ingrediente, el chef ir&#xE1; a la despensa y lo a&#xF1;adir&#xE1; a la receta.</p>
<p>La gran mayor&#xED;a de inyectores de dependencias funcionan de la misma forma:</p>
<ul>
<li>Los m&#xF3;dulos exponen sus dependencias a trav&#xE9;s de sus constructores.</li>
<li>Un inyector de dependencias se encarga de proveer instancias de memoria de las dependencias a los m&#xF3;dulos que las requieran.</li>
<li>Existen diferentes librer&#xED;as de ID en Android de dependencias: <strong>Hilt</strong>, Koin, Dagger2...</li>
</ul>
</blockquote>
<h2 class="mume-header" id="hilt">Hilt</h2>

<p><a href="https://developer.android.com/training/dependency-injection/hilt-android?hl=es-419">Hilt</a> es una librer&#xED;a de inyecci&#xF3;n de dependencias desarrollada y recomendada por Google en incluida en el framework nativo de Android.</p>
<p>La principal caracter&#xED;stica de Hilt es su facilidad de uso y la cantidad de c&#xF3;digo boilerplate que elimina con respecto a la integraci&#xF3;n de Dagger. Por tanto, el objetivo de Hilt es hacer todo este proceso muy sencillo e integrado con el framework nativo de Android.</p>
<h3 class="mume-header" id="configuraci%C3%B3n">Configuraci&#xF3;n</h3>

<p>La form de incluir Hilt en nuestro proyecto de forma actualizada la puedes encontrar a <a href="https://developer.android.com/training/dependency-injection/hilt-android?hl=es-419#setup">Aqu&#xED; &#x1F517;</a>. Pero a fecha de escritura de este tutorial ser&#xED;a:</p>
<p>En el <strong><code>build.gradle</code></strong> ra&#xED;z a&#xF1;adiremos el siguiente plugin:</p>
<pre data-role="codeBlock" data-info="groovy" class="language-groovy">plugins <span class="token punctuation">{</span>
  <span class="token punctuation">...</span>
  id <span class="token string">&apos;com.google.dagger.hilt.android&apos;</span> version <span class="token string">&apos;2.44&apos;</span>
  apply <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</pre><p>En el <strong><code>build.gradle</code></strong> del m&#xF3;dulo de la aplicaci&#xF3;n a&#xF1;adiremos:</p>
<pre data-role="codeBlock" data-info="groovy" class="language-groovy">plugins <span class="token punctuation">{</span>
  <span class="token punctuation">...</span>

  <span class="token comment">// Process Java annotations</span>
  id <span class="token string">&apos;kotlin-kapt&apos;</span> 
  
  <span class="token comment">// Apply the Dagger/Hilt plugin</span>
  id <span class="token string">&apos;com.google.dagger.hilt.android&apos;</span> 
<span class="token punctuation">}</span>

android <span class="token punctuation">{</span>
    <span class="token punctuation">...</span>
    <span class="token comment">// Debemos usar Java 17 para que Hilt funcione correctamente</span>
    <span class="token comment">// por tanto para nuestro proyecto debemos cambiar en las opciones del proyecto</span>
    <span class="token comment">// el JDK a la versi&#xF3;n 17 (Preferiblemente Embedded JDK 17)</span>
    <span class="token comment">// para no tener problemas al mover el proyecto de ordenador.</span>
    compileOptions <span class="token punctuation">{</span>
        sourceCompatibility JavaVersion<span class="token punctuation">.</span>VERSION_17
        targetCompatibility JavaVersion<span class="token punctuation">.</span>VERSION_17
    <span class="token punctuation">}</span>
    kotlinOptions <span class="token punctuation">{</span>
        jvmTarget <span class="token operator">=</span> <span class="token string">&apos;17&apos;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">...</span>
<span class="token punctuation">}</span>

dependencies <span class="token punctuation">{</span>
  <span class="token comment">// Hilt</span>
  implementation <span class="token string">&quot;com.google.dagger:hilt-android:2.44&quot;</span>

  <span class="token comment">// Para la integraci&#xF3;n con Navigation</span>
  implementation <span class="token string">&quot;androidx.hilt:hilt-navigation-compose:1.0.0&quot;</span>

  <span class="token comment">// Annotation processor for Dagger</span>
  kapt <span class="token string">&quot;com.google.dagger:hilt-compiler:2.44&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Permitir la inyecci&#xF3;n de dependencias en clases de Android</span>
kapt <span class="token punctuation">{</span>
  correctErrorTypes <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</pre><p>Tras ello pulsamos &apos;<em>Sync Now</em>&apos; para sincronizar los cambios en Gradle.</p>
<h3 class="mume-header" id="preparando-los-componentes-de-android-para-la-inyecci%C3%B3n-de-dependencias">Preparando los componentes de Android para la inyecci&#xF3;n de dependencias</h3>

<p>En el paquete ra&#xED;z creamos una clase que extienda de <strong><code>Application</code></strong> y le a&#xF1;adimos la anotaci&#xF3;n <strong><code>@HiltAndroidApp</code></strong> para indicar que es la clase principal de la aplicaci&#xF3;n:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token comment">// Indicamos que es la clase principal de la aplicaci&#xF3;n</span>
<span class="token comment">// Esta clase se ejecutar&#xE1; antes que cualquier otra clase de la aplicaci&#xF3;n</span>
<span class="token comment">// y se encargar&#xE1; de proveer las dependencias a los m&#xF3;dulos que las requieran</span>
<span class="token annotation builtin">@HiltAndroidApp</span>
<span class="token keyword keyword-class">class</span> MyApplication <span class="token operator">:</span> <span class="token function">Application</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</pre><p>A continuaci&#xF3;n, en el <strong><code>AndroidManifest.xml</code></strong> a&#xF1;adimos la clase que acabamos de crear como la clase principal de la aplicaci&#xF3;n:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>application</span>
  <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.MyApplication<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">android:</span>allowBackup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">...</span><span class="token punctuation">&gt;</span></span>

  ...

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>application</span><span class="token punctuation">&gt;</span></span>
</pre><p>Aunque no es necesario, es recomendable a&#xF1;adir la anotaci&#xF3;n <strong><code>@AndroidEntryPoint</code></strong> a la MainActivity para que Hilt pueda inyectar dependencias en ella:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token annotation builtin">@AndroidEntryPoint</span>
<span class="token keyword keyword-class">class</span> MainActivity <span class="token operator">:</span> <span class="token function">ComponentActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</pre><h4 class="mume-header" id="c%C3%B3mo-insertar-objetos-viewmodel-con-hilt-en-compose">C&#xF3;mo insertar objetos ViewModel con Hilt en Compose</h4>

<blockquote>
<p>&#x1F517; <strong>Fuente</strong>: <a href="https://developer.android.com/jetpack/compose/libraries?hl=es-419#hilt">Documentaci&#xF3;n oficial</a></p>
<p>:pushpin <strong>Nota</strong>: Recuerda que para usar Hilt en Compose debes a&#xF1;adir la dependencia <code>implementation &quot;androidx.hilt:hilt-navigation-compose:1.0.0&quot;</code> en el <strong><code>build.gradle</code></strong> del m&#xF3;dulo de la aplicaci&#xF3;n.</p>
</blockquote>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token comment">// Inyectamos el contexto de la aplicaci&#xF3;n</span>
<span class="token annotation builtin">@HiltViewModel</span>
<span class="token keyword keyword-class">class</span> MiViewModel <span class="token annotation builtin">@Inject</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token comment">// Posteriormente cuando queramos usar el ViewModel haremos ...</span>
<span class="token keyword keyword-val">val</span> miViewModel <span class="token operator">:</span> MiViewModel <span class="token operator">=</span> <span class="token function">hiltViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// o tambi&#xE9;n </span>
<span class="token keyword keyword-val">val</span> miViewModel <span class="token operator">=</span> hiltViewModel<span class="token operator">&lt;</span>MiViewModel<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Tambi&#xE9;n podemos obtener un ViewModel con alcance o Scope e una ruta de navegaci&#xF3;n de Compose</span>
<span class="token comment">// Veremos m&#xE1;s adelante c&#xF3;mo funciona la navegaci&#xF3;n en Compose y c&#xF3;mo hacer este tipo de inyecci&#xF3;n</span>
<span class="token comment">// de forma m&#xE1;s concreta.</span>
<span class="token keyword keyword-val">val</span> miViewModel <span class="token operator">=</span> hiltViewModel<span class="token operator">&lt;</span>ViewModel<span class="token operator">&gt;</span><span class="token punctuation">(</span>navBackStackEntry<span class="token punctuation">)</span>
</pre><h3 class="mume-header" id="exponer-dependencias-y-preparar-m%C3%B3dulos-con-hilt">Exponer dependencias y preparar m&#xF3;dulos con Hilt</h3>

<p>Realmente ya lo hemos hecho al usar el viewmodel, y es a trav&#xE9;s de la anotaci&#xF3;n <strong><code>@Inject</code></strong>. Con esta anotaci&#xF3;n indicamos que queremos inyectar una dependencia en el constructor de una clase. En otras palabras, le estamos diciendo a Hilt que queremos que nos provea una instancia de memoria de una dependencia que necesitamos. Nos ser&#xE1; &#xFA;til para indicar que necesitamos instancias de otros m&#xF3;dulos tales como repositorios, servicios, etc.</p>
<p>Pero tambi&#xE9;n deberemos preparar los m&#xF3;dulos que queramos inyectar con Hilt. Para ello, debemos a&#xF1;adir la anotaci&#xF3;n <strong><code>@Module</code></strong> a la clase que queramos inyectar. En otras palabras, deberemos anotar aquellas clases que queramos que Hilt provea instancias de memoria de ellas.</p>
<p>Por ejemplo, un colaborador t&#xED;pico o agregaci&#xF3;n que genera una dependencia en el viewmodel es el repositorio o repositorios de datos a los que accedemos.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token annotation builtin">@HiltViewModel</span>
<span class="token keyword keyword-class">class</span> MiViewModel <span class="token annotation builtin">@Inject</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// Dependencia que queremos inyectar</span>
  <span class="token comment">// En este caso creamos una instancia de MiRepositorio cada vez que se crea un MiViewModel</span>
  <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-val">val</span> miRepositorio <span class="token operator">=</span> <span class="token function">MiRepositorio</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</pre><p>Realizaremos una inversi&#xF3;n de dependencias <strong>exponiendo</strong> en el constructor la instancia del objeto agregado o colaborados que queremos que nos inyecte Hilt.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token annotation builtin">@HiltViewModel</span>
<span class="token keyword keyword-class">class</span> MiViewModel <span class="token annotation builtin">@Inject</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span>
  <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-val">val</span> miRepositorio <span class="token operator">:</span> MiRepository
<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</pre><p>Ahora deberemos <strong>preparar el m&#xF3;dulo</strong> o la clase <strong><code>MiRepositorio</code></strong> para poder ser inyectado. Para ello, definiremos una clase que definir&#xE1; los m&#xE9;todos proveedores de las instancias de las clases que queremos inyectar.</p>
<p>Esta clase deber&#xE1; tener la anotaci&#xF3;n <strong><code>@Module</code></strong> y la anotaci&#xF3;n <strong><code>@InstallIn</code></strong> que indicar&#xE1; el alcance o Scope de la clase que se provee. En este caso, la clase se proveer&#xE1; en el <strong><code>SingletonComponent</code></strong> que es el alcance por defecto.</p>
<p>La clase que define los proveedores la podemos llamar <strong><code>AppModule</code></strong> y la a&#xF1;adiremos el paquete <strong><code>di</code></strong> al paquete ra&#xED;z de nuestro proyecto ya que centralizar&#xE1; todos proveedores de dependencias de la aplicaci&#xF3;n.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-package">package</span> com<span class="token punctuation">.</span>pmdm<span class="token punctuation">.</span>miapplication<span class="token punctuation">.</span>di

<span class="token annotation builtin">@Module</span>
<span class="token annotation builtin">@InstallIn</span><span class="token punctuation">(</span>SingletonComponent<span class="token operator">::</span><span class="token keyword keyword-class">class</span><span class="token punctuation">)</span>
<span class="token keyword keyword-class">class</span> AppModule <span class="token punctuation">{</span>

  <span class="token comment">// Crearemos un m&#xE9;todo que suele empezar con el prefijo &apos;provide&apos;</span>
  <span class="token comment">// y que devolver&#xE1; una instancia de MiRepositorio  </span>
  <span class="token annotation builtin">@Provides</span>
  <span class="token annotation builtin">@Singleton</span>
  <span class="token keyword keyword-fun">fun</span> <span class="token function">provideMiRepositorio</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> MiRepository <span class="token operator">=</span> <span class="token function">MiRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// Crearemos un m&#xF3;dulo para cada clase que queramos inyectar</span>
<span class="token punctuation">}</span>
</pre><p>Anotaciones:</p>
<ul>
<li><strong><code>@Provides</code></strong>: Indica que el m&#xE9;todo provee una instancia de la clase que se indica en el tipo de retorno del m&#xE9;todo.</li>
<li><strong><code>@Singleton</code></strong>: Indica que la instancia de la clase que se provee es &#xFA;nica y que se reutilizar&#xE1; en todas las clases que la necesiten.</li>
<li><strong><code>@InstallIn</code></strong>: Indica el alcance o Scope de la clase que se provee. En este caso, la clase se proveer&#xE1; en el <strong><code>SingletonComponent</code></strong> que es el alcance m&#xE1;s alto que existe.</li>
</ul>
<p>Puede darse el caso de que se produzca una &apos;<em>cadena</em>&apos; de dependencias a inyectar. Por ejemplo, puede ser que nuestro repositorio necesite de una DAO (Data Access Object) para acceder a la fuente de datos. Expondremos la inyecci&#xF3;n de la dependencia en el constructor a Hilt.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-class">class</span> MiRepository <span class="token annotation builtin">@Inject</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span>
    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-val">val</span> dao<span class="token operator">:</span> ModeloDaoMock
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</pre><p>definiremos el m&#xE9;todo proveedor de las instancias de <strong><code>ModeloDaoMock</code></strong></p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token annotation builtin">@Module</span>
<span class="token annotation builtin">@InstallIn</span><span class="token punctuation">(</span>SingletonComponent<span class="token operator">::</span><span class="token keyword keyword-class">class</span><span class="token punctuation">)</span>
<span class="token keyword keyword-class">class</span> AppModule <span class="token punctuation">{</span>

  <span class="token annotation builtin">@Provides</span>
  <span class="token annotation builtin">@Singleton</span>
  <span class="token keyword keyword-fun">fun</span> <span class="token function">provideModeloDaoMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> ModeloDaoMock <span class="token operator">=</span> <span class="token function">ModeloDaoMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// El modeloDaoMock es inyectado por provideModeloDaoMock() en el proveedor</span>
  <span class="token comment">// y por tanto resuelto autom&#xE1;ticamente por Hilt.</span>
  <span class="token annotation builtin">@Provides</span>
  <span class="token annotation builtin">@Singleton</span>
  <span class="token keyword keyword-fun">fun</span> <span class="token function">provideMiRepositorio</span><span class="token punctuation">(</span>
    modeloDaoMock <span class="token operator">:</span> ModeloDaoMock
  <span class="token punctuation">)</span> <span class="token operator">:</span> MiRepository <span class="token operator">=</span> <span class="token function">MiRepository</span><span class="token punctuation">(</span>modeloDaoMock<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre><p>Otras anotaciones que podemos usar en los m&#xE9;todos &apos;<em>proveedores</em>&apos; son:</p>
<ul>
<li><strong><code>@Binds</code></strong>: Indica que la clase que se provee es una interfaz y que se debe enlazar con una clase concreta que implemente dicha interfaz. Se usa en lugar de <strong><code>@Provides</code></strong>.</li>
<li><strong><code>@IntoMap</code></strong>: Indica que la clase que se provee es un mapa y que se debe a&#xF1;adir a un mapa concreto. Se usa en lugar de <strong><code>@Provides</code></strong>.</li>
<li><strong><code>@IntoSet</code></strong>: Indica que la clase que se provee es un conjunto y que se debe a&#xF1;adir a un conjunto concreto. Se usa en lugar de <strong><code>@Provides</code></strong>.</li>
</ul>
<p><a href="https://developer.android.com/codelabs/android-hilt?hl=es-419#6">https://developer.android.com/codelabs/android-hilt?hl=es-419#6</a></p>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>