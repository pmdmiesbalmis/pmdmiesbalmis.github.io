<!DOCTYPE html><html><head>
      <title>PMDM 2&#xBA; DAM  Tema 8. Interf&#xED;cie d&apos;Usuari III</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
.markdown-preview.markdown-preview .slides > section {
  height: 100%;
  font-size: 90%;
  overflow-y: auto !important;
}
.markdown-preview.markdown-preview .slide code {
  color: yellow;
}

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <style>/* 
Añade 

@import "../EstilosPersonalizadosMarkdownEnhanced.less"

justo después del front matter 
*/
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v17/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
</style>
<h1 class="mume-header undefined" id="apunts">Apunts</h1>

<p><a href="./tema8_Interfaz_Usuario_III_val.pdf">Descarregar aquests apunts</a></p>
<h1 class="mume-header undefined" id="tema-8-interf%C3%ADcie-dusuari-iii">Tema 8. Interf&#xED;cie d&apos;Usuari III</h1>

<h2 class="mume-header undefined" id="%C3%ADndex">&#xCD;ndex</h2>

<ol>
<li><a href="#spinner">Spinner</a></li>
<li><a href="#recyclerview">RecyclerView</a>
<ol>
<li><a href="#clic-sobre-un-element-de-la-llista">Clic sobre un element de la llista</a></li>
<li><a href="#clic-en-qualsevol-lloc-de-la-vista">Clic en qualsevol lloc de la vista</a></li>
<li><a href="#clic-en-qualsevol-lloc-de-la-vista-passant-informaci%C3%B3-a-lactivitat-principal">Clic en qualsevol lloc de la vista passant informaci&#xF3; a l&apos;Activitat Principal</a></li>
<li><a href="#altres-efectes-sobre-el-recycler">Altres efectes sobre el Recycler</a></li>
<li><a href="#selecci%C3%B3-multiple-en-el-recycler">Selecci&#xF3; Multiple en el Recycler</a></li>
</ol>
</li>
</ol>
<div style="page-break-after:always;"></div>
<h3 class="mume-header" id="spinner">Spinner</h3>

<p>Les llistes desplegables en Android es diuen <a href="https://developer.android.com/guide/topics/ui/controls/spinner">Spinners</a> Spinner. &#xC9;s una llista que mostra els elements una vegada polsada la fletxa de desplegament, l&apos;usuari pot seleccionar de la llista emergent un element. El codi de la vista d&apos;un Spinner ser&#xE0; el seg&#xFC;ent:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Spinner</span> <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/spinner<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</pre><p>Els elements que mostrar&#xE0; el nostre Spinner no es poden indicar directament, sin&#xF3; que &#xE9;s necessari crear una estructura d&apos;elements que puguem associar a aquest en el nostre codi. Una de les maneres seria usant un Array de Strings per a despr&#xE9;s assignar-ho al spinner:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-var">var</span> colores <span class="token operator">=</span> <span class="token function">arrayOf</span><span class="token punctuation">(</span><span class="token string">&quot;Rojo&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Verde&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Azul&quot;</span><span class="token punctuation">)</span>
</pre><p>A continuaci&#xF3; hem de definir l&apos;adaptador, en el nostre cas un objecte ArrayAdapter, que ser&#xE0; l&apos;objecte que lla llan&#xE7;arem amb el nostre Spinner.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">  <span class="token keyword keyword-val">val</span> adaptador <span class="token operator">=</span> <span class="token function">ArrayAdapter</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> 
  android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>simple_list_item_1<span class="token punctuation">,</span> colores<span class="token punctuation">)</span>
</pre><p>Creem l&apos;adaptador en si, al qual passem 3 par&#xE0;metres:</p>
<ol>
<li>El context, que normalment ser&#xE0; simplement una refer&#xE8;ncia a l&apos;activitat on es crea l&apos;adaptador.</li>
<li>L&apos;ID del layout sobre el qual es mostraran les dades del control. En aquest cas li passem l&apos;ID d&apos;un layout predefinit en Android (android.R.layout.simple_spinner_item), format &#xFA;nicament per un control textView, per&#xF2; podr&#xED;em passar l&apos;ID de qualsevol layout del nostre projecte amb qualsevol estructura i conjunt de controls.</li>
<li>L&apos;element que cont&#xE9; les dades a mostrar.</li>
</ol>
<p>Amb aquestes simples l&#xED;nies tindrem un control similar al de la seg&#xFC;ent imatge:</p>
   <span style="align: center;">
   <table align="center">
   <tbody><tr style="border:hidden;">
   <td style="border:hidden;">
   <div align="center">
       <img height="60" src="./imagenes/spinner1.png">
   </div>
   </td>
   <td>
   <div align="center">
       <img height="100" src="./imagenes/spinner2.png">
   </div>
   </td>
   </tr>
   </tbody></table>
   </span>
<blockquote>
<p>&#x1F393; Anem a crea un projecte d&apos;exemple anomenat Spinner al qual afegirem el seg&#xFC;ent codi en la <strong>MainActivity.kt</strong>, i no oblides afegir un spinner amb id=spinner* en el layout <strong>activity_main.xml</strong>:</p>
</blockquote>
<p>Amb aquestes simples l&#xED;nies tindrem un control similar al de la seg&#xFC;ent imatge:</p>
<blockquote>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                    AdapterView<span class="token punctuation">.</span><span class="token function">OnItemSelectedListener</span> <span class="token punctuation">{</span>
   <span class="token keyword keyword-var">var</span> colores <span class="token operator">=</span> <span class="token function">arrayOf</span><span class="token punctuation">(</span><span class="token string">&quot;Rojo&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Verde&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Azul&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword keyword-lateinit">lateinit</span>  <span class="token keyword keyword-var">var</span> listaColores<span class="token operator">:</span> Spinner
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
       <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>
       <span class="token keyword keyword-val">val</span> adaptador <span class="token operator">=</span> <span class="token function">ArrayAdapter</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>
                                   simple_list_item_1<span class="token punctuation">,</span> colores<span class="token punctuation">)</span>
       listaColores <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>spinner<span class="token punctuation">)</span>
       listaColores<span class="token punctuation">.</span>adapter<span class="token operator">=</span>adaptador
       listaColores<span class="token punctuation">.</span><span class="token function">setOnItemSelectedListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x1F4CC; <strong>L&#xED;nia 8</strong> creem l&apos;adaptador, com hem explicat anteriorment, per a assignar-lo al Spinner en la <strong>L&#xED;nia 11</strong>.</p>
<p>Quant als esdeveniments llan&#xE7;ats pel control Spinner, el m&#xE9;s utilitzat ser&#xE0; el generat en seleccionar-se una opci&#xF3; de la llista desplegable, onItemSelected. Per a capturar aquest esdeveniment es procedir&#xE0; de manera similar al ja vist per a altres controls anteriorment, assignant-li el seu controlador mitjan&#xE7;ant el m&#xE8;tode <strong><code>setOnItemSelectedListener()</code></strong>, en aquest cas el fem mitjan&#xE7;ant el m&#xE8;tode de derivar de la interf&#xED;cie, <strong>L&#xED;nia 12</strong>.<br>
En el codi inferior veiem implementat el m&#xE8;tode, que mostra un Toast amb el color triat.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onItemSelected</span><span class="token punctuation">(</span>adapterView<span class="token operator">:</span> AdapterView<span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span><span class="token operator">?</span><span class="token punctuation">,</span> 
                               view<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">,</span> l<span class="token operator">:</span> Long<span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword keyword-val">val</span> x <span class="token operator">=</span> Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">&quot;El color elegido es: &quot;</span> <span class="token operator">+</span>
                              colores<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_LONG<span class="token punctuation">)</span>
       x<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre></blockquote>
<h5 class="mume-header" id="nota-ampliativa">Nota ampliativa</h5>

<p>Una alternativa a tindre en compte, si les dades a mostrar en el control s&#xF3;n est&#xE0;tics, seria definir la llista de possibles valors com un recurs de tipus string-array. Per a aix&#xF2;, primer crear&#xED;em un nou fitxer XML en la carpeta <em>res/values</em> anomenat per exemple spinner.xml i inclour&#xED;em en ell els valors seleccionables de la seg&#xFC;ent forma:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string-array</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>colores<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>ROJO<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>VERDE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>AZUL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string-array</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">&gt;</span></span>
</pre><p>En aquest cas, a l&apos;hora de crear l&apos;adaptador utilitzar&#xED;em el m&#xE8;tode <strong><code>createFromResource()</code></strong> per a fer refer&#xE8;ncia al array XML que acabem de crear:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-val">val</span> adaptador<span class="token operator">=</span>ArrayAdapter<span class="token punctuation">.</span><span class="token function">createFromResource</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span>R<span class="token punctuation">.</span>array<span class="token punctuation">.</span>colores<span class="token punctuation">,</span>
                                    android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>simple_list_item_1<span class="token punctuation">)</span>
</pre><p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F;Ejercicio PropuestoSpinner</span></p>
<h3 class="mume-header" id="recyclerview">RecyclerView</h3>

<p>Els <a href="https://developer.android.com/guide/topics/ui/layout/recyclerview?hl=es-419">RecyclerView</a> s&#xF3;n els elements que proporciona Android per a mostrar quantitats de dades, normalment en forma de llistes. Aquesta llibreria permet adaptar, de manera senzilla, l&apos;eixida al gust del dissenyat, a m&#xE9;s de millorar el rendiment i la resposta de l&apos;aplicaci&#xF3; respecte a les anteriors solucions. Aix&#xF2; &#xE9;s pel fet que, amb aquest disseny, quan un element es despla&#xE7;a fora de la pantalla no es destrueix la seua vista, sin&#xF3; que es reutilitza per als elements nous que ara es mostren en ella.<br>
<strong><code>RecyclerView</code></strong> se sustentar&#xE0; sobre altres components complementaris per a determinar com accedir a les dades i com mostrar-los. Els m&#xE9;s importants seran els seg&#xFC;ents:</p>
<ul>
<li>RecyclerView.Adapter</li>
<li>RecyclerView.ViewHolder</li>
<li>LayoutManager</li>
<li>ItemDecoration</li>
<li>ItemAnimator</li>
</ul>
<p>D&apos;igual forma que hem fet amb el <strong><code>Spinner</code></strong>, un <strong><code>RecyclerView</code></strong> es recolzar&#xE0; tamb&#xE9; en un adaptador per a treballar amb les nostres dades, en aquest cas un adaptador que herete de la classe <strong><code>RecyclerView.Adapter</code></strong>. La peculiaritat &#xE9;s que aquest tipus d&apos;adaptador <strong>obliga</strong>* a utilitzar un <strong><code>RecyclerView.ViewHolder</code></strong> (element que permet optimitzar l&apos;acc&#xE9;s a les dades de l&apos;adaptador).<br>
Una vista de tipus RecyclerView no determina, per si sola, la forma en qu&#xE8; es mostraran en pantalla els elements de la nostra col&#xB7;lecci&#xF3;, sin&#xF3; que delegar&#xE0; aqueixa tasca a un altre component anomenat <strong><code>LayoutManager</code></strong>, que tamb&#xE9; haurem de crear i associar al RecyclerView per al seu correcte funcionament. Per sort, el SDK incorpora de s&#xE8;rie tres LayoutManager per a les tres representacions m&#xE9;s habituals:</p>
<ul>
<li><strong><code>LinearLayoutManager</code></strong> per a la visualitzaci&#xF3; com a llista vertical o horitzontal,</li>
<li><strong><code>GridLayoutManager</code></strong> per a la visualitzaci&#xF3; com a taula tradicional ()</li>
<li><strong><code>StaggeredGridLayoutManager</code></strong> que visualitza els elements com una taula apilada o de cel&#xB7;les no alineades.</li>
</ul>
<p>Per tant, sempre que optem per alguna d&apos;aquestes distribucions d&apos;elements no haurem de crear el nostre propi LayoutManager personalitzat, encara que per descomptat res ens impedeix fer-ho.<br>
Els dos &#xFA;ltims components de la llista <strong><code>ItemDecoration</code></strong> i <strong><code>ItemAnimator</code></strong>, s&apos;encarregaran de definir com es representaran alguns aspectes visuals de la nostra col&#xB7;lecci&#xF3; de dades (m&#xE9;s enll&#xE0; de la distribuci&#xF3; definida pel LayoutManager), per exemple: <em>marcadors o separadors d&apos;elements</em>, i de com s&apos;animaran els elements en realitzar-se determinades accions sobre la col&#xB7;lecci&#xF3;, per exemple: <em>en afegir o eliminar elements</em>.<br>
De totes maneres, no sempre ser&#xE0; obligatori implementar tots aquests components per a fer &#xFA;s d&apos;un RecyclerView. <strong>El m&#xE9;s habitual ser&#xE0; implementar el Adapter i el ViewHolder, utilitzar algun dels LayoutManager predefinits</strong>, i nom&#xE9;s en cas de necessitat crear els Item Decoration i Item Animator necessaris per a donar un toc de personalitzaci&#xF3; especial a la nostra aplicaci&#xF3;.</p>
<blockquote>
<p>&#x1F393; Crearem un exemple que mostre un recycler amb la llista d&apos;una ser&#xED;e d&apos;usuaris. Per a aix&#xF2; haurem de crear un nou projecte <strong>EjemploRecycler</strong>. El primer que haurem de fer &#xE9;s crear una classe <em>pojo</em> que ens servisca per a les dades dels usuaris. Per exemple <strong>Usuari.kt</strong> de la seg&#xFC;ent manera:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-class">class</span> <span class="token function">Usuario</span><span class="token punctuation">(</span>nombre<span class="token operator">:</span>String<span class="token punctuation">,</span> apellidos<span class="token operator">:</span>String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword keyword-var">var</span> nombre<span class="token operator">:</span> String
   <span class="token keyword keyword-var">var</span> apellidos<span class="token operator">:</span> String
   <span class="token keyword keyword-init">init</span> <span class="token punctuation">{</span>
       <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>nombre <span class="token operator">=</span> nombre
       <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>apellidos <span class="token operator">=</span> apellidos
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>El seg&#xFC;ent pas seria afegir el recycler al lloc on volem que siga mostrat, per exemple a l&apos;activitat principal. En aquest cas podria quedar la <strong>main_activity.xml</strong> de la seg&#xFC;ent manera:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>androidx.constraintlayout.widget.ConstraintLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">xmlns:</span>tools</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/tools<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">tools:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.MainActivity<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>androidx.recyclerview.widget.RecyclerView</span>
   <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/recyclerList<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#F87A7D87<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>androidx.constraintlayout.widget.ConstraintLayout</span><span class="token punctuation">&gt;</span></span>

</pre><p>Tamb&#xE9; hem de pensar com &#xE9;s el disseny que desitgem per a cadascun dels elements del recycler, aix&#xF2; es fa en un recurs layout i de la forma que ja sabem. Per exemple podria ser l&apos;arxiu <strong>recyclerlayout.xml</strong>:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>com.google.android.material.card.MaterialCardView</span> 
   <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">xmlns:</span>card_view</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">card_view:</span>cardCornerRadius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4dp<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">card_view:</span>cardUseCompatPadding</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">card_view:</span>cardElevation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2dp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>
       <span class="token attr-name"><span class="token namespace">android:</span>padding</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8dp<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#493DEC<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>horizontal<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</pre><pre data-role="codeBlock" data-info="xml" class="language-xml">       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>
           <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0dp<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name"><span class="token namespace">android:</span>layout_weight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.75<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vertical<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>
               <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/textView<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Large Text<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>textColor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@android:color/white<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>textSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20sp<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>
               <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/textView2<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Medium Text<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>textColor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@android:color/white<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>textSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>15sp<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>com.google.android.material.card.MaterialCardView</span> <span class="token punctuation">&gt;</span></span>
</pre><p>&#x270B; Per a aconseguir una separaci&#xF3; entre els elements de la llista, es pot usar el contenidor <strong><code>CardView</code></strong> que ja coneixem de temes anteriors. RecyclerView no t&#xE9; la separaci&#xF3; per elements creada per defecte, s&apos;hauria de simular de diferents maneres, una &#xE9;s usant targetes com en aquest cas.</p>
<p>El seg&#xFC;ent pas seria escriure el nostre adaptador. Aquest adaptador haur&#xE0; d&apos;estendre de la classe <strong><code>RecyclerView.Adapter</code></strong>, de la qual haurem de sobreescriure principalment tres m&#xE8;todes:</p>
<ul>
<li><em><code>onCreateViewHolder()</code></em>. Encarregat de crear els nous objectes ViewHolder necessaris per als elements de la col&#xB7;lecci&#xF3;.</li>
<li><em><code>onBindViewHolder()</code></em>. Encarregat d&apos;actualitzar les dades d&apos;un ViewHolder ja existent.</li>
<li><em><code>onItemCount()</code></em>. Indica el nombre d&apos;elements de la col&#xB7;lecci&#xF3; de dades.</li>
</ul>
<p>El m&#xE8;tode <strong><code>onCreateViewHolder</code></strong> retorna un objecte de tipus <strong>Holder</strong>, per la qual cosa primer haurem de crear una classe que herete de <strong><code>RecyclerView.ViewHolder</code></strong>, que podria ser com la seg&#xFC;ent, <strong>Holder.kt</strong>:</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword keyword-val">val</span> textNombre<span class="token operator">:</span> TextView
   <span class="token keyword keyword-val">val</span> textApellido<span class="token operator">:</span> TextView

   <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
       textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword keyword-init">init</span> <span class="token punctuation">{</span>
       textNombre <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span>
       textApellido <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView2<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x270B; El patr&#xF3; <strong>ViewHolder</strong> t&#xE9; un &#xFA;nic prop&#xF2;sit en la seua implementaci&#xF3;, millorar el rendiment. I &#xE9;s que quan parlem d&apos;aplicacions m&#xF2;bils, el rendiment &#xE9;s un tema de gran import&#xE0;ncia. El ViewHolder mant&#xE9; una refer&#xE8;ncia als elements del RecyclerView mentre l&apos;usuari realitza scrolling en l&apos;aplicaci&#xF3;. Aix&#xED; s&apos;eviten les freq&#xFC;ents anomenades a findViewById, realitzant-la la primera vegada i la resta usant la refer&#xE8;ncia en el ViewHolder.</p>
<p>&#x1F4CC; <strong>L&#xED;nia 0</strong> es definir&#xE0; com una altra classe estesa de la classe <strong><code>RecyclerView.ViewHolder</code></strong>, i ser&#xE0; bastant senzilla, tan sols haurem d&apos;incloure com a atributs les refer&#xE8;ncies als controls del layout d&apos;un element de la llista (en el nostre cas els dos TextView) i unflar-les en el constructor sobre la vista rebuda com a par&#xE0;metre <strong>L&#xED;nies 10 i 11</strong>. Afegirem tamb&#xE9; un m&#xE8;tode, normalment anomenat <strong>bind()</strong>, que s&apos;encarregue d&apos;assignar els continguts als dos textos a partir de l&apos;objecte Usuari, <strong>L&#xED;nies 6 i 7</strong>.</p>
<p>Ara ja podem crear l&apos;adaptador, que en el nostre projecte podria ser <strong>Adaptador.kt</strong> que herete de <strong><code>RecyclerView.Adapter</code></strong> i que ens obligar&#xE0; a sobreescriure els m&#xE8;todes que siguen necessaris, quedant el codi com veiem en la imatge:</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> Adaptador <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> datos<span class="token operator">:</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">:</span>
                                      RecyclerView<span class="token punctuation">.</span>Adapter<span class="token operator">&lt;</span>Holder<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreateViewHolder</span><span class="token punctuation">(</span>viewGroup<span class="token operator">:</span> ViewGroup<span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span>Holder
   <span class="token punctuation">{</span>
       <span class="token keyword keyword-val">val</span> itemView<span class="token operator">:</span> View <span class="token operator">=</span> LayoutInflater<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>viewGroup<span class="token punctuation">.</span>context<span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>recyclerlayout<span class="token punctuation">,</span> viewGroup<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
       <span class="token keyword keyword-return">return</span> <span class="token function">Holder</span><span class="token punctuation">(</span>itemView<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span>holder<span class="token operator">:</span> Holder<span class="token punctuation">,</span> position<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword keyword-val">val</span> item<span class="token operator">:</span> Usuario <span class="token operator">=</span> datos<span class="token punctuation">[</span>position<span class="token punctuation">]</span>
       holder<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getItemCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Int <span class="token punctuation">{</span>
       <span class="token keyword keyword-return">return</span> datos<span class="token punctuation">.</span>size
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x1F4CC;Com es pot veure en la imatge, en el m&#xE8;tode <strong><code>onCreateViewHolder</code></strong> ens limitarem a unflar una vista a partir del layout corresponent als elements de la llista (recyclerlayout.xml), i crear i retornar un nou ViewHolder cridant al constructor de la nostra classe Holder passant-li aquesta vista com a par&#xE0;metre. <strong>L&#xED;nia 6 i 8</strong>.<br>
Els dos m&#xE8;todes restants s&#xF3;n encara m&#xE9;s senzills. En <strong><code>onBindViewHolder()</code></strong> tan sols haurem de recuperar l&apos;objecte corresponent a la posici&#xF3; rebuda com a par&#xE0;metre i cridar al m&#xE8;tode bind del nostre Holder, per&#xF2; sempre des de l&apos;objecte ViewHolder rebut com a par&#xE0;metre. Per part seua, <strong><code>getItemCount()</code></strong> retornar&#xE0; la grand&#xE0;ria de la llista de dades.</p>
<p>Amb aix&#xF2; tindr&#xED;em finalitzat l&apos;adaptador, per la qual cosa ja podr&#xED;em assignar-ho al RecyclerView en la nostra activitat principal. Ho farem amb el seg&#xFC;ent codi</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
       <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
       <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>
       <span class="token keyword keyword-val">val</span> datos <span class="token operator">=</span> <span class="token function">anadirDatos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       <span class="token keyword keyword-val">val</span> recyclerView <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>RecyclerView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>recyclerList<span class="token punctuation">)</span>
       <span class="token keyword keyword-val">val</span> adaptador <span class="token operator">=</span> <span class="token function">Adaptador</span><span class="token punctuation">(</span>datos<span class="token punctuation">)</span>
       recyclerView<span class="token punctuation">.</span>adapter <span class="token operator">=</span> adaptador
       recyclerView<span class="token punctuation">.</span>layoutManager <span class="token operator">=</span>
           <span class="token function">LinearLayoutManager</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> LinearLayoutManager<span class="token punctuation">.</span>VERTICAL<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">anadirDatos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span> 
   <span class="token punctuation">{</span>
       <span class="token keyword keyword-var">var</span> datos <span class="token operator">=</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i <span class="token keyword keyword-in">in</span> <span class="token number">0</span><span class="token operator">..</span><span class="token number">19</span><span class="token punctuation">)</span>
           datos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Usuario</span><span class="token punctuation">(</span><span class="token string">&quot;nombre<span class="token interpolation variable">$i</span>&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;apellido1<span class="token interpolation variable">$i</span>   Apellido2<span class="token interpolation variable">$i</span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       <span class="token keyword keyword-return">return</span> datos
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x1F4CC; Instanciarem un objecte de la classe <strong>Adaptador</strong> creada per nosaltres <strong>L&#xED;nia 8</strong>. Li ho afegirem al recyclerView unflat en l&apos;activitat principal <strong>L&#xED;nia 9</strong> i li associarem un LayoutManager determinat, per a obtindre la forma en la qual es distribuiran les dades en pantalla.<br>
Com ja vam dir, si la nostra intenci&#xF3; &#xE9;s mostrar les dades en forma de llista o taula (a l&apos;estil dels antics ListView o GridView) no haurem d&apos;implementar el nostre propi LayoutManager. En el nostre cas particular volem mostrar les dades en forma de llista amb despla&#xE7;ament vertical <strong>L&#xED;nia 10</strong>. Per a aix&#xF2; tenim disponible la classe LinearLayoutManager, per la qual cosa tan sols tindrem que instanciar un objecte d&apos;aquesta classe indicant en el constructor l&apos;orientaci&#xF3; del despla&#xE7;ament (<strong><code>LinearLayoutManager.VERTICAL o LinearLayoutManager.HORITZONTAL</code></strong>) i ho assignarem al RecyclerView mitjan&#xE7;ant el m&#xE8;tode <strong><code>setLayoutManager()</code></strong>.</p>
<p>Al final aconseguirem un efecte semblant al seg&#xFC;ent, que mostra la llista de dades i sobre el que es pot fer scrolling:</p>
<div align="center">
  <img height="150" src="./imagenes/recycler1.png">
</div></blockquote>

<h5 class="mume-header" id="gridlayoutmanager-y-staggeredgridlayoutmanager">GridLayoutManager y StaggeredGridLayoutManager</h5>

<p>Una altra part positiva de la classe RecyclerView, &#xE9;s que si canvi&#xE0;rem d&apos;idea i volgu&#xE9;rem mostrar les dades de forma tabular tan sols haur&#xED;em de canviar l&apos;assignaci&#xF3; del LayoutManager anterior i utilitzar un <strong><code>GridLayoutManager</code></strong>, al qual passarem com a par&#xE0;metre el nombre de columnes a mostrar. Si el que volem &#xE9;s mostrar-la de manera tabular per&#xF2; sense igualar les cel&#xB7;les usarem el <strong><code>StaggeredGridLayoutManager</code></strong>, el tercer argument disposa si ha de dimensionar les cel&#xB7;les al seu contingut o no.</p>
<div align="center">
    <img height="350" src="./imagenes/recycler2.png">
</div>
<h5 class="mume-header" id="itemdecoration-e-itemanimation">ItemDecoration e ItemAnimation</h5>

<p>Els <a href="https://developer.android.com/reference/androidx/recyclerview/widget/recyclerview.itemdecoration">ItemDecoration</a> ens serviran per a personalitzar l&apos;aspecte d&apos;un RecyclerView m&#xE9;s enll&#xE0; de la distribuci&#xF3; dels elements en pantalla. L&apos;exemple t&#xED;pic d&apos;aix&#xF2; s&#xF3;n els separadors o divisors d&apos;una llista. RecyclerView no t&#xE9; cap propietat divider com en el cas del ListView, per la qual cosa aquesta funcionalitat hem de suplir-la amb un <strong><code>ItemDecoration</code></strong>.<br>
Finalment parlem molt breument de <a href="https://developer.android.com/reference/androidx/recyclerview/widget/recyclerview.itemanimator">ItemAnimator</a>, permetr&#xE0; definir les animacions que mostrar&#xE0; el nostre RecyclerView en realitzar les accions m&#xE9;s comunes sobre un element (afegir, eliminar, moure, modificar). Aquest component tampoc &#xE9;s senzill d&apos;implementar, per&#xF2; per sort el SDK tamb&#xE9; proporciona una implementaci&#xF3; per defecte que pot servir-nos en la majoria d&apos;ocasions, encara que per descomptat podrem personalitzar creant el nostre propi ItemAnimator. Aquesta implementaci&#xF3; per defecte es diu DefaultItemAnimator.</p>
<div style="page-break-after:always;"></div>
<h4 class="mume-header" id="clic-sobre-un-element-de-la-llista">Clic sobre un element de la llista</h4>

<p>El seg&#xFC;ent pas que ens podem plantejar &#xE9;s com respondre als esdeveniments que es produ&#xEF;squen sobre el RecyclerView, com a opci&#xF3; m&#xE9;s habitual l&apos;esdeveniment clic sobre un element de la llista. Per a sorpresa de tots, la classe RecyclerView no t&#xE9; inclou un esdeveniment onItemClick() com ocorre amb <strong><code>ListFragment</code></strong>. Una vegada m&#xE9;s, RecyclerView delegar&#xE0; tamb&#xE9; aquesta tasca a un altre component, en aquest cas a la pr&#xF2;pia vista que conforma cada element de la col&#xB7;lecci&#xF3;, &#xE9;s a dir a l&apos;adaptador.</p>
<p>Aprofitarem la creaci&#xF3; de cada nou ViewHolder per a assignar a la seua vista associada l&apos;esdeveniment onClick. Addicionalment, per a poder fer aix&#xF2; des de fora de l&apos;adaptador, inclourem el listener corresponent com a atribut de l&apos;adaptador, i dins d&apos;aquest ens limitarem a assignar l&apos;esdeveniment a la vista del nou ViewHolder i a llan&#xE7;ar-ho quan siga necessari des del m&#xE8;tode onClick(). &#xC9;s m&#xE9;s f&#xE0;cil veure-ho sobre el codi:</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> Adaptador <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> datos<span class="token operator">:</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">:</span>
    RecyclerView<span class="token punctuation">.</span>Adapter<span class="token operator">&lt;</span>Holder<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>View<span class="token punctuation">.</span><span class="token function">OnClickListener</span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> listenerClick<span class="token operator">:</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">;</span>
  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreateViewHolder</span><span class="token punctuation">(</span>viewGroup<span class="token operator">:</span> ViewGroup<span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span>Holder<span class="token punctuation">{</span>
        <span class="token keyword keyword-val">val</span> itemView<span class="token operator">:</span> View <span class="token operator">=</span> LayoutInflater<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>viewGroup<span class="token punctuation">.</span>context<span class="token punctuation">)</span>
                   <span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>recyclerlayout<span class="token punctuation">,</span> viewGroup<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        itemView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> <span class="token function">Holder</span><span class="token punctuation">(</span>itemView<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span>holder<span class="token operator">:</span> Holder<span class="token punctuation">,</span> position<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword keyword-val">val</span> item<span class="token operator">:</span> Usuario <span class="token operator">=</span> datos<span class="token punctuation">[</span>position<span class="token punctuation">]</span>
      holder<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getItemCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Int <span class="token punctuation">{</span>
      <span class="token keyword keyword-return">return</span> datos<span class="token punctuation">.</span>size
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-fun">fun</span> <span class="token function">onClick</span><span class="token punctuation">(</span>listener<span class="token operator">:</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>listenerClick<span class="token operator">=</span>listener
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onClick</span><span class="token punctuation">(</span>p0<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      listenerClick<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span>p0<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; Per a implementar l&apos;esdeveniment OnClick sobre un element de la llista, primer fem que l&apos;adaptador creat per nosaltres herete de la interface <strong><code>OnClickListener</code></strong> <strong>L&#xED;nia 2</strong>. Per a aconseguir que es detecte la pulsaci&#xF3; sobre la vista de l&apos;element, posem el listener sobre la vista <strong>L&#xED;nia 8</strong>. En heretar de la interface, haurem d&apos;anul&#xB7;lar el onClick <strong>L&#xED;nia 21</strong>, en aquest m&#xE8;tode llan&#xE7;arem l&apos;esdeveniment onClick d&apos;una propietat d&apos;aquest tipus que ens haurem declarat abans <strong>L&#xED;nia 4</strong>. Perqu&#xE8; aquesta propietat no siga nul&#xB7;la, haurem de crear un m&#xE8;tode al qual li arribe una variable d&apos;aquest tipus i li siga assignada <strong>L&#xED;nia 18</strong>. Aquest &#xFA;ltim m&#xE8;tode ser&#xE0; al qual haurem de cridar des d&apos;on vulguem detectar l&apos;esdeveniment. Aix&#xF2; el podem veure en el codi de la <strong>MainActivity</strong>.</p>
</blockquote>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">adaptador<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span><span class="token function">OnClickListener</span> <span class="token punctuation">{</span> v <span class="token operator">-&gt;</span>
                 Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                <span class="token keyword keyword-this">this</span><span class="token label symbol">@MainActivity</span><span class="token punctuation">,</span>
                <span class="token string">&quot;Has pulsado&quot;</span> <span class="token operator">+</span> recyclerView<span class="token punctuation">.</span><span class="token function">getChildAdapterPosition</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Toast<span class="token punctuation">.</span>LENGTH_SHORT
            <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre><blockquote>
<p>&#x1F4CC; Amb l&apos;objecte adaptador assignat al recycler podem cridar a la funci&#xF3; onClick i passar un an&#xF2;nim de tipus OnClickListener, que ser&#xE0; invocat en pr&#xE9;mer sobre un element de la llista. Amb la vista que entra podem saber que posici&#xF3; a sigut premuda a trav&#xE9;s del m&#xE8;tode <strong><code>getChildAdapterPosition()</code></strong> de la classe RecyclerView.</p>
</blockquote>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F; Reconstrueix l&apos;exemple i afig la funcionalitat del Clic llarg per a eliminar l&apos;element premut de la llista. Per a actualitzar l&apos;adaptador. una vegada eliminat pots usar, adaptador.notifyItemRemoved(posicioneliminada) junt a adaptador.notifyDataSetChanged()</span></p>
<h4 class="mume-header" id="clic-en-qualsevol-lloc-de-la-vista">Clic en qualsevol lloc de la vista</h4>

<p>Si volgu&#xE9;rem detectar la pulsaci&#xF3; de qualsevol element de la l&#xED;nia del recycler, haurem d&apos;actuar sobre aqueixa vista en el Holder (&#xE9;s on podem fer refer&#xE8;ncia a cadascun dels view del layout). La manera de fer-ho &#xE9;s igual com s&apos;ha fet anteriorment, usant un listener de la interf&#xED;cie que ens fa&#xE7;a falta i manant la informaci&#xF3; a trav&#xE9;s d&apos;aquesta.</p>
<p>Per a veure el funcionament, primer inclourem una imatge en el layout <strong>recyclerlayout.xml</strong>, perqu&#xE8; en pr&#xE9;mer sobre aqueixa imatge s&apos;&#xF2;briga el dial del tel&#xE8;fon. Podr&#xED;em afegir la imatge de la seg&#xFC;ent manera:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>androidx.cardview.widget.CardView</span><span class="token punctuation">&gt;</span></span>
  ...
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/imagen<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@android:drawable/ic_menu_call<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>androidx.cardview.widget.CardView</span><span class="token punctuation">&gt;</span></span>
</pre><p>La app ara quedaria amb un aspecte similar al seg&#xFC;ent:</p>
<div align="center">  <img height="150" src="./imagenes/recycler1_2.png">
</div>
<p>Ara afegirem en el codi de la classe Holder (ac&#xED; &#xE9;s on se sap que vista s&apos;ha premut d&apos;entres totes), l&apos;anomenada al intel que obri el dial:</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">,</span> context<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                          View<span class="token punctuation">.</span><span class="token function">OnClickListener</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-val">val</span> textNombre<span class="token operator">:</span> TextView
    <span class="token keyword keyword-val">val</span> textApellido<span class="token operator">:</span> TextView
    <span class="token keyword keyword-val">val</span> context<span class="token operator">:</span>Context
    <span class="token keyword keyword-val">val</span> imagen<span class="token operator">:</span>ImageView
    <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-init">init</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>context<span class="token operator">=</span>context
        textNombre <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span>
        textApellido <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView2<span class="token punctuation">)</span>
        imagen<span class="token operator">=</span>v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>imagen<span class="token punctuation">)</span>
        imagen<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onClick</span><span class="token punctuation">(</span>p0<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-val">val</span> i <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_DIAL<span class="token punctuation">)</span>
        <span class="token function">startActivity</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; En aquest cas, com no es vol passar informaci&#xF3; des del Holder fins a l&apos;Adaptador o l&apos;activitat principal, l&apos;&#xFA;nica cosa que hem d&apos;anul&#xB7;lar (haurem heretat de OnClickListener) &#xE9;s el m&#xE8;tode onClick <strong>F&#xED;la 2 i 18</strong>, on llan&#xE7;arem el intent. Per a llan&#xE7;ar el intent necessitarem el context, per la qual cosa li ho passarem mitjan&#xE7;ant el constructor del Holder <strong>L&#xED;nies 1 i 12</strong>. No oblides posar el listener sobre la vista que t&apos;interesse <strong>L&#xED;nia 16</strong>. Al constructor de l&apos;adaptador tamb&#xE9; li haur&#xE0; d&apos;arribar, de la mateixa manera, el context de l&apos;Activitat.</p>
</blockquote>
<h4 class="mume-header" id="clic-en-qualsevol-lloc-de-la-vista-passant-informaci%C3%B3-a-lactivitat-principal">Clic en qualsevol lloc de la vista passant informaci&#xF3; a l&apos;Activitat Principal</h4>

<p>En aquest cas a m&#xE9;s de detectar la pulsaci&#xF3; sobre un element, haurem de retornar la informaci&#xF3; que ens interesse cap endarrere. Es podria usar un ViewModel, com ja hem explicat i usat amb anterioritat, per&#xF2; utilitzarem una Interface per a recordar el sistema.</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">,</span> context<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                          View<span class="token punctuation">.</span><span class="token function">OnClickListener</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-val">val</span> textNombre<span class="token operator">:</span> TextView
    <span class="token keyword keyword-val">val</span> textApellido<span class="token operator">:</span> TextView
    <span class="token keyword keyword-val">val</span> context<span class="token operator">:</span> Context
    <span class="token keyword keyword-val">val</span> imagen<span class="token operator">:</span> ImageView
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> pasarCadenaInterface<span class="token operator">:</span> PasarCadenaInterface
    <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-init">init</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> context
        textNombre <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span>
        textApellido <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView2<span class="token punctuation">)</span>
        imagen <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>imagen<span class="token punctuation">)</span>
        imagen<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onClick</span><span class="token punctuation">(</span>p0<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-var">var</span> cadena<span class="token operator">:</span>String
        <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>p0<span class="token operator">?</span><span class="token punctuation">.</span>id<span class="token operator">==</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>imagen<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword keyword-val">val</span> i <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_DIAL<span class="token punctuation">)</span>
            <span class="token function">startActivity</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
            cadena<span class="token operator">=</span><span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>p0<span class="token operator">?</span><span class="token punctuation">.</span>id<span class="token operator">==</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span> cadena<span class="token operator">=</span>textNombre<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-else">else</span> cadena<span class="token operator">=</span>textApellido<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        pasarCadenaInterface<span class="token punctuation">.</span><span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>pasarCadenaInterface<span class="token operator">:</span> PasarCadenaInterface<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>pasarCadenaInterface<span class="token operator">=</span>pasarCadenaInterface
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; <strong>L&#xED;nia 7</strong> creem un objecte de la mena de Interface creada, en aquest cas seria aix&#xED;:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-interface">interface</span> PasarCadenaInterface<span class="token punctuation">{</span>
   <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token operator">:</span>String<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre><p><strong>L&#xED;nia 18 i 19</strong> posem listeners de l&apos;esdeveniment Clic sobre les vistes que necessitem. En anul&#xB7;lar el OnClick, cridem al m&#xE8;tode de la interface amb el text que desitgem <strong>L&#xED;nia 31</strong>. Perqu&#xE8; la interface no siga nul&#xB7;la, seguim l&apos;estrat&#xE8;gia que ja coneixem de l&apos;anterior punt, creguem un m&#xE8;tode al qual li arriba la interface <strong>L&#xED;nia 35</strong>.</p>
</blockquote>
<p>En el <strong>Adaptador</strong> haurem de fer els seg&#xFC;ents canvis:</p>
<pre data-role="codeBlock" data-info="kotlin {class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> Adaptador <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> datos<span class="token operator">:</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span> <span class="token punctuation">,</span> <span class="token keyword keyword-val">val</span> context<span class="token operator">:</span> Context <span class="token punctuation">)</span> <span class="token operator">:</span>
    RecyclerView<span class="token punctuation">.</span>Adapter<span class="token operator">&lt;</span>Holder<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">,</span> 
    View<span class="token punctuation">.</span><span class="token function">OnLongClickListener</span><span class="token punctuation">{</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> pasarCadenaInterface<span class="token operator">:</span> PasarCadenaInterface
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreateViewHolder</span><span class="token punctuation">(</span>viewGroup<span class="token operator">:</span> ViewGroup<span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span>Holder<span class="token punctuation">{</span>
        <span class="token operator">..</span><span class="token punctuation">.</span>
        <span class="token keyword keyword-val">val</span> holder<span class="token operator">=</span><span class="token function">Holder</span><span class="token punctuation">(</span>itemView<span class="token punctuation">,</span>context<span class="token punctuation">)</span>
        holder<span class="token punctuation">.</span><span class="token function">pasarCadena</span><span class="token punctuation">(</span><span class="token keyword keyword-object">object</span> <span class="token operator">:</span>PasarCadenaInterface<span class="token punctuation">{</span>
            <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                pasarCadenaInterface<span class="token punctuation">.</span><span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> holder
    <span class="token punctuation">}</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>pasarCadenaInterface<span class="token operator">:</span> PasarCadenaInterface<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>pasarCadenaInterface<span class="token operator">=</span>pasarCadenaInterface
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; Creem la propietat de tipus PasarCadenaInterface <strong>L&#xED;nea5</strong>. amb el <strong>holder</strong> cridem al m&#xE8;tode creat per a passar la inst&#xE0;ncia al holder. Quan aquesta s&apos;execute, ens arribar&#xE0; la cadena i cridarem al seu torn al m&#xE8;tode perqu&#xE8; d&apos;aqueixa forma arriben les dades a la MainActivity <strong>L&#xED;nea10</strong>. No oblidar el m&#xE8;tode al qual ens arriba la interface perqu&#xE8; no siga nul&#xB7;la <strong>L&#xED;na17</strong>. En la <strong>Main</strong> haurem de cridar a aquest &#xFA;ltim m&#xE8;tode de la mateixa forma que en l&apos;adaptador.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">adaptador<span class="token punctuation">.</span><span class="token function">pasarCadena</span><span class="token punctuation">(</span><span class="token keyword keyword-object">object</span> <span class="token operator">:</span> PasarCadenaInterface <span class="token punctuation">{</span>
          <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                  applicationContext<span class="token punctuation">,</span>
                  <span class="token string">&quot;Has pulsado &quot;</span> <span class="token operator">+</span>cadena<span class="token punctuation">,</span>
                  Toast<span class="token punctuation">.</span>LENGTH_SHORT <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre></blockquote>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F; Reconstrueix els exemples i comprova el seu funcionament, amb control de Clic en la imatge i en els dos textos nomene i cognom. En aquests &#xFA;ltims que arribe la informaci&#xF3; a la Main i que es mostre amb un Toast</span></p>
<div style="page-break-after:always;"></div>
<h4 class="mume-header" id="altres-efectes-sobre-el-recycler">Altres efectes sobre el Recycler</h4>

<h5 class="mume-header" id="canviar-el-color-de-les-l%C3%ADnies">Canviar el color de les l&#xED;nies</h5>

<p>Actuant sobre el Holder podem aconseguir un altre tipus d&apos;efectes, com per exemple canviar el color de les l&#xED;nies pareixes i de les imparells de la llista.</p>
<div align="center">
    <img height="200" src="./imagenes/recycler3.png">
</div>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">,</span> context<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token operator">..</span><span class="token punctuation">.</span>

    <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">,</span> pos<span class="token operator">:</span>Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>pos <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            v<span class="token punctuation">.</span>findViewById<span class="token operator">&lt;</span>MaterialCardView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>cardView<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setCardBackgroundColor</span><span class="token punctuation">(</span>ContextCompat<span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>oscuro<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>pos <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> v<span class="token punctuation">.</span>findViewById<span class="token operator">&lt;</span>MaterialCardView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>cardView<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setCardBackgroundColor</span><span class="token punctuation">(</span>ContextCompat<span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>claro<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; Per a aconseguir aqueix efecte nom&#xE9;s s&apos;ha hagut de controlar que posici&#xF3; s&apos;est&#xE0; carregant i depenent de si &#xE9;s parell o no, s&apos;acoloreix d&apos;un color o un altre la vista del CardView <strong>L&#xED;nia de 7 a 11</strong>. Al constructor li hem hagut de passar el context per a poder usar el m&#xE8;tode *getColor i al m&#xE8;tode <strong>bind</strong> li hem passat la posici&#xF3; de l&apos;element que es carrega <strong>L&#xED;nia 4</strong>.</p>
</blockquote>
<div style="page-break-after:always;"></div>
<h5 class="mume-header" id="fer-visible-algun-element">Fer visible algun element</h5>

<p>D&apos;altra banda podr&#xED;em aconseguir l&apos;efecte d&apos;afegir algun element si es compleix determinada condici&#xF3; per exemple, en aquest cas el que fem &#xE9;s mostrar una imatge, que en principi est&#xE0; oculta en el layout de la l&#xED;nia del recycler, en el cas que el nom continga un 3. El codi tamb&#xE9; hauria d&apos;anar en el bind del Holder.</p>
<div align="center">
    <img height="200" src="./imagenes/recycler4.png">
</div>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">,</span> context<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token operator">..</span><span class="token punctuation">.</span>

    <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">,</span> pos<span class="token operator">:</span>Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">true</span><span class="token punctuation">)</span>
            imagen<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span> 
        <span class="token keyword keyword-else">else</span> imagen<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>INVISIBLE<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><h5 class="mume-header" id="detectar-swipe-izqder-sobre-un-element-del-recycler">Detectar swipe izq/der sobre un element del recycler</h5>

<p>Una opci&#xF3; molt utilitzada en les llistes, &#xE9;s la de controlar el lliscament a l&apos;esquerra o cap a la dreta sobre un dels seus elements. Per a aix&#xF2; haurem d&apos;usar una classe que ja est&#xE0; definida i que haurem de copiar en el nostre projecte, anomenada <strong><code>SwipeDetector</code></strong> (es passa en els recursos). En l&apos;Adaptador haur&#xED;em d&apos;implementar la interf&#xED;cie onTouch, perqu&#xE8; ens detecte el despla&#xE7;ament, aix&#xF2; ho farem com ho vam fer en punts anteriors. <strong>L&#xED;nies marcades en l&apos;Adaptador</strong>.</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> Adaptador <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> datos<span class="token operator">:</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">:</span>
    RecyclerView<span class="token punctuation">.</span>Adapter<span class="token operator">&lt;</span>Holder<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">,</span>
    View<span class="token punctuation">.</span>OnLongClickListener<span class="token punctuation">,</span> View<span class="token punctuation">.</span><span class="token function">OnTouchListener</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> listenerClick<span class="token operator">:</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">;</span>
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> listenerLong<span class="token operator">:</span>View<span class="token punctuation">.</span>OnLongClickListener
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> listenerOnTouch<span class="token operator">:</span>View<span class="token punctuation">.</span>OnTouchListener
   
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreateViewHolder</span><span class="token punctuation">(</span>viewGroup<span class="token operator">:</span> ViewGroup<span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Holder <span class="token punctuation">{</span>
        <span class="token keyword keyword-val">val</span> itemView<span class="token operator">:</span> View <span class="token operator">=</span> LayoutInflater<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>viewGroup<span class="token punctuation">.</span>context<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>recyclerlayout<span class="token punctuation">,</span> viewGroup<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        itemView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        itemView<span class="token punctuation">.</span><span class="token function">setOnLongClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        itemView<span class="token punctuation">.</span><span class="token function">setOnTouchListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-val">val</span> holder<span class="token operator">=</span><span class="token function">Holder</span><span class="token punctuation">(</span>itemView<span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> holder
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token function">onTouch</span><span class="token punctuation">(</span>listenerOnTouch<span class="token operator">:</span>View<span class="token punctuation">.</span>OnTouchListener<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>listenerOnTouch<span class="token operator">=</span>listenerOnTouch
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onTouch</span><span class="token punctuation">(</span>p0<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">,</span> p1<span class="token operator">:</span> MotionEvent<span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token punctuation">{</span>
        listenerOnTouch<span class="token punctuation">.</span><span class="token function">onTouch</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span>p1<span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span>  <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>En la ActivityMain, haurem de cridar al m&#xE8;tode <strong><code>OnTouch</code></strong> de l&apos;adaptador passant-li un objecte de la classe <strong><code>SwipeDetector</code></strong> <strong>L&#xED;nia 2</strong>, per&#xF2; a l&apos;hora de detectar el moviment haurem d&apos;usar la interf&#xED;cie onClikListener <strong>L&#xED;nia 3</strong>, com veiem en el codi seg&#xFC;ent. Si ens fixem, podrem veure que l&apos;objecte swipeDetector detectar si el moviment s&apos;ha produ&#xEF;t a la dreta o a l&apos;esquerra.</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-val">val</span> swipeDetector <span class="token operator">=</span> <span class="token function">SwipeDetector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
adaptador<span class="token punctuation">.</span><span class="token function">onTouch</span><span class="token punctuation">(</span>swipeDetector<span class="token punctuation">)</span>
adaptador<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span><span class="token function">OnClickListener</span> <span class="token punctuation">{</span> v <span class="token operator">-&gt;</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>swipeDetector<span class="token punctuation">.</span><span class="token function">swipeDetected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>swipeDetector<span class="token punctuation">.</span>action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    SwipeDetector<span class="token punctuation">.</span>Action<span class="token punctuation">.</span>LR <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                            applicationContext<span class="token punctuation">,</span>
                            <span class="token string">&quot;Has pulsado Izquierda&quot;</span><span class="token punctuation">,</span>
                            Toast<span class="token punctuation">.</span>LENGTH_SHORT
                        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                    SwipeDetector<span class="token punctuation">.</span>Action<span class="token punctuation">.</span>RL <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                            applicationContext<span class="token punctuation">,</span>
                            <span class="token string">&quot;Has pulsado Derecha&quot;</span><span class="token punctuation">,</span>
                            Toast<span class="token punctuation">.</span>LENGTH_SHORT
                        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span>
                Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                    applicationContext<span class="token punctuation">,</span>
                    <span class="token string">&quot;Has pulsado&quot;</span> <span class="token operator">+</span> recyclerView<span class="token punctuation">.</span><span class="token function">getChildAdapterPosition</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    Toast<span class="token punctuation">.</span>LENGTH_SHORT
                <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><h4 class="mume-header" id="selecci%C3%B3-multiple-en-el-recycler">Selecci&#xF3; Multiple en el Recycler</h4>

<p>Android aporta la biblioteca de <strong><code>recyclerview-selection</code></strong> per a <a href="https://developer.android.com/guide/topics/ui/layout/recyclerview-custom?hl=es-419#select">seleccionar m&#xE9;s d&apos;un element d&apos;una llista</a>, creada amb un recycler. &#xC9;s a dir l&apos;acci&#xF3; que ocorre en la majoria de llistes, quan realitzem un clic llarg i despr&#xE9;s ens deixa seleccionar elements. Per a poder implementar aquesta selecci&#xF3;, haurem de tindre creat un RecyclerView en perfecte funcionament, a partir d&apos;ac&#xED; haurem de seguir una s&#xE8;rie de passos:</p>
<ol>
<li>
<p>Implementar <strong>ItemDetailsLookup</strong>. Aquest element permet que la biblioteca de selecci&#xF3; accedisca a la informaci&#xF3; sobre els elements de RecyclerView als quals s&apos;atorga un <strong><code>MotionEvent</code></strong> (alguna acci&#xF3; de moviment: pulsaci&#xF3;, arrossegament, etc.). Per a construir-ho necessitar&#xE0; la informaci&#xF3; de l&apos;element premut, que es pot extraure del <strong><code>Holder</code></strong>. Per a aix&#xF2; el primer que farem ser&#xE0; crear en el <strong>Holder.Kt</strong>, un m&#xE8;tode al qual es puga cridar per a identificar de manera exclusiva l&apos;element de la llista premut. Aquest m&#xE8;tode ha de retornar una inst&#xE0;ncia de la classe <strong><code>ItemDetailsLookup.ItemDetails</code></strong>.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-fun">fun</span> <span class="token function">getItemDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ItemDetailsLookup<span class="token punctuation">.</span>ItemDetails<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span> <span class="token operator">=</span>
        <span class="token keyword keyword-object">object</span><span class="token operator">:</span> ItemDetailsLookup<span class="token punctuation">.</span>ItemDetails<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Int<span class="token operator">=</span>adapterPosition
            <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getSelectionKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Long<span class="token operator">?</span> <span class="token operator">=</span>itemId
        <span class="token punctuation">}</span>
</pre><p>I sobreescriure els dos m&#xE8;todes de la classe abstracta per a identificar de manera &#xFA;nica l&apos;element sobre el qual s&apos;ha realitzat l&apos;acci&#xF3;. Per a aix&#xF2; podem usar les propietats <strong><code>adapterPosition</code></strong> i <strong><code>itemId</code></strong>, que posseeix la classe <strong><code>ViewHolder</code></strong>.</p>
<p>Com es pot veure en el codi, hem fet de tipus <strong><code>Long</code></strong> la classe gen&#xE8;rica <strong><code>ItemDetails</code></strong>. El long determina el tipus de clau de selecci&#xF3; que usarem. Hi ha tres tipus de claus que es poden usar per a identificar elements seleccionats: <em>Parcelable, String i Long</em>. Ara passarem a implementar la classe, per exemple <strong>LookUp.kt</strong>, que herete de <strong><code>ItemDetailsLookup</code></strong> de la mena de la clau seleccionada. En el m&#xE8;tode que anul&#xB7;lem, es captura la vista seleccionada i amb ella accedim al m&#xE8;tode creat amb anterioritat en el Holder.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-class">class</span> <span class="token function">LookUp</span> <span class="token punctuation">(</span><span class="token keyword keyword-private">private</span> <span class="token keyword keyword-val">val</span> rv<span class="token operator">:</span> RecyclerView<span class="token punctuation">)</span>
<span class="token operator">:</span> ItemDetailsLookup<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getItemDetails</span><span class="token punctuation">(</span>event<span class="token operator">:</span> MotionEvent<span class="token punctuation">)</span>
        <span class="token operator">:</span> ItemDetails<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token operator">?</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-val">val</span> view <span class="token operator">=</span> rv<span class="token punctuation">.</span><span class="token function">findChildViewUnder</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>x<span class="token punctuation">,</span> event<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>view <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>rv<span class="token punctuation">.</span><span class="token function">getChildViewHolder</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> Holder<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getItemDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre></li>
<li>
<p>Actualitza les Views dels elements de RecyclerView perqu&#xE8; reflectisca si l&apos;usuari va realitzar o no una selecci&#xF3;. Aquests canvis es poden fer en el Holder, com hem vist anteriorment, encara que en aquest cas haurem de tindre en compte si l&apos;element ha sigut seleccionat. Per a aix&#xF2; usem un tipus <strong><code>SelectionTracker</code></strong> que passarem com a argument des de l&apos;Adaptador. S&apos;aconsella que es mostre els elements seleccionats mitjan&#xE7;ant un canvi de color.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">,</span> tracker<span class="token operator">:</span> SelectionTracker<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>tracker<span class="token operator">!!</span><span class="token punctuation">.</span><span class="token function">isSelected</span><span class="token punctuation">(</span>adapterPosition<span class="token punctuation">.</span><span class="token function">toLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            cardView<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token function">ColorDrawable</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>CYAN<span class="token punctuation">)</span>
        <span class="token keyword keyword-else">else</span> cardView<span class="token punctuation">.</span>background<span class="token operator">=</span> <span class="token function">ColorDrawable</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>LTGRAY<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</pre></li>
<li>
<p>Unir els anteriors passos mitjan&#xE7;ant un objecte de tipus <strong><code>SelectionTracker.Builder</code></strong> <strong>L&#xED;nia 6 a 14</strong>, creat en l&apos;activitat principal i passat a l&apos;adaptador, que al seu torn el manar&#xE0; al Holder. Aquest element inicialitza el rastrejador de selecci&#xF3;. Al seu constructor se li passa: l&apos;ID de selecci&#xF3; (una cadena &#xFA;nica), la inst&#xE0;ncia del RecyclerView, el prove&#xEF;dor de claus (es pot triar entre varis de la BCL), la classe creada en el pas un per al control de l&apos;element premut i l&apos;estrat&#xE8;gia d&apos;emmagatzematge en aquest cas de tipus Long com la clau (aquesta inst&#xE0;ncia permet assegurar que no es perden els elements seleccionats en els canvis d&apos;estat del dispositiu).</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers">recyclerView<span class="token punctuation">.</span><span class="token function">setHasFixedSize</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword keyword-val">val</span> adaptador <span class="token operator">=</span> <span class="token function">Adaptador</span><span class="token punctuation">(</span>datos<span class="token punctuation">,</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
adaptador<span class="token punctuation">.</span><span class="token function">setHasStableIds</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">//Antes de asignar </span>
                            <span class="token comment">//el adaptador al recycler</span>
recyclerView<span class="token punctuation">.</span>adapter <span class="token operator">=</span> adaptador
tracker <span class="token operator">=</span> SelectionTracker<span class="token punctuation">.</span>Builder<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token punctuation">(</span>
            <span class="token string">&quot;selecccion&quot;</span><span class="token punctuation">,</span>
            recyclerView<span class="token punctuation">,</span>
            <span class="token function">StableIdKeyProvider</span><span class="token punctuation">(</span>recyclerView<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">LookUp</span><span class="token punctuation">(</span>recyclerView<span class="token punctuation">)</span><span class="token punctuation">,</span>
            StorageStrategy<span class="token punctuation">.</span><span class="token function">createLongStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withSelectionPredicate</span><span class="token punctuation">(</span>
            SelectionPredicates<span class="token punctuation">.</span><span class="token function">createSelectAnything</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
adaptador<span class="token punctuation">.</span><span class="token function">setTracker</span><span class="token punctuation">(</span>tracker<span class="token punctuation">)</span> <span class="token comment">//m&#xE9;todo que crearemos en el adaptador</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>A m&#xE9;s s&apos;haur&#xE0; de fixar la grand&#xE0;ria del recycler <strong>L&#xED;nia 1</strong>, assignar a l&apos;adaptador la propietat de HasStableIds a true <strong>L&#xED;nia 3</strong>. i passar la inst&#xE0;ncia de Tracker a l&apos;adaptador mitjan&#xE7;ant un m&#xE8;tode que crearem en aquest <strong>l&#xED;nia 15</strong>.</p>
<blockquote>
<p>&#x270B; No deberemos olvidar que el adaptador debe proporcionar unos identificadores estables, una manera sencilla de hacerlo es anulando su m&#xE9;todo <strong><code>getItemId</code></strong> (asigna la posici&#xF3;n del elemento como id):</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getItemId</span><span class="token punctuation">(</span>position<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Long <span class="token punctuation">{</span>
   <span class="token keyword keyword-return">return</span> position<span class="token punctuation">.</span><span class="token function">toLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre></blockquote>
</li>
</ol>
<p>Per a controlar amb m&#xE9;s seguretat l&apos;estabilitat de l&apos;app, s&apos;hauria d&apos;anul&#xB7;lar el m&#xE8;tode <strong><code>onSaveInstanceState</code></strong> per a passar la informaci&#xF3; capturada, a la inst&#xE0;ncia del <strong><code>tracker</code></strong>.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token operator">:</span> Bundle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token punctuation">)</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>outState <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
            tracker<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre><p>I en iniciar l&apos;aplicaci&#xF3; afegir la seg&#xFC;ent l&#xED;nia per a recuperar el tracker guardat:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>savedInstanceState <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
        tracker<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">onRestoreInstanceState</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
</pre><p>Per la seua part en l&apos;adaptador nom&#xE9;s tindrem aquests dos canvis.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span>holder<span class="token operator">:</span> Holder<span class="token punctuation">,</span> position<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-val">val</span> item<span class="token operator">:</span> Usuario <span class="token operator">=</span> datos<span class="token punctuation">[</span>position<span class="token punctuation">]</span>
    holder<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>tracker<span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
<span class="token keyword keyword-fun">fun</span> <span class="token function">setTracker</span><span class="token punctuation">(</span>tracker<span class="token operator">:</span> SelectionTracker<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>tracker <span class="token operator">=</span> tracker
<span class="token punctuation">}</span>
</pre><p>Despr&#xE9;s de realitzar aquests passos, podem provar el funcionament de l&apos;aplicaci&#xF3;.</p>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F;Reconstrueix l&apos;exemple i prova el funcionament</span></p>
<ol start="4">
<li>
<p>Nom&#xE9;s ens queda controlar la pulsaci&#xF3; i realitzar alguna cosa quan aix&#xF2; oc&#xF3;rrega. Haurem d&apos;afegir un observador al Tracker i per a aix&#xF2; s&apos;utilitza un objecte <strong><code>SelectionTracker.SelectionObserver</code></strong>, que s&apos;encarrega de registrar els canvis. Dins d&apos;aquest objecte posarem el codi que creguem convenient, en aquest cas solament vam mostrar un Toast amb l&apos;id dels elements que estan en la selecci&#xF3;.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">tracker<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>
            <span class="token keyword keyword-object">object</span><span class="token operator">:</span> SelectionTracker<span class="token punctuation">.</span>SelectionObserver<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onSelectionChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>tracker<span class="token operator">!!</span><span class="token punctuation">.</span><span class="token function">hasSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword keyword-var">var</span> cadena<span class="token operator">=</span><span class="token function">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        tracker<span class="token operator">?</span><span class="token punctuation">.</span>selection<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">forEach</span> <span class="token punctuation">{</span> id<span class="token operator">-&gt;</span>
                                  cadena<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>id<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
                        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token label symbol">@MainActivity</span><span class="token punctuation">,</span>cadena<span class="token punctuation">,</span> 
                                           Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre><blockquote>
<p>&#x26A0;&#xFE0F; El comportament esperat quan es fa una selecci&#xF3; multiple, &#xE9;s el que se superpose una toolbar sobre la ActionBar amb un men&#xFA; espec&#xED;fic per a les accions que puguen oc&#xF3;rrer sobre la selecci&#xF3;. Per a aix&#xF2; s&apos;haur&#xE0; d&apos;implementar la classe <strong>ActionMode</strong> que ser&#xE0; activada quan l&apos;observador detecte que t&#xE9; selecci&#xF3;. Aquesta implementaci&#xF3; es veur&#xE0; en el tema de men&#xFA;s</p>
</blockquote>
</li>
</ol>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>