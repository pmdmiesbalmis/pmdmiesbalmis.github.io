<!DOCTYPE html><html><head>
      <title>PMDM 2&#xBA; DAM  Tema 8. Interfaz de Usuario III</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
.markdown-preview.markdown-preview .slides > section {
  height: 100%;
  font-size: 90%;
  overflow-y: auto !important;
}
.markdown-preview.markdown-preview .slide code {
  color: yellow;
}

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <style>/* 
Añade 

@import "../EstilosPersonalizadosMarkdownEnhanced.less"

justo después del front matter 
*/
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v17/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
</style>
<h1 class="mume-header undefined" id="apuntes">Apuntes</h1>

<p><a href="./tema8_Interfaz_Usuario_III.pdf">Descargar estos apuntes</a></p>
<h1 class="mume-header undefined" id="tema-8-interfaz-de-usuario-iii">Tema 8. Interfaz de Usuario III</h1>

<h2 class="mume-header undefined" id="%C3%ADndice">&#xCD;ndice</h2>

<ol>
<li><a href="#spinner">Spinner</a></li>
<li><a href="#recyclerview">RecyclerView</a>
<ol>
<li><a href="#click-sobre-un-elemento-de-la-lista">Click sobre un elemento de la lista</a></li>
<li><a href="#click-en-cualquier-lugar-de-la-vista">Click en cualquier lugar de la vista</a></li>
<li><a href="#click-en-cualquier-lugar-de-la-vista-pasando-informaci%C3%B3n-a-la-actividad-principal">Click en cualquier lugar de la vista pasando informaci&#xF3;n a la Actividad Principal</a></li>
<li><a href="#otros-efectos-sobre-el-recycler">Otros efectos sobre el Recycler</a></li>
<li><a href="#selecci%C3%B3n-multiple-en-el-recycler">Selecci&#xF3;n Multiple en el Recycler</a></li>
</ol>
</li>
</ol>
<div style="page-break-after:always;"></div>
<h3 class="mume-header" id="spinner">Spinner</h3>

<p>Las listas desplegables en Android se llaman <a href="https://developer.android.com/guide/topics/ui/controls/spinner">Spinners</a>. Es una lista que muestras los elementos una vez pulsada la flecha de despliegue, el usuario puede seleccionar de la lista emergente uno de los elemento. El c&#xF3;digo de la vista de un Spinner ser&#xE1; el siguiente:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Spinner</span> <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/spinner<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</pre><p>Los elementos que mostrar&#xE1; nuestro Spinner no se pueden indicar directamente, sino que es necesario crear una estructura de elementos que podamos asociar a &#xE9;ste en nuestro c&#xF3;digo. Una de las maneras ser&#xED;a usando un Array de Strings para luego asignarlo al spinner:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-var">var</span> colores <span class="token operator">=</span> <span class="token function">arrayOf</span><span class="token punctuation">(</span><span class="token string">&quot;Rojo&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Verde&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Azul&quot;</span><span class="token punctuation">)</span>
</pre><p>A continuaci&#xF3;n debemos definir el adaptador, en nuestro caso un objeto ArrayAdapter, que ser&#xE1; el objeto que lanzaremos con nuestro Spinner.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">  <span class="token keyword keyword-val">val</span> adaptador <span class="token operator">=</span> <span class="token function">ArrayAdapter</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> 
  android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>simple_list_item_1<span class="token punctuation">,</span> colores<span class="token punctuation">)</span>
</pre><p>Creamos el adaptador en s&#xED;, al que pasamos 3 par&#xE1;metros:</p>
<ol>
<li>El contexto, que normalmente ser&#xE1; simplemente una referencia a la actividad donde se crea el adaptador.</li>
<li>El ID del layout sobre el que se mostrar&#xE1;n los datos del control. En este caso le pasamos el ID de un layout predefinido en Android (android.R.layout.simple_spinner_item), formado &#xFA;nicamente por un control textView, pero podr&#xED;amos pasar el ID de cualquier layout de nuestro proyecto con cualquier estructura y conjunto de controles.</li>
<li>El elemento que contiene los datos a mostrar.</li>
</ol>
<p>Con estas simples l&#xED;neas tendremos un control similar al de la siguiente imagen:</p>
   <span style="align: center;">
   <table align="center">
   <tbody><tr style="border:hidden;">
   <td style="border:hidden;">
   <div align="center">
       <img height="60" src="./imagenes/spinner1.png">
   </div>
   </td>
   <td>
   <div align="center">
       <img height="100" src="./imagenes/spinner2.png">
   </div>
   </td>
   </tr>
   </tbody></table>
   </span>
<blockquote>
<p>&#x1F393; Vamos a crea un proyecto de ejemplo llamado Spinner al que a&#xF1;adiremos el siguiente c&#xF3;digo en la <strong>MainActivity.kt</strong>, y no olvides a&#xF1;adir un spinner con <em>id=spinner</em> en el layout <strong>activity_main.xml</strong>:</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                    AdapterView<span class="token punctuation">.</span><span class="token function">OnItemSelectedListener</span> <span class="token punctuation">{</span>
   <span class="token keyword keyword-var">var</span> colores <span class="token operator">=</span> <span class="token function">arrayOf</span><span class="token punctuation">(</span><span class="token string">&quot;Rojo&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Verde&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Azul&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword keyword-lateinit">lateinit</span>  <span class="token keyword keyword-var">var</span> listaColores<span class="token operator">:</span> Spinner
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
       <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>
       <span class="token keyword keyword-val">val</span> adaptador <span class="token operator">=</span> <span class="token function">ArrayAdapter</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>
                                   simple_list_item_1<span class="token punctuation">,</span> colores<span class="token punctuation">)</span>
       listaColores <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>spinner<span class="token punctuation">)</span>
       listaColores<span class="token punctuation">.</span>adapter<span class="token operator">=</span>adaptador
       listaColores<span class="token punctuation">.</span><span class="token function">setOnItemSelectedListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x1F4CC; <strong>L&#xED;nea 8</strong> creamos el adaptador, como hemos explicado anteriormente, para asignarlo al Spinner en la <strong>L&#xED;nea 11</strong>.</p>
<p>En cuanto a los eventos lanzados por el control Spinner, el m&#xE1;s utilizado ser&#xE1; el generado al seleccionarse una opci&#xF3;n de la lista desplegable, onItemSelected. Para capturar este evento se proceder&#xE1; de forma similar a lo ya visto para otros controles anteriormente, asign&#xE1;ndole su controlador mediante el m&#xE9;todo <strong><code>setOnItemSelectedListener()</code></strong>, en este caso lo hacemos mediante el m&#xE9;todo de derivar de la interfaz,  <strong>L&#xED;nea 12</strong>.<br>
En el c&#xF3;digo inferior vemos implementado el m&#xE9;todo, que muestra un Toast con el color elegido.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onItemSelected</span><span class="token punctuation">(</span>adapterView<span class="token operator">:</span> AdapterView<span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span><span class="token operator">?</span><span class="token punctuation">,</span> 
                               view<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">,</span> l<span class="token operator">:</span> Long<span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword keyword-val">val</span> x <span class="token operator">=</span> Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">&quot;El color elegido es: &quot;</span> <span class="token operator">+</span>
                              colores<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_LONG<span class="token punctuation">)</span>
       x<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre></blockquote>
<h5 class="mume-header" id="nota-ampliativa">Nota ampliativa</h5>

<p>Una alternativa a tener en cuenta, si los datos a mostrar en el control son est&#xE1;ticos, ser&#xED;a definir la lista de posibles valores como un recurso de tipo string-array. Para ello, primero crear&#xED;amos un nuevo fichero XML en la carpeta <strong>res/values</strong> llamado por ejemplo spinner.xml e incluir&#xED;amos en &#xE9;l los valores seleccionables de la siguiente forma:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string-array</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>colores<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>ROJO<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>VERDE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>AZUL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string-array</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">&gt;</span></span>
</pre><p>En este caso, a la hora de crear el adaptador utilizar&#xED;amos el m&#xE9;todo <strong><code>createFromResource()</code></strong> para hacer referencia al array XML que acabamos de crear:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-val">val</span> adaptador<span class="token operator">=</span>ArrayAdapter<span class="token punctuation">.</span><span class="token function">createFromResource</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span>R<span class="token punctuation">.</span>array<span class="token punctuation">.</span>colores<span class="token punctuation">,</span>
                                    android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>simple_list_item_1<span class="token punctuation">)</span>
</pre><p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F;Ejercicio PropuestoSpinner</span></p>
<h3 class="mume-header" id="recyclerview">RecyclerView</h3>

<p>Los <a href="https://developer.android.com/guide/topics/ui/layout/recyclerview?hl=es-419">RecyclerView</a> son los elementos que  proporciona Android para mostrar cantidades de datos, normalmente en forma de listas. Esta librer&#xED;a permite adaptar, de forma sencilla, la salida al gusto del dise&#xF1;ado,  adem&#xE1;s de mejorar el rendimiento y la respuesta de la aplicaci&#xF3;n con respecto a las anteriores soluciones. Esto es debido a que, con este dise&#xF1;o, cuando un elemento se desplaza fuera de la pantalla no se destruye su vista, sino que se reutiliza para los elementos nuevos que ahora se muestran en ella.<br>
<strong><code>RecyclerView</code></strong> se va a sustentar sobre otros componentes complementarios para determinar c&#xF3;mo acceder a los datos y c&#xF3;mo mostrarlos. Los m&#xE1;s importantes ser&#xE1;n los siguientes:</p>
<ul>
<li>RecyclerView.Adapter</li>
<li>RecyclerView.ViewHolder</li>
<li>LayoutManager</li>
<li>ItemDecoration</li>
<li>ItemAnimator</li>
</ul>
<p>De igual forma que hemos hecho con el <strong><code>Spinner</code></strong>, un <strong><code>RecyclerView</code></strong> se apoyar&#xE1; tambi&#xE9;n en un adaptador para trabajar con nuestros datos, en este caso un adaptador que herede de la clase <strong><code>RecyclerView.Adapter</code></strong>. La peculiaridad  es que este tipo de adaptador <em><strong>obliga</strong></em> a utilizar un <strong><code>RecyclerView.ViewHolder</code></strong> (elemento que permite optimizar el acceso a los datos del adaptador).<br>
Una vista de tipo RecyclerView no determina, por s&#xED; sola, la forma en que se van a mostrar en pantalla los elementos de nuestra colecci&#xF3;n, sino que va a delegar esa tarea a otro componente llamado <strong><code>LayoutManager</code></strong>, que tambi&#xE9;n tendremos que crear y asociar al RecyclerView para su correcto funcionamiento. Por suerte, el SDK incorpora de serie tres LayoutManager para las tres representaciones m&#xE1;s habituales:</p>
<ul>
<li><strong><code>LinearLayoutManager</code></strong> para la visualizaci&#xF3;n como lista vertical u horizontal,</li>
<li><strong><code>GridLayoutManager</code></strong> para la visualizaci&#xF3;n como tabla tradicional ()</li>
<li><strong><code>StaggeredGridLayoutManager</code></strong> que visualiza los elementos como una tabla apilada o de celdas no alineadas.</li>
</ul>
<p>Por tanto, siempre que optemos por alguna de estas distribuciones de elementos no tendremos que crear nuestro propio LayoutManager personalizado, aunque por supuesto nada nos impide hacerlo.<br>
Los dos &#xFA;ltimos componentes de la lista <strong><code>ItemDecoration</code></strong> e <strong><code>ItemAnimator</code></strong>, se encargar&#xE1;n de definir c&#xF3;mo se representar&#xE1;n algunos aspectos visuales de nuestra colecci&#xF3;n de datos (m&#xE1;s all&#xE1; de la distribuci&#xF3;n definida por el LayoutManager), por ejemplo: <em>marcadores o separadores de elementos</em>, y de c&#xF3;mo se animar&#xE1;n los elementos al realizarse determinadas acciones sobre la colecci&#xF3;n, por ejemplo: <em>al a&#xF1;adir o eliminar elementos</em>.<br>
De todas formas, no siempre ser&#xE1; obligatorio implementar todos estos componentes para hacer uso de un RecyclerView. <strong>Lo m&#xE1;s habitual ser&#xE1; implementar el Adapter y el ViewHolder, utilizar alguno de los LayoutManager predefinidos</strong>, y s&#xF3;lo en caso de necesidad crear los Item Decoration e Item Animator necesarios para dar un toque de personalizaci&#xF3;n especial a nuestra aplicaci&#xF3;n.</p>
<blockquote>
<p>&#x1F393; Vamos a crear un ejemplo que muestre un recycler con la lista de una ser&#xED;e de usuarios. Para ello deberemos crear un nuevo proyecto <strong>EjemploRecycler</strong>. Lo primero que tendremos que hacer es crear una clase <em>pojo</em> que nos sirva para los datos de los usuarios. Por ejemplo <strong>Usuario.kt</strong> de la siguiente manera:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-class">class</span> <span class="token function">Usuario</span><span class="token punctuation">(</span>nombre<span class="token operator">:</span>String<span class="token punctuation">,</span> apellidos<span class="token operator">:</span>String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword keyword-var">var</span> nombre<span class="token operator">:</span> String
   <span class="token keyword keyword-var">var</span> apellidos<span class="token operator">:</span> String
   <span class="token keyword keyword-init">init</span> <span class="token punctuation">{</span>
       <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>nombre <span class="token operator">=</span> nombre
       <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>apellidos <span class="token operator">=</span> apellidos
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>El siguiente paso ser&#xED;a a&#xF1;adir el recycler al lugar donde queremos que sea mostrado, por ejemplo a la actividad principal. En este caso podr&#xED;a quedar la <strong>main_activity.xml</strong> de la siguiente manera:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>androidx.constraintlayout.widget.ConstraintLayout</span> 
   <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">xmlns:</span>tools</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/tools<span class="token punctuation">&quot;</span></span> 
   <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">tools:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.MainActivity<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>androidx.recyclerview.widget.RecyclerView</span>
   <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/recyclerList<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#F87A7D87<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>androidx.constraintlayout.widget.ConstraintLayout</span><span class="token punctuation">&gt;</span></span>
</pre><p>Tambi&#xE9;n tenemos que pensar cual es el dise&#xF1;o que deseamos para cada uno de los elementos del recycler, esto se hace en un recurso layout y de la forma que ya sabemos. Por ejemplo podr&#xED;a ser el archivo <strong>recyclerlayout.xml</strong>:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>com.google.android.material.card.MaterialCardView</span> 
   <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">xmlns:</span>card_view</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">card_view:</span>cardCornerRadius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4dp<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">card_view:</span>cardUseCompatPadding</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">card_view:</span>cardElevation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2dp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>
       <span class="token attr-name"><span class="token namespace">android:</span>padding</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8dp<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#493DEC<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>horizontal<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</pre><pre data-role="codeBlock" data-info="xml" class="language-xml">       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>
           <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0dp<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name"><span class="token namespace">android:</span>layout_weight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.75<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vertical<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>
               <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/textView<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Large Text<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>textColor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@android:color/white<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>textSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20sp<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>
               <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/textView2<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Medium Text<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>textColor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@android:color/white<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name"><span class="token namespace">android:</span>textSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>15sp<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>com.google.android.material.card.MaterialCardView</span> <span class="token punctuation">&gt;</span></span>
</pre><p>&#x270B; Para conseguir una separaci&#xF3;n entre los elementos de la lista, se puede usar el contenedor <strong><code>CardView</code></strong> que ya conocemos de temas anteriores. RecyclerView no tiene la separaci&#xF3;n por elementos creada por defecto, se tendr&#xED;a que simular de distintas maneras, una es usando tarjetas como en este caso.</p>
<p>El siguiente paso ser&#xED;a escribir nuestro adaptador. Este adaptador deber&#xE1; extender de la clase <strong><code>RecyclerView.Adapter</code></strong>, de la cual tendremos que sobrescribir principalmente tres m&#xE9;todos:</p>
<ul>
<li><em><code>onCreateViewHolder()</code></em>. Encargado de crear los nuevos objetos ViewHolder necesarios para los elementos de la colecci&#xF3;n.</li>
<li><em><code>onBindViewHolder()</code></em>. Encargado de actualizar los datos de un ViewHolder ya existente.</li>
<li><em><code>onItemCount()</code></em>. Indica el n&#xFA;mero de elementos de la colecci&#xF3;n de datos.</li>
</ul>
<p>El m&#xE9;todo <strong><code>onCreateViewHolder</code></strong> devuelve un objeto de tipo <strong>Holder</strong>, por lo que primero deberemos crear una clase que herede de <strong><code>RecyclerView.ViewHolder</code></strong>, que podr&#xED;a ser como la siguiente, <strong>Holder.kt</strong>:</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword keyword-val">val</span> textNombre<span class="token operator">:</span> TextView
   <span class="token keyword keyword-val">val</span> textApellido<span class="token operator">:</span> TextView

   <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
       textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword keyword-init">init</span> <span class="token punctuation">{</span>
       textNombre <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span>
       textApellido <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView2<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x270B;  El patr&#xF3;n <strong>ViewHolder</strong> tiene un &#xFA;nico prop&#xF3;sito en su implementaci&#xF3;n, mejorar el rendimiento. Y es que cuando hablamos de aplicaciones m&#xF3;viles, el rendimiento es un tema de gran importancia. El ViewHolder mantiene una referencia a los elementos del RecyclerView mientras el usuario realiza scrolling en la aplicaci&#xF3;n. As&#xED; se evitan las frecuentes llamadas a findViewById, realiz&#xE1;ndola la primera vez y el resto usando la referencia en el ViewHolder.</p>
<p>&#x1F4CC; <strong>L&#xED;nea 0</strong> se definir&#xE1; como otra clase extendida de la clase <strong><code>RecyclerView.ViewHolder</code></strong>, y ser&#xE1; bastante sencilla, tan s&#xF3;lo tendremos que incluir como atributos las referencias a los controles del layout de un elemento de la lista (en nuestro caso los dos TextView) e inflarlas en el constructor sobre la vista recibida como par&#xE1;metro <strong>L&#xED;neas 10 y 11</strong>. A&#xF1;adiremos tambi&#xE9;n un m&#xE9;todo, normalmente llamado <strong>bind()</strong>, que se encargue de asignar los contenidos a los dos textos a partir del objeto Usuario, <strong>L&#xED;neas 6 y 7</strong>.</p>
<p>Ahora ta podemos crear el adaptador, que en nuestro proyecto podr&#xED;a ser <strong>Adaptador.kt</strong> que herede de <strong><code>RecyclerView.Adapter</code></strong> y  que nos obligar&#xE1; a sobrescribir los m&#xE9;todos que sean necesarios, quedando el c&#xF3;digo como vemos en la imagen:</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> Adaptador <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> datos<span class="token operator">:</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">:</span>
                                      RecyclerView<span class="token punctuation">.</span>Adapter<span class="token operator">&lt;</span>Holder<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreateViewHolder</span><span class="token punctuation">(</span>viewGroup<span class="token operator">:</span> ViewGroup<span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span>Holder
   <span class="token punctuation">{</span>
       <span class="token keyword keyword-val">val</span> itemView<span class="token operator">:</span> View <span class="token operator">=</span> LayoutInflater<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>viewGroup<span class="token punctuation">.</span>context<span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>recyclerlayout<span class="token punctuation">,</span> viewGroup<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
       <span class="token keyword keyword-return">return</span> <span class="token function">Holder</span><span class="token punctuation">(</span>itemView<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span>holder<span class="token operator">:</span> Holder<span class="token punctuation">,</span> position<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword keyword-val">val</span> item<span class="token operator">:</span> Usuario <span class="token operator">=</span> datos<span class="token punctuation">[</span>position<span class="token punctuation">]</span>
       holder<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getItemCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Int <span class="token punctuation">{</span>
       <span class="token keyword keyword-return">return</span> datos<span class="token punctuation">.</span>size
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x1F4CC;Como se puede ver en la imagen, en el m&#xE9;todo <strong><code>onCreateViewHolder</code></strong> nos limitaremos a inflar una vista a partir del layout correspondiente a los elementos de la lista (recyclerlayout.xml), y crear y devolver un nuevo ViewHolder llamando al constructor de nuestra clase Holder pas&#xE1;ndole dicha vista como par&#xE1;metro. <strong>L&#xED;nea 6 y 8</strong>.<br>
Los dos m&#xE9;todos restantes son a&#xFA;n m&#xE1;s sencillos. En <strong><code>onBindViewHolder()</code></strong> tan s&#xF3;lo tendremos que recuperar el objeto correspondiente a la posici&#xF3;n recibida como par&#xE1;metro y llamar al m&#xE9;todo bind de nuestro Holder, pero siempre desde el objeto ViewHolder recibido como par&#xE1;metro. Por su parte, <strong><code>getItemCount()</code></strong> devolver&#xE1; el tama&#xF1;o de la lista de datos.</p>
<p>Con esto tendr&#xED;amos finalizado el adaptador, por lo que ya podr&#xED;amos asignarlo al RecyclerView en nuestra actividad principal. Lo haremos con el siguiente c&#xF3;digo</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
       <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
       <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>
       <span class="token keyword keyword-val">val</span> datos <span class="token operator">=</span> <span class="token function">anadirDatos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       <span class="token keyword keyword-val">val</span> recyclerView <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>RecyclerView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>recyclerList<span class="token punctuation">)</span>
       <span class="token keyword keyword-val">val</span> adaptador <span class="token operator">=</span> <span class="token function">Adaptador</span><span class="token punctuation">(</span>datos<span class="token punctuation">)</span>
       recyclerView<span class="token punctuation">.</span>adapter <span class="token operator">=</span> adaptador
       recyclerView<span class="token punctuation">.</span>layoutManager <span class="token operator">=</span>
           <span class="token function">LinearLayoutManager</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> LinearLayoutManager<span class="token punctuation">.</span>VERTICAL<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">anadirDatos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span> 
   <span class="token punctuation">{</span>
       <span class="token keyword keyword-var">var</span> datos <span class="token operator">=</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i <span class="token keyword keyword-in">in</span> <span class="token number">0</span><span class="token operator">..</span><span class="token number">19</span><span class="token punctuation">)</span>
           datos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Usuario</span><span class="token punctuation">(</span><span class="token string">&quot;nombre<span class="token interpolation variable">$i</span>&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;apellido1<span class="token interpolation variable">$i</span>   Apellido2<span class="token interpolation variable">$i</span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       <span class="token keyword keyword-return">return</span> datos
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x1F4CC; Instanciaremos un objeto de la clase <strong>Adatador</strong> creada por nosotros <strong>L&#xED;nea 8</strong>. Se lo a&#xF1;adiremos al recyclerView inflado en la actividad principal <strong>L&#xED;nea 9</strong> y le asociaremos un LayoutManager determinado, para obtener la forma en la que se distribuir&#xE1;n los datos en pantalla.<br>
Como ya dijimos, si nuestra intenci&#xF3;n es mostrar los datos en forma de lista o tabla (al estilo de los antiguos ListView o GridView) no tendremos que implementar nuestro propio LayoutManager. En nuestro caso particular queremos mostrar los datos en forma de lista con desplazamiento vertical <strong>L&#xED;nea 10</strong>. Para ello tenemos disponible la clase LinearLayoutManager, por lo que tan s&#xF3;lo tendremos que instanciar un objeto de dicha clase indicando en el constructor la orientaci&#xF3;n del desplazamiento (<strong><code>LinearLayoutManager.VERTICAL o LinearLayoutManager.HORIZONTAL</code></strong>) y lo asignaremos al RecyclerView mediante el m&#xE9;todo <strong><code>setLayoutManager()</code></strong>.</p>
<p>Al final conseguiremos un efecto parecido al siguiente, que muestra la lista de datos y sobre el que se puede hacer scrolling:</p>
</blockquote>
<div align="center">
   <img height="150" src="./imagenes/recycler1.png">
</div>
<h5 class="mume-header" id="gridlayoutmanager-y-staggeredgridlayoutmanager">GridLayoutManager y StaggeredGridLayoutManager</h5>

<p>Otra parte positiva de la clase RecyclerView, es que si cambi&#xE1;ramos de idea y quisi&#xE9;ramos mostrar los datos de forma tabular tan s&#xF3;lo tendr&#xED;amos que cambiar la asignaci&#xF3;n del LayoutManager anterior y utilizar un <strong><code>GridLayoutManager</code></strong>, al que pasaremos como par&#xE1;metro el n&#xFA;mero de columnas a mostrar. Si lo que queremos es mostrarla de forma tabular pero sin igualar las celdas usaremos el <strong><code>StaggeredGridLayoutManager</code></strong>, el tercer argumento dispone si tiene que dimensionar las celdas a su contenido o no.</p>
<div align="center">
    <img height="350" src="./imagenes/recycler2.png">
</div>
<h5 class="mume-header" id="itemdecoration-e-itemanimation">ItemDecoration e ItemAnimation</h5>

<p>Los <a href="https://developer.android.com/reference/androidx/recyclerview/widget/RecyclerView.ItemDecoration">ItemDecoration</a> nos servir&#xE1;n para personalizar el aspecto de un RecyclerView m&#xE1;s all&#xE1; de la distribuci&#xF3;n de los elementos en pantalla. El ejemplo t&#xED;pico de esto son los separadores o divisores de una lista. RecyclerView no tiene ninguna propiedad divider como en el caso del ListView, por lo que dicha funcionalidad debemos suplirla con un <strong><code>ItemDecoration</code></strong>.<br>
Por &#xFA;ltimo hablemos muy brevemente de <a href="https://developer.android.com/reference/androidx/recyclerview/widget/RecyclerView.ItemAnimator">ItemAnimator</a>, permitir&#xE1; definir las animaciones que mostrar&#xE1; nuestro RecyclerView al realizar las acciones m&#xE1;s comunes sobre un elemento (a&#xF1;adir, eliminar, mover, modificar). Este componente tampoco es sencillo de implementar, pero por suerte el SDK tambi&#xE9;n proporciona una implementaci&#xF3;n por defecto que puede servirnos en la mayor&#xED;a de ocasiones, aunque por supuesto podremos personalizar creando nuestro propio ItemAnimator. Esta implementaci&#xF3;n por defecto se llama DefaultItemAnimator.</p>
<div style="page-break-after:always;"></div>
<h4 class="mume-header" id="click-sobre-un-elemento-de-la-lista">Click sobre un elemento de la lista</h4>

<p>El siguiente paso que nos podemos plantear es c&#xF3;mo responder a los eventos que se produzcan sobre el RecyclerView, como opci&#xF3;n m&#xE1;s habitual el evento click sobre un elemento de la lista. Para sorpresa de todos, la clase RecyclerView no tiene incluye un evento onItemClick() como ocurre con <strong><code>ListFragment</code></strong>. Una vez m&#xE1;s, RecyclerView delegar&#xE1; tambi&#xE9;n esta tarea a otro componente, en este caso a la propia vista que conforma cada elemento de la colecci&#xF3;n, es decir al adaptador.<br>
Aprovecharemos la creaci&#xF3;n de cada nuevo ViewHolder para asignar a su vista asociada el evento onClick. Adicionalmente, para poder hacer esto desde fuera del adaptador, incluiremos el listener correspondiente como atributo del adaptador, y dentro de &#xE9;ste nos limitaremos a asignar el evento a la vista del nuevo ViewHolder y a lanzarlo cuando sea necesario desde el m&#xE9;todo onClick(). Es m&#xE1;s f&#xE1;cil verlo sobre el c&#xF3;digo:</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> Adaptador <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> datos<span class="token operator">:</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">:</span>
    RecyclerView<span class="token punctuation">.</span>Adapter<span class="token operator">&lt;</span>Holder<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>View<span class="token punctuation">.</span><span class="token function">OnClickListener</span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> listenerClick<span class="token operator">:</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">;</span>
  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreateViewHolder</span><span class="token punctuation">(</span>viewGroup<span class="token operator">:</span> ViewGroup<span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span>Holder<span class="token punctuation">{</span>
        <span class="token keyword keyword-val">val</span> itemView<span class="token operator">:</span> View <span class="token operator">=</span> LayoutInflater<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>viewGroup<span class="token punctuation">.</span>context<span class="token punctuation">)</span>
                   <span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>recyclerlayout<span class="token punctuation">,</span> viewGroup<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        itemView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> <span class="token function">Holder</span><span class="token punctuation">(</span>itemView<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span>holder<span class="token operator">:</span> Holder<span class="token punctuation">,</span> position<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword keyword-val">val</span> item<span class="token operator">:</span> Usuario <span class="token operator">=</span> datos<span class="token punctuation">[</span>position<span class="token punctuation">]</span>
      holder<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getItemCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Int <span class="token punctuation">{</span>
      <span class="token keyword keyword-return">return</span> datos<span class="token punctuation">.</span>size
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-fun">fun</span> <span class="token function">onClick</span><span class="token punctuation">(</span>listener<span class="token operator">:</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>listenerClick<span class="token operator">=</span>listener
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onClick</span><span class="token punctuation">(</span>p0<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      listenerClick<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span>p0<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; Para implementar el evento OnClick sobre un elemento de la lista, primero hacemos que el adaptador creado por nosotros herede de la interface <strong><code>OnClickListener</code></strong> <strong>L&#xED;nea 2</strong>. Para conseguir que se detecte la pulsaci&#xF3;n sobre la vista del elemento, ponemos el escuchador sobre la vista <strong>L&#xED;nea 8</strong>. Al heredar de la interface, deberemos anular el  onClick <strong>L&#xED;nea 21</strong>, en este m&#xE9;todo lanzaremos el evento onClick de una propiedad de este tipo que nos habremos declarado antes <strong>L&#xED;nea 4</strong>. Para que esta propiedad no sea nula, tendremos que crear un m&#xE9;todo al que le llegue una variable de este tipo y le sea asignada <strong>L&#xED;nea 18</strong>. Este &#xFA;ltimo m&#xE9;todo ser&#xE1; al que tendremos que llamar desde donde queramos detectar el evento. Esto lo podemos ver en el c&#xF3;digo de la <strong>MainActivity</strong>.</p>
</blockquote>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers">adaptador<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span><span class="token function">OnClickListener</span> <span class="token punctuation">{</span> v <span class="token operator">-&gt;</span>
                 Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                <span class="token keyword keyword-this">this</span><span class="token label symbol">@MainActivity</span><span class="token punctuation">,</span>
                <span class="token string">&quot;Has pulsado&quot;</span> <span class="token operator">+</span> recyclerView<span class="token punctuation">.</span><span class="token function">getChildAdapterPosition</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Toast<span class="token punctuation">.</span>LENGTH_SHORT
            <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; Con el objeto adaptador asignado al recycler podemos llamar a la funci&#xF3;n onClick y pasar un an&#xF3;nimo de tipo OnClickListener, que ser&#xE1; invocado al pulsar sobre un elemento de la lista. Con la vista que entra podemos saber que posici&#xF3;n a sido pulsada a trav&#xE9;s del m&#xE9;todo <strong><code>getChildAdapterPosition()</code></strong> de la clase RecyclerView.</p>
</blockquote>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F; Reconstruye el ejemplo y a&#xF1;ade la funcionalidad del Click largo para eliminar el elemento pulsado de la lista. Para actualizar el adaptador. una vez eliminado puedes usar, adaptador.notifyItemRemoved(posicioneliminada) junto con adaptador.notifyDataSetChanged()</span></p>
<h4 class="mume-header" id="click-en-cualquier-lugar-de-la-vista">Click en cualquier lugar de la vista</h4>

<p>Si quisi&#xE9;ramos detectar la pulsaci&#xF3;n de cualquier elemento de la l&#xED;nea del recycler, deberemos actuar sobre esa vista en el Holder (es donde podemos hacer referencia a cada uno de los view del layout). La forma de hacerlo es igual como se ha hecho anteriormente, usando un listener de la interfaz que nos haga falta y mandando la informaci&#xF3;n a trav&#xE9;s de esta.</p>
<p>Para ver el funcionamiento, primero vamos a incluir una imagen en el  layout <strong>recyclerlayout.xml</strong>, para que al pulsar sobre esa imagen se abra el dial del tel&#xE9;fono. Podr&#xED;amos a&#xF1;adir la imagen de la siguiente manera:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>androidx.cardview.widget.CardView</span><span class="token punctuation">&gt;</span></span>
  ...
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/imagen<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@android:drawable/ic_menu_call<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>androidx.cardview.widget.CardView</span><span class="token punctuation">&gt;</span></span>
</pre><p>La app ahora quedar&#xED;a con un aspecto similar al siguiente:</p>
<div align="center">  <img height="150" src="./imagenes/recycler1_2.png">
</div>
<p>Ahora a&#xF1;adiremos en el c&#xF3;digo de la clase Holder (aqu&#xED; es donde se sabe que vista se ha pulsado de entre todas las que componen la l&#xED;nea del recycler), la llamada al intel que abre el d&#xED;al:</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">,</span> context<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                          View<span class="token punctuation">.</span><span class="token function">OnClickListener</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-val">val</span> textNombre<span class="token operator">:</span> TextView
    <span class="token keyword keyword-val">val</span> textApellido<span class="token operator">:</span> TextView
    <span class="token keyword keyword-val">val</span> context<span class="token operator">:</span>Context
    <span class="token keyword keyword-val">val</span> imagen<span class="token operator">:</span>ImageView
    <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-init">init</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>context<span class="token operator">=</span>context
        textNombre <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span>
        textApellido <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView2<span class="token punctuation">)</span>
        imagen<span class="token operator">=</span>v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>imagen<span class="token punctuation">)</span>
        imagen<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onClick</span><span class="token punctuation">(</span>p0<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-val">val</span> i <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_DIAL<span class="token punctuation">)</span>
        <span class="token function">startActivity</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; En este caso, como no se quiere pasar informaci&#xF3;n desde el Holder hasta el Adaptador o la actividad principal, lo &#xFA;nico que tenemos que anular (habremos heredado de OnClickListener) es el m&#xE9;todo onClick <strong>F&#xED;la 2 y 18</strong>, donde lanzaremos el intent. Para lanzar el intent necesitaremos el contexto, por lo que se lo pasaremos mediante el constructor del Holder <strong>L&#xED;neas 1 y 12</strong>. No olvides poner el escuchador sobre la vista que te interese <strong>L&#xED;nea 16</strong>. Al constructor del adaptador tambi&#xE9;n le tendr&#xE1; que llegar, de la misma manera, el contexto de la Actividad.</p>
</blockquote>
<h4 class="mume-header" id="click-en-cualquier-lugar-de-la-vista-pasando-informaci%C3%B3n-a-la-actividad-principal">Click en cualquier lugar de la vista pasando informaci&#xF3;n a la Actividad Principal</h4>

<p>En este caso adem&#xE1;s de detectar la pulsaci&#xF3;n sobre un elemento, tendremos que devolver la informaci&#xF3;n que nos interese hacia atr&#xE1;s. Se podr&#xED;a usar un ViewModel, como ya hemos explicado y usado con anterioridad, pero vamos a utilizar una Interface para recordar el sistema.</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">,</span> context<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                          View<span class="token punctuation">.</span><span class="token function">OnClickListener</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-val">val</span> textNombre<span class="token operator">:</span> TextView
    <span class="token keyword keyword-val">val</span> textApellido<span class="token operator">:</span> TextView
    <span class="token keyword keyword-val">val</span> context<span class="token operator">:</span> Context
    <span class="token keyword keyword-val">val</span> imagen<span class="token operator">:</span> ImageView
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> pasarCadenaInterface<span class="token operator">:</span> PasarCadenaInterface
    <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-init">init</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> context
        textNombre <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span>
        textApellido <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView2<span class="token punctuation">)</span>
        imagen <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>imagen<span class="token punctuation">)</span>
        imagen<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onClick</span><span class="token punctuation">(</span>p0<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-var">var</span> cadena<span class="token operator">:</span>String
        <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>p0<span class="token operator">?</span><span class="token punctuation">.</span>id<span class="token operator">==</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>imagen<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword keyword-val">val</span> i <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_DIAL<span class="token punctuation">)</span>
            <span class="token function">startActivity</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
            cadena<span class="token operator">=</span><span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>p0<span class="token operator">?</span><span class="token punctuation">.</span>id<span class="token operator">==</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span> cadena<span class="token operator">=</span>textNombre<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-else">else</span> cadena<span class="token operator">=</span>textApellido<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        pasarCadenaInterface<span class="token punctuation">.</span><span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>pasarCadenaInterface<span class="token operator">:</span> PasarCadenaInterface<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>pasarCadenaInterface<span class="token operator">=</span>pasarCadenaInterface
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; <strong>L&#xED;nea 7</strong> creamos un objeto del tipo de Interface creada, en este caso ser&#xED;a as&#xED;:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-interface">interface</span> PasarCadenaInterface<span class="token punctuation">{</span>
   <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token operator">:</span>String<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre><p><strong>L&#xED;nea 18 y 19</strong> ponemos escuchadores del evento Click sobre las vistas que necesitemos. Al anular el OnClick, llamamos al m&#xE9;todo de la interface con el texto que deseamos <strong>L&#xED;nea 31</strong>. Para que la interface no sea nula, seguimos la estrategia que ya conocemos del anterior punto, creamos un m&#xE9;todo al que le llega la interface <strong>L&#xED;nea 35</strong>.</p>
</blockquote>
<p>En el <strong>Adaptador</strong> tendremos que hacer los siguientes cambios:</p>
<pre data-role="codeBlock" data-info="kotlin {class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> Adaptador <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> datos<span class="token operator">:</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span> <span class="token punctuation">,</span> <span class="token keyword keyword-val">val</span> context<span class="token operator">:</span> Context <span class="token punctuation">)</span> <span class="token operator">:</span>
    RecyclerView<span class="token punctuation">.</span>Adapter<span class="token operator">&lt;</span>Holder<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">,</span> 
    View<span class="token punctuation">.</span><span class="token function">OnLongClickListener</span><span class="token punctuation">{</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> pasarCadenaInterface<span class="token operator">:</span> PasarCadenaInterface
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreateViewHolder</span><span class="token punctuation">(</span>viewGroup<span class="token operator">:</span> ViewGroup<span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span>Holder<span class="token punctuation">{</span>
        <span class="token operator">..</span><span class="token punctuation">.</span>
        <span class="token keyword keyword-val">val</span> holder<span class="token operator">=</span><span class="token function">Holder</span><span class="token punctuation">(</span>itemView<span class="token punctuation">,</span>context<span class="token punctuation">)</span>
        holder<span class="token punctuation">.</span><span class="token function">pasarCadena</span><span class="token punctuation">(</span><span class="token keyword keyword-object">object</span> <span class="token operator">:</span>PasarCadenaInterface<span class="token punctuation">{</span>
            <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                pasarCadenaInterface<span class="token punctuation">.</span><span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> holder
    <span class="token punctuation">}</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>pasarCadenaInterface<span class="token operator">:</span> PasarCadenaInterface<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>pasarCadenaInterface<span class="token operator">=</span>pasarCadenaInterface
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; Creamos la propiedad de tipo PasarCadenaInterface <strong>L&#xED;nea5</strong>. con el <strong>holder</strong> llamamos al m&#xE9;todo creado para pasar la instancia al holder. Cuando esta se ejecute, nos llegar&#xE1; la cadena y llamaremos a su vez al m&#xE9;todo para que de esa forma lleguen los datos a la MainActivity <strong>L&#xED;nea10</strong>. No olvidar el m&#xE9;todo al que nos llega la interface para que no sea nula <strong>L&#xED;na17</strong>. En la <strong>Main</strong> tendremos que llamar a este &#xFA;ltimo m&#xE9;todo de la misma forma que en el adaptador.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">adaptador<span class="token punctuation">.</span><span class="token function">pasarCadena</span><span class="token punctuation">(</span><span class="token keyword keyword-object">object</span> <span class="token operator">:</span> PasarCadenaInterface <span class="token punctuation">{</span>
          <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">pasarCadena</span><span class="token punctuation">(</span>cadena<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                  applicationContext<span class="token punctuation">,</span>
                  <span class="token string">&quot;Has pulsado &quot;</span> <span class="token operator">+</span>cadena<span class="token punctuation">,</span>
                  Toast<span class="token punctuation">.</span>LENGTH_SHORT <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre></blockquote>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F; Reconstruye los ejemplos y comprueba su funcionamiento, con control de Click en la imagen y en los dos textos nombre y apellido. En estos &#xFA;ltimos que llegue la informaci&#xF3;n a la Main y que se muestre con un Toast</span></p>
<div style="page-break-after:always;"></div>
<h4 class="mume-header" id="otros-efectos-sobre-el-recycler">Otros efectos sobre el Recycler</h4>

<h5 class="mume-header" id="cambiar-el-color-de-las-l%C3%ADneas">Cambiar el color de las l&#xED;neas</h5>

<p>Actuando sobre el Holder podemos conseguir otro tipo de efectos, como por ejemplo cambiar el color de las l&#xED;neas pares y de las impares de la lista.</p>
<div align="center">
    <img height="200" src="./imagenes/recycler3.png">
</div>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">,</span> context<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token operator">..</span><span class="token punctuation">.</span>

    <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">,</span> pos<span class="token operator">:</span>Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>pos <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            v<span class="token punctuation">.</span>findViewById<span class="token operator">&lt;</span>MaterialCardView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>cardView<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setCardBackgroundColor</span><span class="token punctuation">(</span>ContextCompat<span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>oscuro<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>pos <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> v<span class="token punctuation">.</span>findViewById<span class="token operator">&lt;</span>MaterialCardView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>cardView<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setCardBackgroundColor</span><span class="token punctuation">(</span>ContextCompat<span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>claro<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><blockquote>
<p>&#x1F4CC; Para conseguir ese efecto solo se ha tenido que controlar que posici&#xF3;n se est&#xE1; cargando y dependiendo de si es par o no, se colorea de un color u otro la vista del CardView <strong>L&#xED;nea de 7 a 11</strong>. Al constructor le hemos tenido que pasar el contexto para poder usar el m&#xE9;todo getColor y al m&#xE9;todo <strong>bind</strong> le hemos pasado la posici&#xF3;n del elemento que se carga <strong>L&#xED;nea 4</strong>.</p>
</blockquote>
<div style="page-break-after:always;"></div>
<h5 class="mume-header" id="hacer-visible-alg%C3%BAn-elemento">Hacer visible alg&#xFA;n elemento</h5>

<p>Por otro lado podr&#xED;amos conseguir el efecto de a&#xF1;adir alg&#xFA;n elemento si se cumple determinada condici&#xF3;n por ejemplo, en este caso lo que hacemos es mostrar una imagen, que en principio est&#xE1; oculta en el layout de la l&#xED;nea del recycler, en el caso de que el nombre contenga un 3. El c&#xF3;digo tambi&#xE9;n tendr&#xED;a que ir en el bind del Holder.</p>
<div align="center">
    <img height="200" src="./imagenes/recycler4.png">
</div>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> <span class="token function">Holder</span><span class="token punctuation">(</span>v<span class="token operator">:</span> View<span class="token punctuation">,</span> context<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">:</span> RecyclerView<span class="token punctuation">.</span><span class="token function">ViewHolder</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token operator">..</span><span class="token punctuation">.</span>

    <span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">,</span> pos<span class="token operator">:</span>Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">true</span><span class="token punctuation">)</span>
            imagen<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span> 
        <span class="token keyword keyword-else">else</span> imagen<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>INVISIBLE<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><h5 class="mume-header" id="detectar-swipe-izqder-sobre-un-elemento-del-recycler">Detectar swipe izq/der sobre un elemento del recycler</h5>

<p>Una opci&#xF3;n muy utilizada en las listas, es la de controlar el deslizamiento a la izquierda o hacia la derecha sobre uno de sus elementos. Para ello tendremos que usar una clase que ya est&#xE1; definida y que tendremos que copiar en nuestro proyecto, llamada <strong><code>SwipeDetector</code></strong> (se pasa en los recursos). En el Adaptador tendr&#xED;amos que implementar la interfaz onTouch, para que nos detecte el desplazamiento, esto lo haremos como lo hicimos en puntos anteriores. <strong>L&#xED;neas marcadas en el Adaptador</strong>.</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> Adaptador <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> datos<span class="token operator">:</span> ArrayList<span class="token operator">&lt;</span>Usuario<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">:</span>
    RecyclerView<span class="token punctuation">.</span>Adapter<span class="token operator">&lt;</span>Holder<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">,</span>
    View<span class="token punctuation">.</span>OnLongClickListener<span class="token punctuation">,</span> View<span class="token punctuation">.</span><span class="token function">OnTouchListener</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> listenerClick<span class="token operator">:</span>View<span class="token punctuation">.</span>OnClickListener<span class="token punctuation">;</span>
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> listenerLong<span class="token operator">:</span>View<span class="token punctuation">.</span>OnLongClickListener
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> listenerOnTouch<span class="token operator">:</span>View<span class="token punctuation">.</span>OnTouchListener
   
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreateViewHolder</span><span class="token punctuation">(</span>viewGroup<span class="token operator">:</span> ViewGroup<span class="token punctuation">,</span> i<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Holder <span class="token punctuation">{</span>
        <span class="token keyword keyword-val">val</span> itemView<span class="token operator">:</span> View <span class="token operator">=</span> LayoutInflater<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>viewGroup<span class="token punctuation">.</span>context<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>recyclerlayout<span class="token punctuation">,</span> viewGroup<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        itemView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        itemView<span class="token punctuation">.</span><span class="token function">setOnLongClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        itemView<span class="token punctuation">.</span><span class="token function">setOnTouchListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-val">val</span> holder<span class="token operator">=</span><span class="token function">Holder</span><span class="token punctuation">(</span>itemView<span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> holder
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-fun">fun</span> <span class="token function">onTouch</span><span class="token punctuation">(</span>listenerOnTouch<span class="token operator">:</span>View<span class="token punctuation">.</span>OnTouchListener<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>listenerOnTouch<span class="token operator">=</span>listenerOnTouch
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onTouch</span><span class="token punctuation">(</span>p0<span class="token operator">:</span> View<span class="token operator">?</span><span class="token punctuation">,</span> p1<span class="token operator">:</span> MotionEvent<span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token punctuation">{</span>
        listenerOnTouch<span class="token punctuation">.</span><span class="token function">onTouch</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span>p1<span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span>  <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>En la ActivityMain, tendremos que llamar al m&#xE9;todo <strong><code>OnTouch</code></strong> del adaptador pas&#xE1;ndole un objeto de la clase <strong><code>SwipeDetector</code></strong> <strong>L&#xED;nea 2</strong>, pero a la hora de detectar el movimiento tendremos que usar la interfaz onClikListener <strong>L&#xED;nea 3</strong>, como vemos en el c&#xF3;digo siguiente. Si nos fijamos, podremos ver que el objeto swipeDetector detectar si el movimiento se ha producido a la derecha o a la izquierda.</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-val">val</span> swipeDetector <span class="token operator">=</span> <span class="token function">SwipeDetector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
adaptador<span class="token punctuation">.</span><span class="token function">onTouch</span><span class="token punctuation">(</span>swipeDetector<span class="token punctuation">)</span>
adaptador<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span><span class="token function">OnClickListener</span> <span class="token punctuation">{</span> v <span class="token operator">-&gt;</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>swipeDetector<span class="token punctuation">.</span><span class="token function">swipeDetected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>swipeDetector<span class="token punctuation">.</span>action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    SwipeDetector<span class="token punctuation">.</span>Action<span class="token punctuation">.</span>LR <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                            applicationContext<span class="token punctuation">,</span>
                            <span class="token string">&quot;Has pulsado Izquierda&quot;</span><span class="token punctuation">,</span>
                            Toast<span class="token punctuation">.</span>LENGTH_SHORT
                        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                    SwipeDetector<span class="token punctuation">.</span>Action<span class="token punctuation">.</span>RL <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                            applicationContext<span class="token punctuation">,</span>
                            <span class="token string">&quot;Has pulsado Derecha&quot;</span><span class="token punctuation">,</span>
                            Toast<span class="token punctuation">.</span>LENGTH_SHORT
                        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span>
                Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                    applicationContext<span class="token punctuation">,</span>
                    <span class="token string">&quot;Has pulsado&quot;</span> <span class="token operator">+</span> recyclerView<span class="token punctuation">.</span><span class="token function">getChildAdapterPosition</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    Toast<span class="token punctuation">.</span>LENGTH_SHORT
                <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><h4 class="mume-header" id="selecci%C3%B3n-multiple-en-el-recycler">Selecci&#xF3;n Multiple en el Recycler</h4>

<p>Android aporta la biblioteca de <strong><code>recyclerview-selection</code></strong> para <a href="https://developer.android.com/guide/topics/ui/layout/recyclerview-custom?hl=es-419#select">seleccionar m&#xE1;s de un elemento de una lista</a>, creada con un recycler. Es decir la acci&#xF3;n que ocurre en la mayor&#xED;a de listas, cuando realizamos un click largo y despu&#xE9;s nos deja seleccionar elementos. Para poder implementar esta selecci&#xF3;n, tendremos que tener creado un RecyclerView en perfecto funcionamiento, a partir de aqu&#xED; deberemos de seguir una serie de pasos:</p>
<ol>
<li>
<p>Implementar <strong>ItemDetailsLookup</strong>. Este elemento permite que la biblioteca de selecci&#xF3;n acceda a la informaci&#xF3;n sobre los elementos de RecyclerView a los que se otorga un <strong><code>MotionEvent</code></strong> (alguna acci&#xF3;n de movimiento: pulsaci&#xF3;n, arrastre, etc.). Para construirlo necesitar&#xE1; la informaci&#xF3;n del elemento pulsado, que se puede extraer del <strong><code>Holder</code></strong>. Para ello lo primero que haremos ser&#xE1; crear en el   <strong>Holder.Kt</strong>, un m&#xE9;todo al que se pueda llamar para identificar de forma exclusiva el elemento de la lista pulsado. Este m&#xE9;todo tiene que devolver una instancia de la clase <strong><code>ItemDetailsLookup.ItemDetails</code></strong>.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-fun">fun</span> <span class="token function">getItemDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ItemDetailsLookup<span class="token punctuation">.</span>ItemDetails<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span> <span class="token operator">=</span>
        <span class="token keyword keyword-object">object</span><span class="token operator">:</span> ItemDetailsLookup<span class="token punctuation">.</span>ItemDetails<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Int<span class="token operator">=</span>adapterPosition
            <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getSelectionKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Long<span class="token operator">?</span> <span class="token operator">=</span>itemId
        <span class="token punctuation">}</span>
</pre><p>Y sobreescribir los dos m&#xE9;todos de la clase abstracta para identificar de forma &#xFA;nica el elemento sobre el que se ha realizado la acci&#xF3;n. Para ello podemos usar las propiedades <strong><code>adapterPosition</code></strong> e <strong><code>itemId</code></strong>, que posee la clase <strong><code>ViewHolder</code></strong>.</p>
<p>Como se puede ver en el c&#xF3;digo, hemos hecho de tipo <strong><code>Long</code></strong> la clase gen&#xE9;rica <strong><code>ItemDetails</code></strong>. El long determina el tipo de clave de selecci&#xF3;n que usaremos. Hay tres tipos de claves que se pueden usar para identificar elementos seleccionados: <em>Parcelable, String y Long</em>. Ahora pasaremos a implementar la clase, por ejemplo <strong>LookUp.kt</strong>, que herede de <strong><code>ItemDetailsLookup</code></strong> del tipo de la clave seleccionada. En el m&#xE9;todo que anulamos, se captura la vista seleccionada y con ella accedemos al m&#xE9;todo creado con anterioridad en el Holder.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-class">class</span> <span class="token function">LookUp</span> <span class="token punctuation">(</span><span class="token keyword keyword-private">private</span> <span class="token keyword keyword-val">val</span> rv<span class="token operator">:</span> RecyclerView<span class="token punctuation">)</span>
<span class="token operator">:</span> ItemDetailsLookup<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getItemDetails</span><span class="token punctuation">(</span>event<span class="token operator">:</span> MotionEvent<span class="token punctuation">)</span>
        <span class="token operator">:</span> ItemDetails<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token operator">?</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-val">val</span> view <span class="token operator">=</span> rv<span class="token punctuation">.</span><span class="token function">findChildViewUnder</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>x<span class="token punctuation">,</span> event<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>view <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>rv<span class="token punctuation">.</span><span class="token function">getChildViewHolder</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> Holder<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getItemDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre></li>
<li>
<p>Actualiza las Views de los elementos de RecyclerView para que refleje si el usuario realiz&#xF3; o no una selecci&#xF3;n. Estos cambios se pueden hacer en el Holder, como hemos visto anteriormente, aunque en este caso tendremos que tener en cuenta si el elemento ha sido seleccionado. Para ello usamos un tipo <strong><code>SelectionTracker</code></strong> que pasaremos como argumento desde el Adaptador. Se aconseja que se muestre los elementos seleccionados mediante un cambio de color.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-fun">fun</span> <span class="token function">bind</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> Usuario<span class="token punctuation">,</span> tracker<span class="token operator">:</span> SelectionTracker<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textNombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
        textApellido<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>apellidos<span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>tracker<span class="token operator">!!</span><span class="token punctuation">.</span><span class="token function">isSelected</span><span class="token punctuation">(</span>adapterPosition<span class="token punctuation">.</span><span class="token function">toLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            cardView<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token function">ColorDrawable</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>CYAN<span class="token punctuation">)</span>
        <span class="token keyword keyword-else">else</span> cardView<span class="token punctuation">.</span>background<span class="token operator">=</span> <span class="token function">ColorDrawable</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>LTGRAY<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</pre></li>
<li>
<p>Unir los anteriores pasos mediante un objeto de tipo <strong><code>SelectionTracker.Builder</code></strong> <strong>L&#xED;nea 6 a 14</strong>, creado en la actividad principal y pasado al adaptador, que a su vez lo mandar&#xE1; al Holder. Este elemento inicializa el rastreador de selecci&#xF3;n. A su constructor se le pasa: el ID de selecci&#xF3;n (una cadena &#xFA;nica), la instancia del RecyclerView, el proveedor de claves (se puede elegir entre varios de la BCL), la clase creada en el paso uno para el control del elemento pulsado y la estrategia de almacenamiento en este caso de tipo Long como la clave (esta instancia permite asegurar que no se pierden los elementos seleccionados en los cambios de estado del dispositivo).</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers">recyclerView<span class="token punctuation">.</span><span class="token function">setHasFixedSize</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword keyword-val">val</span> adaptador <span class="token operator">=</span> <span class="token function">Adaptador</span><span class="token punctuation">(</span>datos<span class="token punctuation">,</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
adaptador<span class="token punctuation">.</span><span class="token function">setHasStableIds</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">//Antes de asignar </span>
                            <span class="token comment">//el adaptador al recycler</span>
recyclerView<span class="token punctuation">.</span>adapter <span class="token operator">=</span> adaptador
tracker <span class="token operator">=</span> SelectionTracker<span class="token punctuation">.</span>Builder<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token punctuation">(</span>
            <span class="token string">&quot;selecccion&quot;</span><span class="token punctuation">,</span>
            recyclerView<span class="token punctuation">,</span>
            <span class="token function">StableIdKeyProvider</span><span class="token punctuation">(</span>recyclerView<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">LookUp</span><span class="token punctuation">(</span>recyclerView<span class="token punctuation">)</span><span class="token punctuation">,</span>
            StorageStrategy<span class="token punctuation">.</span><span class="token function">createLongStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withSelectionPredicate</span><span class="token punctuation">(</span>
            SelectionPredicates<span class="token punctuation">.</span><span class="token function">createSelectAnything</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
adaptador<span class="token punctuation">.</span><span class="token function">setTracker</span><span class="token punctuation">(</span>tracker<span class="token punctuation">)</span> <span class="token comment">//m&#xE9;todo que crearemos en el adaptador</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>Adem&#xE1;s se deber&#xE1; fijar el tama&#xF1;o del recycler <strong>L&#xED;nea 1</strong>,  asignar al adaptador la propiedad de HasStableIds a true <strong>L&#xED;nea 3</strong>. y pasar la instancia de Tracker al adaptador mediante un m&#xE9;todo que crearemos en este <strong>l&#xED;nea 15</strong>.</p>
<blockquote>
<p>&#x270B; No deberemos olvidar que el adaptador debe proporcionar unos identificadores estables, una manera sencilla de hacerlo es anulando su m&#xE9;todo <strong><code>getItemId</code></strong> (asigna la posici&#xF3;n del elemento como id):</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">  <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">getItemId</span><span class="token punctuation">(</span>position<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Long <span class="token punctuation">{</span>
   <span class="token keyword keyword-return">return</span> position<span class="token punctuation">.</span><span class="token function">toLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre></blockquote>
<p>Para controlar con m&#xE1;s seguridad la estabilidad de la app, se deber&#xED;a de anular el m&#xE9;todo <strong><code>onSaveInstanceState</code></strong> para pasar la informaci&#xF3;n capturada, a la instancia del <strong><code>tracker</code></strong>.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token operator">:</span> Bundle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token punctuation">)</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>outState <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
        tracker<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre><p>y al iniciar la aplicaci&#xF3;n a&#xF1;adir la siguiente l&#xED;nea para recuperar el tracker guardado:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>savedInstanceState <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
            tracker<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">onRestoreInstanceState</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
</pre><p>Por su parte en el adaptador solo tendremos estos dos cambios.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span>holder<span class="token operator">:</span> Holder<span class="token punctuation">,</span> position<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-val">val</span> item<span class="token operator">:</span> Usuario <span class="token operator">=</span> datos<span class="token punctuation">[</span>position<span class="token punctuation">]</span>
    holder<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>tracker<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword keyword-fun">fun</span> <span class="token function">setTracker</span><span class="token punctuation">(</span>tracker<span class="token operator">:</span> SelectionTracker<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>tracker <span class="token operator">=</span> tracker
<span class="token punctuation">}</span>
</pre><p>Despu&#xE9;s de realizar estos pasos, podemos probar el funcionamiento de la aplicaci&#xF3;n.</p>
</li>
</ol>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F;Reconstruye el ejemplo y prueba el funcionamiento</span></p>
<ol start="4">
<li>
<p>Solo nos queda controlar la pulsaci&#xF3;n y realizar alguna cosa cuando esto ocurra. Tendremos que a&#xF1;adir un observador al Tracker y para ello se utiliza un objeto <strong><code>SelectionTracker.SelectionObserver</code></strong>, que se encarga de registrar los cambios. Dentro de este objeto pondremos el c&#xF3;digo que creamos conveniente, en este caso solamente mostramos un Toast con el id de los elementos que est&#xE1;n en la selecci&#xF3;n.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">tracker<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>
            <span class="token keyword keyword-object">object</span><span class="token operator">:</span> SelectionTracker<span class="token punctuation">.</span>SelectionObserver<span class="token operator">&lt;</span>Long<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onSelectionChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>tracker<span class="token operator">!!</span><span class="token punctuation">.</span><span class="token function">hasSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword keyword-var">var</span> cadena<span class="token operator">=</span><span class="token function">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        tracker<span class="token operator">?</span><span class="token punctuation">.</span>selection<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">forEach</span> <span class="token punctuation">{</span> id<span class="token operator">-&gt;</span>
                                  cadena<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>id<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
                        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token label symbol">@MainActivity</span><span class="token punctuation">,</span>cadena<span class="token punctuation">,</span> 
                                           Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre><blockquote>
<p>&#x26A0;&#xFE0F; El comportamiento esperado cuando se hace una selecci&#xF3;n multiple, es el de que se superponga una toolbar sobre la ActionBar con un men&#xFA; espec&#xED;fico para las acciones que puedan ocurrir sobre la selecci&#xF3;n. Para ello se deber&#xE1; implementar la clase <strong>ActionMode</strong> que ser&#xE1; activada cuando el observador detecte que tiene selecci&#xF3;n. Esta implementaci&#xF3;n se ver&#xE1; en el tema de men&#xFA;s</p>
</blockquote>
</li>
</ol>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>