<!DOCTYPE html><html><head>
      <title>PMDM 2&#xBA; DAM  Tema 3. Componentes de una aplicaci&#xF3;n Android</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <style>/* 
Añade 

@import "../EstilosPersonalizadosMarkdownEnhanced.less"

justo después del front matter 
*/
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v8/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
</style>
<h1 class="mume-header undefined" id="apuntes">Apuntes</h1>

<p><a href="./tema3_componentes_aplicacion.pdf">Descargar estos apuntes</a></p>
<h1 class="mume-header undefined" id="tema-3-componentes-de-una-aplicaci%C3%B3n-android">Tema 3 . Componentes de una aplicaci&#xF3;n Android</h1>

<h2 class="mume-header undefined" id="%C3%ADndice">&#xCD;ndice</h2>

<ol>
<li><a href="#introducci%C3%B3n">Introducci&#xF3;n</a></li>
<li><a href="#contexto-de-una-aplicaci%C3%B3n">Contexto de una aplicaci&#xF3;n</a></li>
<li><a href="#componentes-de-una-aplicaci%C3%B3n">Componentes de una aplicaci&#xF3;n</a>
<ol>
<li><a href="#activity">Activity</a></li>
<li><a href="#services">Services</a></li>
<li><a href="#view">View</a></li>
<li><a href="#fragment">Fragment</a></li>
<li><a href="#widget">Widget</a></li>
<li><a href="#content-provider">Content provider</a></li>
<li><a href="#intents">Intents</a></li>
<li><a href="#broadcast-receiver">Broadcast receiver</a></li>
</ol>
</li>
<li><a href="#ciclo-de-vida-de-una-activity">Ciclo de vida de una Activity</a></li>
<li><a href="#comunicaci%C3%B3n-de-activitys-a-trav%C3%A9s-de-intents">Comunicaci&#xF3;n de Activitys a trav&#xE9;s de Intents</a>
<ol>
<li><a href="#requerir-permisos-al-usuario">Requerir permisos al usuario</a></li>
</ol>
</li>
<li><a href="#intent-filter">Intent-filter</a></li>
<li><a href="#trabajando-con-parcelables">Trabajando con Parcelables</a></li>
</ol>
<div style="page-break-after:always;"></div>
<h3 class="mume-header" id="introducci%C3%B3n">Introducci&#xF3;n</h3>

<p>En este tema estudiaremos los <a href="https://developer.android.com/guide/components/fundamentals?hl=es-419">componentes de una aplicaci&#xF3;n Android</a> y sus respectivas funciones, adem&#xE1;s de la comunicaci&#xF3;n entre activitis.<br>
Para cualquier aplicaci&#xF3;n Android, en general, ser&#xE1; necesario construir una ventana en la que se ir&#xE1;n a&#xF1;adiendo componentes, cada componente es un punto de entrada por el que el sistema o un usuario interact&#xFA;a con tu aplicaci&#xF3;n. Algunos componentes dependen de otros.<br>
Lo primero que haremos ser&#xE1; comprender que es el contexto de una aplicaci&#xF3;n y como permite relacionar los componentes.<br>
Luego veremos el concepto de <strong>Actividades, Intents, Servicios, BroadCast Receivers y Content Providers</strong>.</p>
<h3 class="mume-header" id="contexto-de-una-aplicaci%C3%B3n">Contexto de una aplicaci&#xF3;n</h3>

<p>El contexto de una aplicaci&#xF3;n es una interfaz entre la aplicaci&#xF3;n y el sistema operativo, la cual describe la informaci&#xF3;n que representa tu aplicaci&#xF3;n dentro del ambiente del sistema operativo.<br>
Tambi&#xE9;n permite acceder a los recursos de la aplicaci&#xF3;n y coordinar el funcionamiento de los bloques de la aplicaci&#xF3;n.<br>
El contexto representa toda la meta-informaci&#xF3;n sobre las relaciones que tiene la aplicaci&#xF3;n con otras aplicaciones o el sistema y podemos implementarlo a trav&#xE9;s de la <strong>clase abstracta Context</strong>.<br>
En Android nos encontramos con los siguientes tipos de contextos:</p>
<ul>
<li>
<p><strong>Aplicaci&#xF3;n</strong>. Este contexto engloba a todos los dem&#xE1;s, y cubre todo el ciclo de vida de la aplicaci&#xF3;n desde que la arrancamos hasta que muere. Por lo que cada aplicaci&#xF3;n tiene <em><strong>un &#xFA;nico contexto de aplicaci&#xF3;n</strong></em>. El Context de la aplicaci&#xF3;n vive hasta que se termina por completo la aplicaci&#xF3;n (hasta que muere, no hasta que se pausa)<br>
Se puede acceder desde una <em><strong>Activity</strong></em> o un <em><strong>Service</strong></em> con <strong><code>application</code></strong> o desde cualquiera que herede de Context con <strong><code>applicationContext</code></strong>.</p>
</li>
<li>
<p><strong>Activity o Service</strong>. Como hemos dicho, un Context vive tanto como el elemento al que pertenece, por lo que depende del ciclo de vida. As&#xED;, un Context de una Activity vivir&#xE1; el mismo tiempo que viva la activity y siempre ser&#xE1; un tiempo menor que el de la Aplicaci&#xF3;n.</p>
</li>
</ul>
<div style="page-break-after:always;"></div>
<h3 class="mume-header" id="componentes-de-una-aplicaci%C3%B3n">Componentes de una aplicaci&#xF3;n</h3>

<h4 class="mume-header" id="activity">Activity</h4>

<p>Las Activitys son los componentes visibles de la aplicaci&#xF3;n, tienen una interface de usuario que permite interactuar con ellas.<br>
La mayor&#xED;a de las aplicaciones permiten la ejecuci&#xF3;n de varias acciones a trav&#xE9;s de la existencia de una o m&#xE1;s pantallas. Por ejemplo:  <em>una aplicaci&#xF3;n de mensajes de texto podr&#xE1; tener la lista de contactos que se muestra en una ventana, mediante el despliegue de una segunda ventana el usuario puede escribir el mensaje al contacto elegido, y en otra tercera puede repasar su historial de mensajes enviados o recibidos</em>.<br>
Cada una de estas ventanas puede estar representada a trav&#xE9;s de un componente Activity, de forma que navegar de una ventana a otra implica lanzar una actividad o dormir otra.</p>
<h4 class="mume-header" id="services">Services</h4>

<p>Un servicio es una entidad que <strong>ejecuta instrucciones en segundo plano</strong> sin que el usuario lo note en la interfaz. Son muy utilizados para realizar acciones de larga duraci&#xF3;n mientras las actividades muestran otro tipo de informaci&#xF3;n. Por ejemplo guardar la informaci&#xF3;n en la base de datos, escuchar m&#xFA;sica mientras se ejecuta la aplicaci&#xF3;n, administrar conexiones de red, etc.<br>
Los servicios tambi&#xE9;n tienen un ciclo de vida como las actividades, pero este es m&#xE1;s corto. Solo se comprende de los estados de Creaci&#xF3;n, Ejecuci&#xF3;n y Destrucci&#xF3;n.</p>
<h4 class="mume-header" id="view">View</h4>

<p>Las vistas (view) son los componentes b&#xE1;sicos con los que se construye la interfaz gr&#xE1;fica de la aplicaci&#xF3;n, an&#xE1;logo por ejemplo a los controles de Java o .NET. De inicio, Android pone a nuestra disposici&#xF3;n una gran cantidad de controles b&#xE1;sicos, como cuadros de texto, botones, listas desplegables o im&#xE1;genes, aunque tambi&#xE9;n existe la posibilidad de extender la funcionalidad de estos controles b&#xE1;sicos o crear nuestros propios controles personalizados.</p>
<h4 class="mume-header" id="fragment">Fragment</h4>

<p>Los fragmentos (fragment) se pueden entender como secciones o partes (habitualmente reutilizables) de la interfaz de usuario de una aplicaci&#xF3;n. De esta forma, una actividad podr&#xED;a contener varios fragmentos para formar la interfaz completa de la aplicaci&#xF3;n, y adicionalmente estos fragmentos se podr&#xED;an reutilizar en distintas actividades o partes de la aplicaci&#xF3;n.</p>
<div style="page-break-after:always;"></div>
<h4 class="mume-header" id="widget">Widget</h4>

<p>Los widgets son elementos visuales, normalmente interactivos, que pueden mostrarse en la pantalla principal del dispositivo Android y recibir actualizaciones peri&#xF3;dicas. Permiten mostrar informaci&#xF3;n de la aplicaci&#xF3;n al usuario directamente sobre la pantalla principal.</p>
<h4 class="mume-header" id="content-provider">Content provider</h4>

<p>Con el componente <strong>Content Provider</strong>, cualquier aplicaci&#xF3;n en Android puede almacenar datos en un fichero, en una base de datos SQLite o en cualquier otro formato que considere.<br>
Adem&#xE1;s, estos <strong>datos pueden ser compartidos entre distintas aplicaciones</strong>. Una clase que implemente el componente Content Provider contendr&#xE1; una serie de m&#xE9;todos que permite almacenar, recuperar, actualizar y compartir los datos de una aplicaci&#xF3;n.<br>
Por defecto, el API de Android trae consigo Content Providers predefinidos para intercambiar informaci&#xF3;n de audio, v&#xED;deo, im&#xE1;genes, e informaci&#xF3;n personal. Pero si en alg&#xFA;n momento deseas intercambiar informaci&#xF3;n con una estructura personalizada debes crear tu propia subclase heredada de la clase ContentProvider.</p>
<h4 class="mume-header" id="intents">Intents</h4>

<p>Un Intent <strong>es un objeto de mensajer&#xED;a</strong> que puedes usar para solicitar una acci&#xF3;n de otro componente de una app. Los intents facilitan la comunicaci&#xF3;n entre componentes de varias formas, desde la comunicaci&#xF3;n entre actividades, entre fragments, servicios, etc. En un punto posterior de este tema se explicar&#xE1;n m&#xE1;s extensamente.</p>
<h4 class="mume-header" id="broadcast-receiver">Broadcast receiver</h4>

<p>Finalmente, el &#xFA;ltimo componente clave son los <strong>Broadcast Receives</strong>, o receptores de emisi&#xF3;n, que <strong>reaccionan a intents espec&#xED;ficos pudiendo a su vez ejecutar una acci&#xF3;n</strong> o iniciando una activity o pueden devolver otro intent al sistema para que siga la ejecuci&#xF3;n. Realmente este tipo de componentes son capaces de procesar los mensajes del sistema operativo.</p>
<h3 class="mume-header" id="ciclo-de-vida-de-una-activity">Ciclo de vida de una Activity</h3>

<p>Como hemos comentado en el punto anterior. La activity es uno de los componentes esenciales de una aplicaci&#xF3;n Android, adem&#xE1;s que es el componente que tiene asociada la interfaz de usuario. Una misma aplicaci&#xF3;n puede tener una o varias actividades y Android permite controlar por completo el <a href="https://developer.android.com/guide/components/activities/activity-lifecycle?hl=es">ciclo de vida</a> de cada una de estas.<br>
Los estados por los cuales puede pasar una Activity son los siguientes: <strong>Creaci&#xF3;n, Ejecuci&#xF3;n, Reanudaci&#xF3;n, Pausa, Parada y Destrucci&#xF3;n</strong>.</p>
<p>A la relaci&#xF3;n entre ellos se le llama <strong>Ciclo de vida de una Actividad</strong>.</p>
<div align="center">
    <img height="350" src="./imagenes/ciclo_vida.png">
</div>
<p>El ciclo de vida de una Activity nos describe los estados y las transiciones entre estados que una determinada Activity, como hemos comentado son:</p>
<ul>
<li>Creaci&#xF3;n: una actividad se ha creado cuando su estructura se encuentra en memoria, pero esta no es visible aun. Cuando el usuario presiona sobre el icono de la aplicaci&#xF3;n en su dispositivo, el m&#xE9;todo <strong><code>onCreate()</code></strong> es ejecutado inmediatamente para cargar el layout de la actividad principal en memoria.</li>
<li>Ejecuci&#xF3;n-Reanudaci&#xF3;n: despu&#xE9;s de haber sido cargada la actividad se ejecutan en secuencia  el m&#xE9;todo <strong><code>onStart() y onResume()</code></strong>. Aunque <strong><code>onStart()</code></strong> hace visible la actividad, es <strong><code>onResume()</code></strong> quien le transfiere el foco para que interact&#xFA;e con el usuario.</li>
<li>Pausa: una actividad est&#xE1; en pausa cuando se encuentra en la pantalla parcialmente visible. Un ejemplo: <em>cuando se abren di&#xE1;logos que toman el foco superponi&#xE9;ndose a la actividad</em>. El m&#xE9;todo llamado para la transici&#xF3;n hacia la pausa es <strong><code>onPause()</code></strong>.</li>
<li>Detenci&#xF3;n: una actividad est&#xE1; detenida cuando no es visible en la pantalla, pero a&#xFA;n se encuentra en memoria y en cualquier momento puede ser reanudada. Cuando una aplicaci&#xF3;n es enviada a segundo plano se ejecuta el m&#xE9;todo <strong><code>onStop()</code></strong>. Al reanudar la actividad, se pasa por el m&#xE9;todo <strong><code>onRestart()</code></strong> hasta llegar a el estado de ejecuci&#xF3;n y luego al de reanudaci&#xF3;n.</li>
<li>Destrucci&#xF3;n: cuando la actividad ya no existe en memoria se encuentra en estado de destrucci&#xF3;n. Antes de pasar a destruir la aplicaci&#xF3;n se ejecuta el m&#xE9;todo <strong><code>onDestroy()</code></strong>. Es com&#xFA;n que la mayor&#xED;a de actividades no implementen este m&#xE9;todo, a menos que deban destruir procesos como servicios en segundo plano.</li>
</ul>
<p>Aunque tu aplicaci&#xF3;n puede tener varias actividades en su estructura, se debe definir una actividad principal. Para hacerlo se debe especificar en tu archivo Android Manifest un componente <strong><code>&lt;actitivy&gt;</code></strong>, con un componente hijo <strong><code>&lt;intent-filter&gt;</code></strong>. Dentro de este componente declararas dos nuevos componentes, <strong><code>&lt;action&gt;</code></strong> y <strong><code>&lt;category&gt;</code></strong>. Al primero le asignaras el elemento enumerado <strong><code>MAIN</code></strong> y al segundo el elemento enumerado <strong><code>LAUNCHER</code></strong>.</p>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F; Crea un proyecto nuevo y copia el c&#xF3;digo de CicloVidaActivity en la clase principal. Prueba la salida que muestra Logcat en Debug y filtrado por &quot;SALIDA&quot;. Observa cuales son los m&#xE9;todos por los que pasa la App, seg&#xFA;n los distintos cambios de estado.</span></p>
<h3 class="mume-header" id="comunicaci%C3%B3n-de-activitys-a-trav%C3%A9s-de-intents">Comunicaci&#xF3;n de Activitys a trav&#xE9;s de Intents</h3>

<p>Uno de los componentes que hemos comentado que forman parte de una aplicaci&#xF3;n android son los <a href="https://developer.android.com/guide/components/intents-filters?hl=es-419">intents</a>. Como dijimos, son los que permiten la comunicaci&#xF3;n con el resto de componentes, tambi&#xE9;n se pueden definir como la voluntad de realizar una acci&#xF3;n o una tarea determinada, estas tareas pueden ser una llamada de tel&#xE9;fono o visualizar una p&#xE1;gina web entre otras.</p>
<p>Android soporta dos tipos de Intentos <strong>expl&#xED;citos e impl&#xED;citos</strong>.</p>
<div align="center">
    <img height="150" src="./imagenes/intents.png">
</div>
<p>Son expl&#xED;citos cuando ejecutamos un componente en espec&#xED;fico. Son impl&#xED;citos cuando se entrega una referencia gen&#xE9;rica sobre alguna condici&#xF3;n, y aquellas entidades que cumplan ese requisito ser&#xE1;n presentadas como candidatas para la tarea.</p>
<h4>Intent expl&#xED;cito</h4>
<p>Se especifica exactamente el componente a lanzar. Se suele utilizar cuando se quiere ejecutar los componentes internos de una aplicaci&#xF3;n.<br>
Un ejemplo de <strong>Intent explicito</strong> se da cuando invocamos una actividad con un tipo de clase especifico. Por ejemplo, <em>sup&#xF3;n que dentro de nuestra aplicaci&#xF3;n tenemos dos actividades llamadas A y B. Si decidimos iniciar la actividad B desde la actividad A usar&#xED;amos un Intent explicito debido a que &#x201C;B&#x201D; es un tipo definido</em>.</p>
<div align="center">
    <img height="150" src="./imagenes/intents2.png">
</div>
<p>En el inicio de una nueva actividad se pueden dar varias circunstancias:</p>
<ul>
<li>
<p>Inicio de una actividad sin argumentos ni devoluci&#xF3;n de resultados:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword">var</span> intento<span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Activity2<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
<span class="token comment">//var intento=Intent(applicationContext, Activity2::class.java)</span>
<span class="token function">startActivity</span><span class="token punctuation">(</span>intento<span class="token punctuation">)</span>
</pre></li>
<li>
<p>Inicio de una actividad con argumentos y sin devoluci&#xF3;n de resultados. Podemos pasar informaci&#xF3;n a las actividades a&#xF1;adiendo datos al objeto intent con el m&#xE9;todo putExtra:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword">var</span> intento<span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span> Activity2<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
intento<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;DATO&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Este es el valor que se manda desde Main Activity&quot;</span><span class="token punctuation">)</span>
<span class="token function">startActivity</span><span class="token punctuation">(</span>intento<span class="token punctuation">)</span>
</pre><p>En la clase invocada obtendremos los datos recibidos de la siguiente manera:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword">var</span> intento<span class="token operator">=</span>intent
findViewById<span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textoActivity2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>intento<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">&quot;DATO&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre></li>
<li>
<p>Inicio de una actividad con argumentos y devoluci&#xF3;n de resultados. Cuando se inicia una actividad para obtener un resultado, es posible (y casi seguro en el caso de las operaciones que consumen mucha memoria, como el uso de la c&#xE1;mara) que se destruya tu proceso y tu actividad debido a la poca memoria. Por lo que se debe separar la devoluci&#xF3;n de llamada del resto de c&#xF3;digo, para ello la librer&#xED;a de Android nos proporciona distintos componentes:</p>
<ul>
<li>
<p><strong><code>registerForActivityResult()</code></strong>. <strong>L&#xED;nea6</strong> Es el elemento principal y que se usa para registrar la devoluci&#xF3;n de resultados. Tiene varias sobrecargar, en un principio usaremos la que toma un objeto <em><code>ActivityResultContract</code></em>. Devuelve un elemento <em><code>ActivityResultLauncher</code></em> que se usar&#xE1; para iniciar la otra actividad.</p>
</li>
<li>
<p><strong><code>ActivityResultContract</code></strong>. <strong>L&#xED;nea6</strong> y par&#xE1;metro del elemento anterior. Un contrato que especifica que una actividad se puede llamar con una entrada de tipo I y producir una salida de tipo O.  La API proporciona <a href="https://developer.android.com/reference/androidx/activity/result/contract/ActivityResultContracts?hl=es-419">contratos predeterminados</a> para acciones de intent b&#xE1;sicas, como tomar una foto, solicitar permisos, etc. Tambi&#xE9;n se pueden crear contratos personalizados.</p>
</li>
<li>
<p><strong><code>ActivityResultCallback</code></strong>. <strong>L&#xED;nea 8 - 11</strong> . Es una devoluci&#xF3;n de llamada con seguridad de tipos que se llamar&#xE1; cuando el resultado de una actividad est&#xE9; disponible. Es una interfaz de m&#xE9;todo &#xFA;nico con un m&#xE9;todo onActivityResult() que toma un objeto del tipo de salida definido en <em><code>ActivityResultContract</code></em></p>
</li>
<li>
<p><strong><code>ActivityResultLauncher</code></strong>. <strong>L&#xED;nea15</strong>  manda el intent que queremos usar para iniciar la aplicaci&#xF3;n. Se manda a trav&#xE9;s del lanzador, creado en la l&#xED;nea 6, que inicia el proceso de ejecuci&#xF3;n de un <em><code>ActivityResultContract</code></em>.</p>
</li>
</ul>
</li>
</ul>
<pre data-role="codeBlock" data-info="kotlin{highlight=[6, [6-12],[8-11],15, [16,-17]]}" class="language-kotlin" data-line="6,6-12,8-11,15,16,-17"><span class="token keyword">class</span> MainActivity<span class="token operator">:</span><span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>
        <span class="token keyword">val</span> openPostActivity <span class="token operator">=</span>
            <span class="token function">registerForActivityResult</span><span class="token punctuation">(</span>ActivityResultContracts<span class="token punctuation">.</span><span class="token function">StartActivityForResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
            <span class="token punctuation">{</span> 
                result <span class="token operator">-&gt;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>resultCode <span class="token operator">==</span> Activity<span class="token punctuation">.</span>RESULT_OK<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span>result<span class="token punctuation">.</span>data<span class="token operator">?</span><span class="token punctuation">.</span>
                    <span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">&quot;DATORETURN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        findViewById<span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textoActivity1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span>
            View<span class="token punctuation">.</span><span class="token function">OnClickListener</span><span class="token punctuation">{</span>
                openPostActivity<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>
                <span class="token function">Intent</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span> Activity2<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span>
                <span class="token punctuation">{</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;DATO&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Este es el valor que se manda desde Main Activity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<div class="line-highlight-wrapper">




<div aria-hidden="true" class="line-highlight" data-range="6" data-start="6">
</div></div><div class="line-highlight-wrapper">




<div aria-hidden="true" class="line-highlight" data-range="6-12" data-start="6" data-end="12">






</div></div><div class="line-highlight-wrapper">






<div aria-hidden="true" class="line-highlight" data-range="8-11" data-start="8" data-end="11">



</div></div><div class="line-highlight-wrapper">













<div aria-hidden="true" class="line-highlight" data-range="15" data-start="15">
</div></div><div class="line-highlight-wrapper">














<div aria-hidden="true" class="line-highlight" data-range="16-17" data-start="16" data-end="17">

</div></div></pre><blockquote>
<p>&#x1F4CC; De <strong>L&#xED;nea 6 a L&#xED;nea 12</strong>, se registra la actividad para esperar resultados de otras activitys o fragments. Se debe registrar la actividad para posibles resultados en el m&#xE9;todo <em>onCreate()</em>.Si el resultado es OK realizamos el c&#xF3;digo necesario, en este caso se ha extra&#xED;do la informaci&#xF3;n del intent recibido <strong><code>result.data</code></strong>. De <strong>L&#xED;nea 16 a 17</strong> se lanza el intent de la actividad que se quiere iniciar, pero con el objeto <code>ActivityResultCallback</code> creado en el bloque anterior.</p>
</blockquote>
<p>En la clase invocada devolveremos los datos de la siguiente manera:</p>
<pre data-role="codeBlock" data-info="kotlin {highlight=[4,5]}" class="language-kotlin" data-line="4,5">   textView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span> <span class="token punctuation">{</span>
            <span class="token keyword">val</span> intentoResultado<span class="token operator">=</span><span class="token function">Intent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            intentoResultado<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;DATORETURN&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Este es el dato&quot;</span><span class="token punctuation">)</span>
            <span class="token function">setResult</span><span class="token punctuation">(</span>Activity<span class="token punctuation">.</span>RESULT_OK<span class="token punctuation">,</span>intentoResultado<span class="token punctuation">)</span>
            <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<div class="line-highlight-wrapper">


<div aria-hidden="true" class="line-highlight" data-range="4" data-start="4">
</div></div><div class="line-highlight-wrapper">



<div aria-hidden="true" class="line-highlight" data-range="5" data-start="5">
</div></div></pre><blockquote>
<p>&#x1F4CC; en la <strong>L&#xED;nea 4</strong> preparamos el resultado de la actividad indicando que ha sido correcto y a&#xF1;adiendo un intent con informaci&#xF3;n si lo creemos necesario. <strong>L&#xED;nea 5</strong> cerramos la activity.</p>
</blockquote>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F;Ejercicio Resuelto2Activitys</span><br>
<span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F;Ejercicio Propuesto3ActivitysRetornoDatos</span></p>
<div style="page-break-after:always;"></div>
<h4>Intent Impl&#xED;cito</h4>
<p>Los Intent impl&#xED;citos son aquellos que le preguntan al sistema qu&#xE9; servicio o componente es el m&#xE1;s adecuado para realizar la petici&#xF3;n, es decir, no espec&#xED;fica un componente en especial, y solo se especifica la funcionalidad requerida a trav&#xE9;s de una acci&#xF3;n (ver, hacer b&#xFA;squeda, hacer foto, marcar n&#xFA;mero&#x2026;) y un dato (URL, n&#xFA;mero a marcar&#x2026;)En este caso el sistema determina el componente para su resoluci&#xF3;n, desencadenando un &#x201C;intent&#x201D; sin conocer exactamente cu&#xE1;l es la aplicaci&#xF3;n o componente que lo recibir&#xE1;, si no puede establecer exactamente el componente a utilizar porque hay m&#xE1;s de uno, muestra una ventana con las opciones a seleccionar.</p>
 <div align="center">
    <img height="200" src="./imagenes/intents3.png">
</div>
<p>Un ejemplo de <strong>Intent impl&#xED;cito</strong>: <em>ser&#xED;a cuando deseas compartir un sitio web en alguna red social. Para ello Android nos ofrece un dialogo listando las app sociales instaladas en el dispositivo en ese momento, para que elijamos la de nuestro inter&#xE9;s. No especificamos que aplicaci&#xF3;n quer&#xED;amos, simplemente se mostraron todas las aplicaciones que podr&#xED;an responder a ese tipo de acci&#xF3;n</em>.</p>
<div align="center">
    <img height="200" src="./imagenes/intents4.png">
</div>
<p>B&#xE1;sicamente los pasos para lanzar una actividad con un <strong>intent impl&#xED;cito</strong> ser&#xED;an los siguientes:</p>
<ul>
<li>Declaramos el intent con la acci&#xF3;n apropiada (ACTION_VIEW, ACTION_WEB_SEARCH, etc).</li>
<li>Adjuntamos informaci&#xF3;n adicional necesaria dependiendo de la acci&#xF3;n del intent.</li>
<li>Lanzamos el intent dejando que el sistema encuentre la actividad adecuada).</li>
</ul>
<p>Para iniciar la actividad utilizaremos igualmente startActivity. Algunos ejemplos de <a href="https://developer.android.com/guide/components/intents-common?hl=es-419">Intents Comunes</a>:</p>
<ul>
<li>
<p>Para mostrar una web dentro de un navegador:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword">val</span> intento <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_VIEW<span class="token punctuation">,</span> Uri<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.google.es&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">startActivity</span><span class="token punctuation">(</span>intento<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</pre><p>Requiere los permisos: <strong><code>&lt;uses-permission android:name=&quot; android.permission.INTERNET &quot;/&gt;</code></strong></p>
</li>
<li>
<p>Para utilizar la b&#xFA;squeda de google;</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"> <span class="token keyword">val</span> intento <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_WEB_SEARCH<span class="token punctuation">)</span><span class="token punctuation">;</span> 
 intento<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span>SearchManager<span class="token punctuation">.</span>QUERY<span class="token punctuation">,</span> <span class="token string">&quot;I.E.S. Doctor Balmis&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
 <span class="token function">startActivity</span><span class="token punctuation">(</span>intento<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Requiere los permisos <strong><code>&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;</code></strong></p>
</li>
<li>
<p>Para mostrar los contactos.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">  <span class="token keyword">val</span> intento <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_VIEW<span class="token punctuation">,</span> Uri<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;content://contacts/people/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">startActivity</span><span class="token punctuation">(</span>intento<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</pre><p>Requiere los permisos: <strong><code>&lt;uses-permission android:name=&quot;android.permission.READ_CONTACTS&quot;/&gt;</code></strong></p>
</li>
</ul>
<div align="center">
    <img height="180" src="./imagenes/intents5.png">
</div>
<p>Es posible que en ocasiones no se pueda acceder a una aplicaci&#xF3;n debido a que no est&#xE1; instalada en el dispositivo, a restricciones de perfil o a la configuraci&#xF3;n de un administrador. En ese caso, no se produce la llamada y se bloquea la app. Para verificar que una actividad recibir&#xE1; la intent, es muy importante usar antes <strong><code>resolveActivity()</code></strong> en el objeto Intent. Si el resultado no es nulo, hay al menos una aplicaci&#xF3;n que puede administrar la intent y es seguro llamar a <strong><code>startActivity()</code></strong>.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"> <span class="token keyword">val</span> intento <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_VIEW<span class="token punctuation">,</span> Uri<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;content://contacts/people/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token keyword">if</span> <span class="token punctuation">(</span>intento<span class="token punctuation">.</span><span class="token function">resolveActivity</span><span class="token punctuation">(</span>packageManager<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token function">startActivity</span><span class="token punctuation">(</span>intento<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</pre><p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F;Ejercicio ResueltoIntentImplicito</span></p>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F;Ejercicio PropuestoIntentImplicito</span></p>
<div style="page-break-after:always;"></div>
<h4 class="mume-header" id="requerir-permisos-al-usuario">Requerir permisos al usuario</h4>

<p>Android est&#xE1; apostando cada vez m&#xE1;s fuerte por la seguridad, por lo que en las versiones m&#xE1;s recientes del sistema operativo no basta con a&#xF1;adir la etiquete <strong><code>&lt;uses-permission ...&gt;</code></strong> en el Manifiesto. Si se quiere acceder a recursos ajenos a la aplicaci&#xF3;n en funcionamiento, se deber&#xE1; realizar una <a href="https://developer.android.com/training/permissions/requesting?hl=es-419">solicitud de permisos</a> de forma explicita al usuario.<br>
Esto es debido a que cada app se ejecuta en una zona de pruebas con acceso limitado, si necesita usar recursos o informaci&#xF3;n ajenos a su propia zona de pruebas deber&#xE1;s seguir los siguientes pasos:</p>
<ol>
<li>
<p>En el archivo de manifiesto de la app, declara los permisos que necesites.</p>
</li>
<li>
<p>Esperar a que el usuario invoque la tarea o acci&#xF3;n de la app que requiere acceso a datos privados espec&#xED;ficos. En ese momento, la app puede solicitar el permiso de tiempo de ejecuci&#xF3;n necesario para acceder a esos datos. Para ello:</p>
<ol>
<li>Verifica si el usuario ya otorg&#xF3; el permiso de tiempo de ejecuci&#xF3;n que requiere la app. De ser as&#xED;, esta ya puede acceder a los recursos necesarios.</li>
<li>En caso contrario, solicitar el permiso en tiempo de ejecuci&#xF3;n, en ese caso el sistema mostrar&#xE1; un dialogo solicitando el permiso y si es otorgado se pasar&#xE1; al acceso de los recursos. En este paso se puede optar por mostrar un dialogo explicando porque motivo son necesarios los recursos.</li>
</ol>
</li>
<li>
<p>Si el usuario rechaza la solicitud, la app deber&#xED;a proporcionar una opci&#xF3;n elegante al usuario.</p>
</li>
</ol>
<p>Podemos crear un c&#xF3;digo parecido al siguiente, en el que se pide permiso para acceder a los contactos y a la memor&#xED;a externa del dispositivo:</p>
<pre data-role="codeBlock" data-info="kotlin{highlight=[0,[3-17],5,8,10,14,16]}" class="language-kotlin" data-line="0,3-17,5,8,10,14,16"><span class="token keyword">val</span> RESPUESTA_PERMISOS <span class="token operator">=</span> <span class="token number">111</span>
<span class="token annotation builtin">@RequiresApi</span><span class="token punctuation">(</span>Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>Q<span class="token punctuation">)</span>
<span class="token keyword">fun</span> <span class="token function">solicitarPermisos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>READ_EXTERNAL_STORAGE<span class="token punctuation">)</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_DENIED
        <span class="token operator">||</span> <span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>READ_CONTACTS<span class="token punctuation">)</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_DENIED<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">shouldShowRequestPermissionRationale</span><span class="token punctuation">(</span>READ_EXTERNAL_STORAGE<span class="token punctuation">)</span><span class="token punctuation">)</span> 
            <span class="token comment">//Si se decide explicar los motivos de los permisos con  similar a un dialogo</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">shouldShowRequestPermissionRationale</span><span class="token punctuation">(</span>READ_CONTACTS<span class="token punctuation">)</span><span class="token punctuation">)</span> 
            <span class="token comment">//Si se decide explicar los motivos de los permisos con  similar a un dialogo</span>
        <span class="token comment">//Con requestPermissions se pide al usuario que permita los permisos, </span>
        <span class="token comment">//en este caso dos</span>
        <span class="token function">requestPermissions</span><span class="token punctuation">(</span><span class="token function">arrayOf</span><span class="token punctuation">(</span>READ_EXTERNAL_STORAGE<span class="token punctuation">,</span> _CONTACTS<span class="token punctuation">)</span><span class="token punctuation">,</span> RESPUESTA_PERMISOS<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> 
    <span class="token keyword">else</span> <span class="token function">lanzarFuncionalidadQueRequierePermisos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<div class="line-highlight-wrapper"><div aria-hidden="true" class="line-highlight" data-range="0" data-start="0">
</div></div><div class="line-highlight-wrapper">

<div aria-hidden="true" class="line-highlight" data-range="3-17" data-start="3" data-end="17">














</div></div><div class="line-highlight-wrapper">



<div aria-hidden="true" class="line-highlight" data-range="5" data-start="5">
</div></div><div class="line-highlight-wrapper">






<div aria-hidden="true" class="line-highlight" data-range="8" data-start="8">
</div></div><div class="line-highlight-wrapper">








<div aria-hidden="true" class="line-highlight" data-range="10" data-start="10">
</div></div><div class="line-highlight-wrapper">












<div aria-hidden="true" class="line-highlight" data-range="14" data-start="14">
</div></div><div class="line-highlight-wrapper">














<div aria-hidden="true" class="line-highlight" data-range="16" data-start="16">
</div></div></pre><pre data-role="codeBlock" data-info="kotlin{highlight=[[0-22],7]}" class="language-kotlin" data-line="0-22,7"><span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>
       requestCode<span class="token operator">:</span> Int<span class="token punctuation">,</span><span class="token comment">//c&#xF3;digo de identificaci&#xF3;n del resultado</span>
       permissions<span class="token operator">:</span> Array<span class="token operator">&lt;</span><span class="token keyword">out</span> String<span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token comment">//array con los nombres de los permisos</span>
       grantResults<span class="token operator">:</span> IntArray<span class="token comment">//array de 0 y -1 (permitido, no permitido) en orden) </span>
<span class="token punctuation">{</span>
       <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> grantResults<span class="token punctuation">)</span>
       <span class="token keyword">when</span> <span class="token punctuation">(</span>requestCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           RESPUESTA_PERMISOS <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
               <span class="token keyword">if</span> <span class="token punctuation">(</span>grantResults<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span>
                   Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                       applicationContext<span class="token punctuation">,</span>
                       permissions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot; Permiso concedido&quot;</span><span class="token punctuation">,</span>
                       Toast<span class="token punctuation">.</span>LENGTH_SHORT
                   <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
               <span class="token keyword">if</span> <span class="token punctuation">(</span>grantResults<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span>
                   Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                       applicationContext<span class="token punctuation">,</span>
                       permissions<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot; Permiso concedido&quot;</span><span class="token punctuation">,</span>
                       Toast<span class="token punctuation">.</span>LENGTH_SHORT
                   <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<div class="line-highlight-wrapper"><div aria-hidden="true" class="line-highlight" data-range="0-22" data-start="0" data-end="22">






















</div></div><div class="line-highlight-wrapper">





<div aria-hidden="true" class="line-highlight" data-range="7" data-start="7">
</div></div></pre><blockquote>
<p>&#x1F4CC; <strong>L&#xED;nea 0</strong> creamos una constante identificativa de la petici&#xF3;n de permisos. Desde la <strong>L&#xED;nea 3 hasta la 17</strong> creamos el m&#xE9;todo encargado de lanzar los di&#xE1;logos con la petici&#xF3;n de los dos permisos (en este caso). <strong>L&#xED;nea 5</strong> se comprueba que todav&#xED;a no se han concedido, y en ese caso se lanza la petici&#xF3;n <strong>L&#xED;nea 16</strong>. Las <strong>l&#xED;neas 8 y 10</strong>, servir&#xED;an para a&#xF1;adir alguna forma de explicaci&#xF3;n al usuario. Si el permiso ha sido concedido con anterioridad se pasar&#xE1; a lanzar la funcionalidad que lo usa, <strong>L&#xED;nea 16</strong>.<br>
El hilo que controla la respuesta del usuario, se recoge mediante el m&#xE9;todo sobreescrito <strong><code>onRequestPermissionsResult</code></strong>, a este m&#xE9;todo le llega la informaci&#xF3;n necesaria para poder saber a que petici&#xF3;n de permisos se refiere (usando la constante creada anteriormente <strong>L&#xED;nea 7</strong>), el array con los nombres de los permisos y el resultado de si han sido concedido o no. Con esta informaci&#xF3;n pasaremos a lanzar la funcionalidad que los requiere o a dar otras opciones al usuario.</p>
</blockquote>
<div style="page-break-after:always;"></div>
<h3 class="mume-header" id="intent-filter">Intent-filter</h3>

<p>Las actividades y servicios pueden declarar el tipo de acciones que pueden llevar a cabo y los tipos de datos que pueden gestionar. De esta forma se informa al sistema del tipo de intenciones impl&#xED;citas que puede atender dicho componente. Los intent-filter se definen en el archivo de manifiesto de la aplicaci&#xF3;n dentro de la activity correspondiente.<br>
Como se ha explicado en el punto anterior, cuando se crea un intent impl&#xED;cito el sistema Android busca el componente apropiado que pueda resolver la petici&#xF3;n dada en el intent.<br>
La b&#xFA;squeda la realiza analizando los <strong>intent-filter</strong> definidos en los archivos de manifiesto de las aplicaciones instaladas en el dispositivo. Si existe coincidencia lanza dicha aplicaci&#xF3;n. Si la coincidencia es m&#xFA;ltiple (varias aplicaciones pueden dar respuesta a esa petici&#xF3;n), el sistema muestra un cuadro de di&#xE1;logo con el fin de que el usuario decida. A un Intent podemos asociarle una acci&#xF3;n, unos datos y una categor&#xED;a.<br>
Las actividades pueden declarar el tipo de acciones que pueden llevar a cabo y los tipos de datos que pueden gestionar.</p>
<ul>
<li>Las acciones son cadenas de texto est&#xE1;ndar que describen lo que la actividad puede hacer. Por ejemplo <strong><code>android.intent.action.VIEW</code></strong>, es una acci&#xF3;n que indica que la actividad puede mostrar datos al usuario.</li>
<li>La misma actividad puede declarar el tipo de datos del que se ocupa, por ejemplo <strong><code>vnd.android.cursor.dir/person</code></strong>, indica que la actividad manipula los datos de la agenda.</li>
<li>Tambi&#xE9;n pueden declarar una categor&#xED;a, que b&#xE1;sicamente indica si la actividad va a ser lanzada desde el lanzador de aplicaciones, desde el men&#xFA; de otra aplicaci&#xF3;n o directamente desde otra actividad.las actividades que est&#xE1;n dispuestas a recibir intents impl&#xED;citos deben incluir <strong><code>android.intent.category.DEFAULT</code></strong>.</li>
</ul>
<p>Un posible ejemplo del AndroidManifest.xml que cumpla las anteriores condiciones:</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.intent.action.VIEW<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>category</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.intent.category.DEFAULT<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name"><span class="token namespace">android:</span>mimeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vnd.android.cursor.dir/person<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
</pre><p>Una activity puede tener varios intent-filter definidos. Igualmente cada uno de esos intent-filter puede tener varias acciones definidas.</p>
<div style="page-break-after:always;"></div>
<p>Manifest ejemplo de varios intent-filter:</p>
<div align="center">
    <img height="350" src="./imagenes/intents6.png">
</div>
<blockquote>
<p>&#x1F4CC;El primer intent-filter define que esta activity es punto de entrada para la aplicaci&#xF3;n. La categor&#xED;a especifica que debe aparecer en el lanzador de aplicaciones. El segundo, permite a la activity visualizar y editar el directorio de datos (a trav&#xE9;s de las actions VIEW y EDIT), o recuperar una entrada particular y devolverla (a trav&#xE9;s de la action PICK). En data se especifica el tipo de datos que se manejan. Como est&#xE1; definido con la Categor&#xED;a DEFAULT, estamos indicando que atender&#xE1; a los intents impl&#xED;citos que soliciten otras aplicaciones.</p>
</blockquote>
<h3 class="mume-header" id="trabajando-con-parcelables">Trabajando con Parcelables</h3>

<p>Cuando estamos desarrollando en Android y necesitamos enviar datos a otra Activity lo podemos realizar mediante un <strong>Intent y Bundle</strong> pero qu&#xE9; sucede si deseamos enviar un objeto para economizar una llamada a la API. Android nos brinda las opciones de <strong>Serializable</strong> (propia de Java) y <strong>Parcelable</strong>, sin embargo esta &#xFA;ltima es hasta 10 veces m&#xE1;s r&#xE1;pida por lo que nos vamos a enfocar en ella.<br>
Parcelable es una interfaz y podemos implementarla manual o mediante un plugin que, en las &#xFA;ltimas versiones de Android Studio, viene incluido por defecto.<br>
Claramente tendremos que crear la clase POJO, como se hace siempre, pero est&#xE1; deber&#xE1; derivar de la <strong><code>Interfaz Parcelable</code></strong>. Como es de suponer esto nos obligar&#xE1; a implementar una serie de m&#xE9;todos y una variable CREATOR que hereda de Creator y que tendr&#xE1; todos sus miembros est&#xE1;ticos gracias el modificador <strong><code>companion</code></strong>.<br>
Veamos un ejemplo con dos activitys, una en la que se pueden introducir los datos de un contacto y que al pulsar un bot&#xF3;n env&#xED;e los datos existentes en la pantalla a una segunda actividad que mostrar&#xE1; los datos de forma sencilla.</p>
<p>Clase <strong>Contacto</strong> que hereda de la <strong><code>Interfaz Parcelable</code></strong>:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword">class</span> <span class="token function">Contacto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> Parcelable <span class="token punctuation">{</span>
    <span class="token keyword">var</span> nombre<span class="token operator">:</span> String<span class="token operator">?</span>
    <span class="token keyword">var</span> telefono<span class="token operator">:</span> String<span class="token operator">?</span>
    <span class="token keyword">var</span> email<span class="token operator">:</span> String<span class="token operator">?</span>
    <span class="token keyword">var</span> foto<span class="token operator">:</span> Bitmap<span class="token operator">?</span>
    <span class="token comment">//Constructor generado autom&#xE1;ticamente</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>parcel<span class="token operator">:</span> Parcel<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        nombre <span class="token operator">=</span> parcel<span class="token punctuation">.</span><span class="token function">readString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        telefono <span class="token operator">=</span> parcel<span class="token punctuation">.</span><span class="token function">readString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        email <span class="token operator">=</span> parcel<span class="token punctuation">.</span><span class="token function">readString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        foto <span class="token operator">=</span> parcel<span class="token punctuation">.</span><span class="token function">readParcelable</span><span class="token punctuation">(</span>Bitmap<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">.</span>classLoader<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">init</span><span class="token punctuation">{</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>nombre<span class="token operator">=</span><span class="token string">&quot;&quot;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>telefono<span class="token operator">=</span><span class="token string">&quot;&quot;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>email<span class="token operator">=</span><span class="token string">&quot;&quot;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>foto<span class="token operator">=</span><span class="token keyword">null</span>
     <span class="token punctuation">}</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>nombre<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span> telefono<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span>
                email<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span> foto<span class="token operator">:</span> Bitmap<span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>nombre <span class="token operator">=</span> nombre
        <span class="token keyword">this</span><span class="token punctuation">.</span>telefono <span class="token operator">=</span> telefono
        <span class="token keyword">this</span><span class="token punctuation">.</span>email <span class="token operator">=</span> email
        <span class="token keyword">this</span><span class="token punctuation">.</span>foto <span class="token operator">=</span> foto
    <span class="token punctuation">}</span>
    <span class="token comment">//funciones generadas autom&#xE1;ticamente </span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">describeContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Int <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">writeToParcel</span><span class="token punctuation">(</span>parcel<span class="token operator">:</span> Parcel<span class="token punctuation">,</span> flags<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parcel<span class="token punctuation">.</span><span class="token function">writeString</span><span class="token punctuation">(</span>nombre<span class="token punctuation">)</span>
        parcel<span class="token punctuation">.</span><span class="token function">writeString</span><span class="token punctuation">(</span>telefono<span class="token punctuation">)</span>
        parcel<span class="token punctuation">.</span><span class="token function">writeString</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span>
        parcel<span class="token punctuation">.</span><span class="token function">writeParcelable</span><span class="token punctuation">(</span>foto<span class="token punctuation">,</span> flags<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//Clase creada autom&#xE1;ticamente. Un companion object es la forma que tienen Kotlin </span>
    <span class="token comment">//de definir miembros staticos dentro de una clase, todos los elementos </span>
    <span class="token comment">//de este object ser&#xE1;n static</span>
    <span class="token keyword">companion</span> <span class="token keyword">object</span> CREATOR <span class="token operator">:</span> Creator<span class="token operator">&lt;</span>Contacto<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">createFromParcel</span><span class="token punctuation">(</span>parcel<span class="token operator">:</span> Parcel<span class="token punctuation">)</span><span class="token operator">:</span> Contacto <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">Contacto</span><span class="token punctuation">(</span>parcel<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">newArray</span><span class="token punctuation">(</span>size<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>Contacto<span class="token operator">?</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">arrayOfNulls</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>Clase <strong>MainActivity</strong> que inicia la actividad segunda mandando el objeto parcelado.</p>
<pre data-role="codeBlock" data-info="kotlin{highlight=[15,16]}" class="language-kotlin" data-line="15,16"><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>
        <span class="token keyword">val</span> nombre <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>campo_nombre<span class="token punctuation">)</span>
        <span class="token keyword">val</span> tlf <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>campo_tlf<span class="token punctuation">)</span>
        <span class="token keyword">val</span> correo <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>campo_correo<span class="token punctuation">)</span>
        <span class="token keyword">val</span> img <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>ImageButton<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>placeImage<span class="token punctuation">)</span>
        <span class="token keyword">val</span> imagen <span class="token operator">=</span> BitmapFactory<span class="token punctuation">.</span><span class="token function">decodeResource</span><span class="token punctuation">(</span>resources<span class="token punctuation">,</span> R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>noimagen<span class="token punctuation">)</span>
        <span class="token keyword">val</span> button<span class="token operator">:</span> Button <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>Button<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>boton<span class="token punctuation">)</span>
        button<span class="token punctuation">.</span><span class="token function">setOnClickListener</span> <span class="token punctuation">{</span>
                <span class="token keyword">val</span> c <span class="token operator">=</span> <span class="token function">Contacto</span><span class="token punctuation">(</span>nombre<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tlf<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                 correo<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> imagen<span class="token punctuation">)</span>
                <span class="token keyword">val</span> intent <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span> Activity2<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
                intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;CONTACTO&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>
                <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span>
<div class="line-highlight-wrapper">













<div aria-hidden="true" class="line-highlight" data-range="15" data-start="15">
</div></div><div class="line-highlight-wrapper">














<div aria-hidden="true" class="line-highlight" data-range="16" data-start="16">
</div></div></pre><blockquote>
<p>&#x1F4CC; <strong>L&#xED;nea 15</strong> se crea el intent para la actividad 2 . <strong>L&#xED;nea 16</strong> como se puede ver, aunque el elemento que a&#xF1;adimos al intent es un objeto de tipo Contacto, se puede hacer con <strong><code>putExtra</code></strong> debido a que el contacto hereda de Parcelable.</p>
</blockquote>
<p>En la <strong>Activity2</strong> recuperaremos el objeto pasado, con la  <strong>l&#xED;nea 6</strong>.</p>
<pre data-role="codeBlock" data-info="kotlin{highlight=6}" class="language-kotlin" data-line="6"><span class="token keyword">class</span> Activity2<span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//recuperar datos y visualizar</span>
        <span class="token keyword">val</span> c <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>intent<span class="token punctuation">.</span>getParcelableExtra<span class="token operator">&lt;</span>Contacto<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;CONTACTO&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">val</span> nombre <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>txt_nombre<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">val</span> tlf <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>txt_tlf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">val</span> correo <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>txt_correo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">val</span> img <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>ImageButton<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>placeImage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            nombre<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>nombre<span class="token punctuation">)</span>
            tlf<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>telefono<span class="token punctuation">)</span>
            correo<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>email<span class="token punctuation">)</span>
            img<span class="token punctuation">.</span><span class="token function">setImageBitmap</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>foto<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<div class="line-highlight-wrapper">




<div aria-hidden="true" class="line-highlight" data-range="6" data-start="6">
</div></div></pre><blockquote>
<p>&#x270B; <strong>Importante:</strong> No olvides declarar en el Manifest las dos actividades.</p>
</blockquote>
<p><span style="color: DarkRed; font-weight: bold;">&#x2712;&#xFE0F; Ejercicio PropuestoParcelabe</span></p>
<div style="page-break-after:always;"></div>
      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>