<!DOCTYPE html><html><head>
      <title>Resum per a l&apos;&#xFA;s propi de Juanjo</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
.markdown-preview.markdown-preview .slides > section {
  height: 100%;
  font-size: 90%;
  overflow-y: auto !important;
}
.markdown-preview.markdown-preview .slide code {
  color: yellow;
}

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <style>/* 
Añade 

@import "../EstilosPersonalizadosMarkdownEnhanced.less"

justo después del front matter 
*/
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v17/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
</style>
<h1 class="mume-header undefined" id="resum-per-a-l%C3%BAs-propi-de-juanjo">Resum per a l&apos;&#xFA;s propi de Juanjo</h1>

<h2 class="mume-header undefined" id="%C3%ADndex">&#xCD;ndex</h2>

<ol>
<li><a href="#definicions">Definicions</a></li>
<li><a href="#toast">Toast</a></li>
<li><a href="#getion-b%C3%A1sica-de-vistas-o-componentes-visuales">Getion b&#xE1;sica de vistas o componentes visuales</a></li>
<li><a href="#activities">Activities</a>
<ol>
<li><a href="#cicle-de-vida-duna-activity">Cicle de vida d&apos;una Activity</a></li>
<li><a href="#intents">Intents</a></li>
</ol>
</li>
<li><a href="#requerir-permisos-a-lusuari">Requerir permisos a l&apos;usuari</a></li>
<li><a href="#intent-filter">Intent Filter</a></li>
<li><a href="#treballant-amb-parcelables">Treballant amb Parcelables</a></li>
</ol>
<h2 class="mume-header undefined" id="tema-3-components-duna-aplicaci%C3%B3-android">Tema 3 . Components d&apos;una aplicaci&#xF3; Android</h2>

<h3 class="mume-header" id="definicions">Definicions</h3>

<ul>
<li>
<p><strong>Aplicaci&#xF3;</strong>: Finestra de components que poden interactuar entre ells.</p>
</li>
<li>
<p><strong>Context</strong>: Interf&#xED;cie entre l&apos;aplicaci&#xF3; i el sistema operatiu, la qual descriu la informaci&#xF3; que representa la teua aplicaci&#xF3; dins de l&apos;ambient del sistema operatiu, acc&#xE9;s a recursos i interactuaci&#xF3; con la resta de aplicacions. Es representa amb la classe abstracta <strong><code>Context</code></strong>. Tenim dues tipus:</p>
<ul>
<li>
<p><strong>Context d&apos;aplicaci&#xF3;</strong>. Aquest context engloba a tots els altres i per tant es &#xFA;nic, i cobreix tot el cicle de vida de l&apos;aplicaci&#xF3;.</p>
<blockquote>
<p>&#x270B; <strong>Important:</strong> Es pot accedir des d&apos;una <strong><code>Activity</code></strong> o un <strong><code>Service</code></strong> amb <strong><code>application</code></strong> o des de qualsevol que herete de <strong><code>Context</code></strong> amb <strong><code>applicationContext</code></strong>.</p>
</blockquote>
</li>
<li>
<p><strong>Context de <em>&apos;Activity&apos;</em> o <em>&apos;Service&apos;</em></strong>. Viu tant com l&apos;element al qual pertany. Aix&#xED; doncs, un <strong><code>Context</code></strong> d&apos;una <strong><code>Activity</code></strong> viur&#xE0; el mateix temps que viu aquesta la activity i sempre viur&#xE0; menys temps que el de l&apos;Aplicaci&#xF3;.</p>
</li>
</ul>
</li>
<li>
<p><strong>Components d&apos;una aplicaci&#xF3;</strong></p>
<ul>
<li>
<p><strong>Activity</strong>: Les <em>&apos;activities&apos;</em> s&#xF3;n els components visibles de l&apos;aplicaci&#xF3;, tenen una interf&#xED;cie d&apos;usuari que permet interactuar amb elles.</p>
</li>
<li>
<p><strong>Services</strong>: Un servei &#xE9;s una entitat que executa instruccions en segon pla sense que l&apos;usuari el note en la interf&#xED;cie. Per exemple guardar la informaci&#xF3; en la base de dades, escoltar m&#xFA;sica mentre s&apos;executa l&apos;aplicaci&#xF3;, administrar connexions de xarxa, etc.</p>
</li>
<li>
<p><strong>Vista</strong>: una vista &#xE9;s una classe base per a tots els elements de la interf&#xED;cie d&apos;usuari. Per tant, cobreix moltes classes i conceptes diferents, inclosos Widgets, ViewGroups i Layouts. Hi ha una vista arrel adjunta a una inst&#xE0;ncia de finestra que forma la base de la jerarquia de vistes. En general, la paraula Vista sol usar-se per a descriure elements de la interf&#xED;cie d&apos;usuari en general, o per a referir-se a classes d&apos;interf&#xED;cie d&apos;usuari abstractes o b&#xE0;siques, com ViewGroups.</p>
</li>
<li>
<p><strong>Widget</strong>: Hi ha diverses definicions per a aquest terme, per&#xF2; la majoria es refereix a un element d&apos;interf&#xED;cie d&apos;usuari &quot;<em>llest per a usar</em>&quot;, ja siga un bot&#xF3;, ImageView, EditText, etc. Tindrem en compte que algunes persones consideren que els Widgets s&#xF3;n elements d&apos;interf&#xED;cie d&apos;usuari complets (no abstractes). En altres paraules podem dir que s&#xF3;n els controls de usuari.</p>
</li>
<li>
<p><strong>Fragment</strong>: Els fragments (fragment) es poden entendre com a seccions o parts (habitualment reutilitzables) de la interf&#xED;cie d&apos;usuari d&apos;una aplicaci&#xF3;. D&apos;aquesta manera, una activitat podria contindre diversos fragments.</p>
</li>
<li>
<p><strong>Content provider</strong>: Amb aquest component, qualsevol aplicaci&#xF3; en Android pot emmagatzemar dades en un fitxer, en una base de dades SQLite o en qualsevol altre format que considere. A m&#xE9;s, aquestes <strong>dades poden ser compartits entre diferents aplicacions</strong>.</p>
<p>Per defecte, el API d&apos;Android porta amb si <em>Content Providers</em> predefinits per a intercanviar informaci&#xF3; d&apos;&#xE0;udio, v&#xED;deo, imatges, e informaci&#xF3; personal. Per&#xF2; si volem una estructura personalitzada has de crear la teua pr&#xF2;pia subclasse heretada de la classe <strong><code>ContentProvider</code></strong>.</p>
</li>
<li>
<p><strong>Intents</strong>: Un Intent <strong>&#xE9;s un objecte de missatgeria</strong> que pots usar per a sol&#xB7;licitar una acci&#xF3; d&apos;un altre component d&apos;una app. Aquests dades s&apos;organitzen en parelles de clau-valor.</p>
</li>
<li>
<p><strong>Broadcast receiver</strong>: El <em>&apos;receptors d&apos;emissi&#xF3;&apos;</em>, <strong>reaccionen a intents espec&#xED;fics podent al seu torn executar una acci&#xF3;</strong> o iniciant una activity o poden retornar un altre intent al sistema perqu&#xE8; seguisca l&apos;execuci&#xF3;. S&#xF3;n capa&#xE7;os de processar els missatges del sistema operatiu.</p>
</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="toast">Toast</h3>

<p>Per a mostrar un <strong><code>Toast</code></strong></p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
  applicationContext<span class="token punctuation">,</span>
  <span class="token string">&quot;Text que mostrar&#xE0; el toast&quot;</span><span class="token punctuation">,</span>
  Toast<span class="token punctuation">.</span>LENGTH_SHORT
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h3 class="mume-header" id="getion-b%C3%A1sica-de-vistas-o-componentes-visuales">Getion b&#xE1;sica de vistas o componentes visuales</h3>

<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token comment">// Buscar el objecte associat.</span>
<span class="token keyword keyword-var">var</span> vista <span class="token operator">=</span> findViewById<span class="token operator">&lt;</span>TipoVista<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>idVistaEnLayout<span class="token punctuation">)</span>

<span class="token comment">// Gesti&#xF3; de events</span>
vista<span class="token punctuation">.</span><span class="token function">setOnEventListener</span> <span class="token punctuation">{</span>
  <span class="token comment">// Accions al clicar</span>
<span class="token punctuation">}</span>
</pre><div style="page-break-after:always;"></div>
<h3 class="mume-header" id="activities">Activities</h3>

<h4 class="mume-header" id="cicle-de-vida-duna-activity">Cicle de vida d&apos;una Activity</h4>

<ul>
<li><strong>Creaci&#xF3; <code>onCreate()</code></strong>:<br>
Una activitat s&apos;ha creat quan la seua estructura es troba en mem&#xF2;ria, per&#xF2; aquesta <strong>no &#xE9;s visible encara</strong>. Quan l&apos;usuari pressiona sobre la icona de l&apos;aplicaci&#xF3; en el seu dispositiu, el m&#xE8;tode <strong><code>onCreate()</code></strong> &#xE9;s executat immediatament per a carregar el layout de l&apos;activitat principal en mem&#xF2;ria.</li>
<li><strong>Execuci&#xF3;-Represa <code>onStart() onResume()</code></strong>:<br>
Despr&#xE9;s d&apos;haver sigut carregada l&apos;activitat s&apos;executen en seq&#xFC;&#xE8;ncia el m&#xE8;tode <strong><code>onStart()</code></strong> i <strong><code>onResume()</code></strong>. Encara que <strong><code>onStart()</code></strong> fa visible l&apos;activitat, &#xE9;s <strong><code>onResume()</code></strong> qui li transfereix el focus perqu&#xE8; interactue amb l&apos;usuari.</li>
<li><strong>Pausa <code>onPause()</code></strong>:<br>
Una activitat est&#xE0; en pausa quan es troba en la pantalla parcialment visible. Un exemple: <em>quan s&apos;obrin di&#xE0;legs que prenen el focus superposant-se a l&apos;activitat</em>. El m&#xE8;tode anomenat per a la transici&#xF3; cap a la pausa &#xE9;s <strong><code>onPause()</code></strong>.</li>
<li><strong>Detenci&#xF3; <code>onStop()</code></strong>:<br>
Una activitat est&#xE0; detinguda quan no &#xE9;s visible en la pantalla, per&#xF2; encara es troba en mem&#xF2;ria i en qualsevol moment pot ser represa. Quan una aplicaci&#xF3; &#xE9;s enviada a segon pla s&apos;executa el m&#xE8;tode <strong><code>onStop()</code></strong>. En reprendre l&apos;activitat, es passa pel m&#xE8;tode <strong><code>onRestart()</code></strong> fins a arribar a l&apos;estat d&apos;execuci&#xF3; i despr&#xE9;s al de represa.</li>
<li><strong>Destrucci&#xF3; <code>onDestroy()</code></strong>:<br>
Quan l&apos;activitat ja no existeix en mem&#xF2;ria es troba en estat de destrucci&#xF3;. Abans de passar a destruir l&apos;aplicaci&#xF3; s&apos;executa el m&#xE8;tode <strong><code>onDestroy()</code></strong>. &#xC9;s com&#xFA; que la majoria d&apos;activitats no implementen aquest m&#xE8;tode, llevat que hagen de destruir processos com a serveis en segon pla.</li>
</ul>
<h4 class="mume-header" id="intents">Intents</h4>

<ul>
<li>
<p><strong>Explicit:</strong> S&apos;especifica exactament el component a llan&#xE7;ar. Se sol utilitzar quan es vol executar els <strong>components interns d&apos;una aplicaci&#xF3;</strong>. Per exemple, passem dades a un altra activitat definida en la nostra aplicaci&#xF3;.</p>
<p>Possibles:</p>
<ol>
<li>
<p>Iniciem la activitat B des de A sense dades:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token comment">// this es la &#xE9;s la activitat cridadora que hereta de Context </span>
<span class="token comment">// tamb&#xE9; podr&#xED;em passar applicationContext</span>
<span class="token keyword keyword-var">var</span> intento <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span> ActivityB<span class="token operator">::</span><span class="token keyword keyword-class">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
<span class="token function">startActivity</span><span class="token punctuation">(</span>intento<span class="token punctuation">)</span>
</pre></li>
<li>
<p>Passem dades en forma de clau-valor a la activitat B:</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token comment">// mitjan&#xE7;ant una interf&#xED;cie fluida</span>
<span class="token keyword keyword-var">var</span> i <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span> MainActivity<span class="token operator">::</span><span class="token keyword keyword-class">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;CLAU1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;VALOR2&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;CLAU2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;VALOR2&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// o tamb&#xE9; ...</span>
<span class="token keyword keyword-var">var</span> i <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span> MainActivity<span class="token operator">::</span><span class="token keyword keyword-class">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{</span> 
    <span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;CLAU1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;VALOR2&quot;</span><span class="token punctuation">)</span>
    <span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;CLAU2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;VALOR2&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">startActivity</span><span class="token punctuation">(</span>intento<span class="token punctuation">)</span>
</pre><p>El objecte <strong><code>Intent</code></strong> en la <strong><code>Activity</code></strong> de dest&#xED; el tindrem referenciat<br>
amb la propietat <strong><code>intent</code></strong> (<strong>No defer&#xED;em utilitzar aquest id</strong>)</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-val">val</span><span class="token operator">?</span> valor1 <span class="token operator">=</span> intent<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">&quot;DATO1&quot;</span><span class="token punctuation">)</span>
</pre></li>
<li>
<p>Passem dades i esperem resposta segon resultat del Activity llan&#xE7;at.<br>
Hem de separar la resposta de la crida per que despr&#xE9;s d&apos;acabar la activitat es destruir&#xE0;.</p>
<ul>
<li>
<p><strong>Pas 1</strong>: Crearem un objecte <strong><code>ActivityResultLauncher</code></strong> mitjan&#xE7;ant el m&#xE8;tode...</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-final">final</span> <span class="token operator">&lt;</span>I<span class="token punctuation">,</span> O<span class="token operator">&gt;</span> ActivityResultLauncher<span class="token operator">&lt;</span>I<span class="token operator">&gt;</span> <span class="token function">registerForActivityResult</span><span class="token punctuation">(</span>
            <span class="token annotation builtin">@NonNull</span> ActivityResultContract<span class="token operator">&lt;</span>I<span class="token punctuation">,</span> O<span class="token operator">&gt;</span> contract<span class="token punctuation">,</span>
            <span class="token annotation builtin">@NonNull</span> ActivityResultCallback<span class="token operator">&lt;</span>O<span class="token operator">&gt;</span> callback<span class="token punctuation">)</span>
</pre><p>A on ...</p>
<ul>
<li>
<p><strong><code>ActivityResultContract</code></strong> es un <em><strong>&apos;contracte&apos;</strong></em> que especifica que una activitat es pot cridar amb una entrada de tipus <strong><code>I</code></strong> i produir una eixida de tipus <strong><code>O</code></strong>. etc. Tot i que  es poden crear <strong>contractes personalitzats</strong>, la API proporciona contractes predeterminats per a accions de intent b&#xE0;siques, com <strong>prendre una foto</strong>, <strong>sol&#xB7;licitar permisos</strong>, etc.</p>
<p>Per exemple, <strong><code>ActivityResultContracts.StartActivityForResult()</code></strong> &#xE9;s un Intent que produir&#xE0; un <strong><code>ActivityResult</code></strong> com a resultat.</p>
</li>
<li>
<p><strong><code>ActivityResultCallback</code></strong> es un SAM <em>&apos;consumidor&apos;</em> al que le arriba un objecte de tipus <strong><code>O</code></strong>, para el nostre contracte un <strong><code>ActivityResult</code></strong> i fa una determinada acci&#xF3; sense retornar o &apos;<em>produir</em>&apos; r&#xE9;s. <strong><code>result : ActivityResult -&gt; void</code></strong></p>
</li>
</ul>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-val">val</span> activityResultLauncher <span class="token operator">=</span>
    <span class="token function">registerForActivityResult</span><span class="token punctuation">(</span>ActivityResultContracts<span class="token punctuation">.</span><span class="token function">StartActivityForResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> result <span class="token operator">-&gt;</span>
        <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>resultCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token comment">// Si el resultat es correcte </span>
            <span class="token comment">// aleshores tindrem la resposta en result.data</span>
            Activity<span class="token punctuation">.</span>RESULT_OK <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                    applicationContext<span class="token punctuation">,</span>
                    result<span class="token punctuation">.</span>data<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">&quot;DATORETURN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    Toast<span class="token punctuation">.</span>LENGTH_SHORT
                <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</pre></li>
<li>
<p><strong>Pas 2</strong>: Crearem un <strong><code>Intent</code></strong> amb les dades y el nom de la <strong><code>Activity</code></strong> com sempre i despr&#xE9;s amb el objecte <strong><code>activityResultLauncher</code></strong> lla&#xE7;arem la <strong><code>Activity</code></strong> passant el Intent al m&#xE8;tode <strong><code>.launch(i : Intent)</code></strong> del objecte.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">findViewById<span class="token operator">&lt;</span>Button<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>buttonID<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span> <span class="token punctuation">{</span>
    openPostActivity<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>
        <span class="token function">Intent</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span> ActivityToLaunch<span class="token operator">::</span><span class="token keyword keyword-class">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;DATO&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Dato que se manda&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre></li>
<li>
<p><strong>Pas 3</strong>: Per tornar dades ho farem <strong>creant un nou <code>Intent</code></strong> que posar&#xE0; el estat adequat en el objecte <strong><code>ActivityResult</code></strong></p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin">textView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span> <span class="token punctuation">{</span>
    <span class="token comment">// Creem el nou intent amb les dades.</span>
    <span class="token keyword keyword-val">val</span> intentoResultado <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;DATORETURN&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Este es el dato&quot;</span><span class="token punctuation">)</span>
    <span class="token function">setResult</span><span class="token punctuation">(</span>Activity<span class="token punctuation">.</span>RESULT_OK<span class="token punctuation">,</span> intentoResultado<span class="token punctuation">)</span>
    <span class="token comment">// Finalitza el activity i torna al cridador.</span>
    <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre></li>
</ul>
</li>
</ol>
</li>
<li>
<p><strong>Implicit:</strong> Aquells que li pregunten al sistema quin servei o component &#xE9;s el m&#xE9;s adequat per a realitzar la petici&#xF3;, &#xE9;s a dir, no espec&#xED;fica un component especialment. Sin&#xF3; que volem fer i led dades per a fer-ho seguint els seg&#xFC;ents passos:</p>
<ol>
<li>Declarem el intent amb l&apos;acci&#xF3; apropiada (ACTION_VIEW, ACTION_WEB_SEARCH, etc).</li>
<li>Adjuntem informaci&#xF3; addicional necess&#xE0;ria depenent de l&apos;acci&#xF3; del intent.</li>
<li>Llancem el intent deixant que el sistema trobe l&apos;activitat adequada.</li>
</ol>
<p>Per exemple per a mostrar els contactes seria...</p>
<blockquote>
<p>&#x1F4CC; <strong>Nota</strong>: Requereix els permisos: <strong><code>&lt;uses-permission android:name=&quot;android.permission.READ_CONTACTS&quot;/&gt;</code></strong></p>
</blockquote>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token comment">// Obrir els contactes.</span>
<span class="token keyword keyword-val">val</span> intento <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_VIEW<span class="token punctuation">,</span> Uri<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;content://contacts/people/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// resolveActivity si est&#xE0; disponible el que volem fer.</span>
<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>intento<span class="token punctuation">.</span><span class="token function">resolveActivity</span><span class="token punctuation">(</span>packageManager<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> 
   <span class="token function">startActivity</span><span class="token punctuation">(</span>intento<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ALtres examples de intents t&#xED;pics:</span>
<span class="token comment">// 1. Obrir una ubicaci&#xF3; en maps</span>
<span class="token keyword keyword-val">val</span> intento <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_VIEW<span class="token punctuation">,</span> Uri<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;geo:38.3619129, -0.4905111?z=18&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 2. Fer una trucada per tel&#xE8;fon</span>
<span class="token keyword keyword-val">val</span> intento <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_CALL<span class="token punctuation">,</span> Uri<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;tel:676188432&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></li>
</ul>
<h3 class="mume-header" id="requerir-permisos-a-lusuari">Requerir permisos a l&apos;usuari</h3>

<p>Tenim que seguir els seg&#xFC;ents passos ...</p>
<ul>
<li>
<p><strong>Pas 1</strong>: En l&apos;arxiu de <strong>manifest</strong> de l&apos;app, declara els permisos que necessites.</p>
<pre data-role="codeBlock" data-info="xml {highlight=3}" class="language-xml" data-line="3"><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.READ_EXTERNAL_STORAGE<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">&gt;</span></span>
<div class="line-highlight-wrapper">

<div aria-hidden="true" class="line-highlight" data-range="3" data-start="3">
</div></div></pre></li>
<li>
<p><strong>Pas 2</strong>: Esperar que l&apos;usuari invoque la tasca o acci&#xF3; de l&apos;app que requereix acc&#xE9;s.</p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token comment">// Id que identifica la sol&#xB7;licitut de permisos requerits al sistema.</span>
<span class="token keyword keyword-private">private</span> <span class="token keyword keyword-val">val</span> RESPUESTA_PERMISOS <span class="token operator">=</span> <span class="token number">111</span>

<span class="token annotation builtin">@RequiresApi</span><span class="token punctuation">(</span>Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>Q<span class="token punctuation">)</span>
<span class="token keyword keyword-fun">fun</span> <span class="token function">solicitarPermisos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// android.Manifest.permission.READ_EXTERNAL_STORAGE</span>
    <span class="token keyword keyword-val">val</span> permisosNecesarios <span class="token operator">=</span> listOf<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span>READ_EXTERNAL_STORAGE<span class="token punctuation">)</span>
    <span class="token keyword keyword-val">val</span> permisosQueFaltan <span class="token operator">=</span> mutableListOf<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// Mirarem si la App ja t&#xE9; els permisos concedits.</span>
    <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>permiso <span class="token keyword keyword-in">in</span> permisosNecesarios<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>permiso<span class="token punctuation">)</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_DENIED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Si no els t&#xE9; concedit l&apos;afegirem per ha sol&#xB7;licitar-ho</span>
            permisosQueFaltan<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>permiso<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Es llama a al m&#xE8;tode que que demana el permisos per part del sistema</span>
    <span class="token comment">// i que al finalitzar executa el callback onRequestPermissionsResult</span>
    <span class="token comment">// Nota: Hem anat afegint tots els que necessit&#xE0;vem</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>permisosQueFaltan<span class="token punctuation">.</span>size <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">requestPermissions</span><span class="token punctuation">(</span>permisosQueFaltan<span class="token punctuation">.</span><span class="token function">toTypedArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RESPUESTA_PERMISOS<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// Si ja els teniem tots concedits llan&#xE7;ar&#xED;em la funcionalitat.</span>
        <span class="token comment">//lanzarFuncionalidadQueRequierePermisos()</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></li>
<li>
<p><strong>Pas 3</strong>: <strong><code>requestPermissions</code></strong> crida a <strong><code>onRequestPermissionsResult</code></strong> a on verificarem si l&apos;usuari ja ha concedit el perm&#xED;s/sos de temps d&apos;execuci&#xF3; que requereix l&apos;app.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>
    requestCode<span class="token operator">:</span> Int<span class="token punctuation">,</span>                   <span class="token comment">// c&#xF3;digo de identificaci&#xF3;n del resultado</span>
    permissions<span class="token operator">:</span> Array<span class="token operator">&lt;</span><span class="token keyword keyword-out">out</span> String<span class="token operator">&gt;</span><span class="token punctuation">,</span>     <span class="token comment">// array con los nombres de los permisos</span>
    grantResults<span class="token operator">:</span> IntArray              <span class="token comment">// array de 0 y -1 (permitido, no permitido en orden.</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> grantResults<span class="token punctuation">)</span>
    <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>requestCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Si rebem resposta del Id de sol&#xB7;licitut que hem fet nosaltres.</span>
        RESPUESTA_PERMISOS <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>

            <span class="token keyword keyword-val">val</span> permisosQueFaltan <span class="token operator">=</span> mutableListOf<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i <span class="token keyword keyword-in">in</span> <span class="token number">0</span><span class="token operator">..</span>grantResults<span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>grantResults<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_DENIED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    permisosQueFaltan<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>permissions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>permisosQueFaltan<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">lanzarFuncionalidadQueRequierePermisos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
                Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
                    applicationContext<span class="token punctuation">,</span>
                    <span class="token string">&quot;Lo siento no se puede realizar la &quot;</span> 
                            <span class="token operator">+</span> <span class="token string">&quot;funcionalidad porque faltan los siguiente permisos: &quot;</span>
                            <span class="token operator">+</span> permisosQueFaltan<span class="token punctuation">.</span><span class="token function">joinToString</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    Toast<span class="token punctuation">.</span>LENGTH_SHORT
                <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre></li>
</ul>
<h3 class="mume-header" id="intent-filter">Intent Filter</h3>

<p>Al manifest, les activitats i serveis poden declarar el tipus d&apos;accions que poden dur a terme i els tipus de dades que poden gestionar.</p>
<p>Com s&apos;ha explicat en el punt anterior, quan es crea un intent impl&#xED;cit el sistema Android busca el component apropiat que puga resoldre la petici&#xF3; donada en el intent. La cerca la realitza analitzant els <strong>intent-filter definits per a eixa activitat o servici</strong> en el arxiu de manifest. Per example...</p>
<pre data-role="codeBlock" data-info="xml" class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- La acci&#xF3; es mostrar dades --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.intent.action.VIEW<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 
        Indica de de a on es lla&#xE7;ada la activitat (launcher, altra app, altra activitat) 
        En aquest cas DEFAULT indica que &#xE9;s la activitat que es llan&#xE7;ar&#xE0;
        per a intent impl&#xED;cits des de altres aplicacions.
        --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>category</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.intent.category.DEFAULT<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- El tipus de dades que el intent manejar&#xE0; --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name"><span class="token namespace">android:</span>mimeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vnd.android.cursor.dir/person<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
</pre><h3 class="mume-header" id="treballant-amb-parcelables">Treballant amb Parcelables</h3>

<p>Si volem enviar dades en forma de objecte des de una app a un altra mitjan&#xE7;ant un Intent Implicit. Definirem una classe POJO, per&#xF2; est&#xE0; haur&#xE0; de derivar de la <strong><code>Interf&#xED;cie Parcelable</code></strong>. Com &#xE9;s de suposar aix&#xF2; ens obligar&#xE0; a implementar una s&#xE8;rie de m&#xE8;todes i propietats. Aix&#xF2; ens permetr&#xE0; passar un objecte <strong><code>contacte</code></strong> mitjan&#xE7;ant un <strong><code>putExtra</code></strong> a un intent.</p>
<p>Veiem com definir una classe amb dades de un <strong>contacte</strong> per a enviar-los d&apos;una activity a una altra, <strong>afegit-li el comportament</strong> de <strong><code>Parceleble</code></strong>.</p>
<pre data-role="codeBlock" data-info="kotlin" class="language-kotlin"><span class="token keyword keyword-class">class</span> <span class="token function">Contacto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> Parcelable <span class="token punctuation">{</span>
    <span class="token keyword keyword-var">var</span> nombre<span class="token operator">:</span> String<span class="token operator">?</span>
    <span class="token keyword keyword-var">var</span> telefono<span class="token operator">:</span> String<span class="token operator">?</span>
    <span class="token keyword keyword-var">var</span> email<span class="token operator">:</span> String<span class="token operator">?</span>
    <span class="token keyword keyword-var">var</span> foto<span class="token operator">:</span> Bitmap<span class="token operator">?</span>

    <span class="token keyword keyword-init">init</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>nombre <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>telefono <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>email <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>foto <span class="token operator">=</span> <span class="token keyword keyword-null">null</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//Constructor generado autom&#xE1;ticamente</span>
    <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span>parcel<span class="token operator">:</span> Parcel<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        nombre <span class="token operator">=</span> parcel<span class="token punctuation">.</span><span class="token function">readString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        telefono <span class="token operator">=</span> parcel<span class="token punctuation">.</span><span class="token function">readString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        email <span class="token operator">=</span> parcel<span class="token punctuation">.</span><span class="token function">readString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        foto <span class="token operator">=</span> parcel<span class="token punctuation">.</span><span class="token function">readParcelable</span><span class="token punctuation">(</span>Bitmap<span class="token operator">::</span><span class="token keyword keyword-class">class</span><span class="token punctuation">.</span>java<span class="token punctuation">.</span>classLoader<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span>
        nombre<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span> telefono<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span>
        email<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span> foto<span class="token operator">:</span> Bitmap<span class="token operator">?</span>
    <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>nombre <span class="token operator">=</span> nombre
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>telefono <span class="token operator">=</span> telefono
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>email <span class="token operator">=</span> email
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>foto <span class="token operator">=</span> foto
    <span class="token punctuation">}</span>

    <span class="token comment">//funciones generadas autom&#xE1;ticamente</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">describeContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Int  <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">writeToParcel</span><span class="token punctuation">(</span>parcel<span class="token operator">:</span> Parcel<span class="token punctuation">,</span> flags<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parcel<span class="token punctuation">.</span><span class="token function">writeString</span><span class="token punctuation">(</span>nombre<span class="token punctuation">)</span>
        parcel<span class="token punctuation">.</span><span class="token function">writeString</span><span class="token punctuation">(</span>telefono<span class="token punctuation">)</span>
        parcel<span class="token punctuation">.</span><span class="token function">writeString</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span>
        <span class="token comment">// Fixat que si tenim objectes complexes a mode de composici&#xF3; o agregaci&#xF3;</span>
        <span class="token comment">// tamb&#xE9; han de ser &apos;parceleables&apos; com si estigu&#xE9;rem serialitzant.</span>
        parcel<span class="token punctuation">.</span><span class="token function">writeParcelable</span><span class="token punctuation">(</span>foto<span class="token punctuation">,</span> flags<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Classe creada autom&#xE0;ticament. </span>
    <span class="token comment">// Un companion object &#xE9;s la forma que t&#xE9; Kotlin </span>
    <span class="token comment">// de definir membres statics dins d&apos;una classe.</span>
    <span class="token comment">// Tots el elements d&apos;aquest object seran static</span>
    <span class="token keyword keyword-companion">companion</span> <span class="token keyword keyword-object">object</span> CREATOR <span class="token operator">:</span> Parcelable<span class="token punctuation">.</span>Creator<span class="token operator">&lt;</span>Contacto<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">createFromParcel</span><span class="token punctuation">(</span>parcel<span class="token operator">:</span> Parcel<span class="token punctuation">)</span><span class="token operator">:</span> Contacto <span class="token punctuation">{</span>
            <span class="token keyword keyword-return">return</span> <span class="token function">Contacto</span><span class="token punctuation">(</span>parcel<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">newArray</span><span class="token punctuation">(</span>size<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>Contacto<span class="token operator">?</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-return">return</span> <span class="token function">arrayOfNulls</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>Des de el MainActivity es podrien passar les dades amb <strong><code>putExtra</code></strong> i obtindre&apos;ls al dest&#xED; mitjan&#xE7;ant el m&#xE8;tode <strong><code>intent.getParcelableExtra(&quot;TAG&quot;)</code></strong></p>
<pre data-role="codeBlock" data-info="kotlin{class=&quot;line-numbers&quot;}" class="language-kotlin line-numbers"><span class="token keyword keyword-class">class</span> MainActivity<span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Recuperem les dades dels diferents components per a omplir el</span>
    <span class="token comment">// objecte parcel.</span>
    button<span class="token punctuation">.</span><span class="token function">setOnClickListener</span> <span class="token punctuation">{</span>
                <span class="token keyword keyword-val">val</span> c <span class="token operator">=</span> <span class="token function">Contacto</span><span class="token punctuation">(</span>
                            nombre<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                            tlf<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                            correo<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                            imagen<span class="token punctuation">)</span>
                <span class="token keyword keyword-val">val</span> intent <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span> ActivityDesti<span class="token operator">::</span><span class="token keyword keyword-class">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;CONTACTO&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>
                <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-class">class</span> ActivityDesti<span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
    <span class="token keyword keyword-val">val</span> c <span class="token operator">=</span> intent<span class="token punctuation">.</span>getParcelableExtra<span class="token operator">&lt;</span>Contacto<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;CONTACTO&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre>
      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>